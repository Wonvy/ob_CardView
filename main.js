/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// main.ts
__export(exports, {
  default: () => CardViewPlugin
});
var import_obsidian2 = __toModule(require("obsidian"));

// cardView.ts
var import_obsidian = __toModule(require("obsidian"));
var VIEW_TYPE_CARD = "card-view";
var CardView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.isPreviewCollapsed = false;
    this.currentFolder = null;
    this.currentSearchTerm = "";
    this.selectedTags = new Set();
    this.selectedNotes = new Set();
    this.lastSelectedNote = null;
    this.recentFolders = [];
    this.cardSize = 280;
    this.MIN_CARD_SIZE = 280;
    this.MAX_CARD_SIZE = 600;
    this.isCalendarVisible = false;
    this.currentDate = new Date();
    this.currentFilter = { type: "none" };
    this.plugin = plugin;
    this.currentView = plugin.settings.defaultView;
  }
  getViewType() {
    return VIEW_TYPE_CARD;
  }
  getDisplayText() {
    return "\u5361\u7247\u89C6\u56FE";
  }
  async onOpen() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("card-view-container");
    const mainLayout = containerEl.createDiv("main-layout");
    const contentSection = mainLayout.createDiv("content-section");
    const toolbar = contentSection.createDiv("card-view-toolbar");
    const leftTools = toolbar.createDiv("toolbar-left");
    const newNoteBtn = leftTools.createEl("button", {
      cls: "new-note-button"
    });
    newNoteBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            <span>\u65B0\u5EFA\u7B14\u8BB0</span>
        `;
    newNoteBtn.addEventListener("click", () => this.createNewNote());
    this.createCalendarButton(leftTools);
    const viewSwitcher = leftTools.createDiv("view-switcher");
    this.createViewSwitcher(viewSwitcher);
    const searchContainer = toolbar.createDiv("search-container");
    this.searchInput = searchContainer.createEl("input", {
      type: "text",
      placeholder: "\u641C\u7D22\u7B14\u8BB0...",
      cls: "search-input"
    });
    this.searchInput.addEventListener("input", () => {
      this.currentSearchTerm = this.searchInput.value;
      this.refreshView();
    });
    this.tagContainer = contentSection.createDiv("tag-filter");
    await this.loadTags();
    const contentArea = contentSection.createDiv("card-view-content");
    this.container = contentArea.createDiv("card-container");
    this.cardSize = this.plugin.settings.cardWidth;
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
    const previewWrapper = mainLayout.createDiv("preview-wrapper");
    this.previewContainer = previewWrapper.createDiv("preview-container");
    const previewControls = previewWrapper.createDiv("preview-controls");
    const toggleButton = previewControls.createEl("button", {
      cls: "preview-toggle",
      attr: { "aria-label": "\u6298\u53E0\u9884\u89C8" }
    });
    toggleButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>`;
    toggleButton.addEventListener("click", () => this.togglePreview());
    this.previewResizer = previewWrapper.createDiv("preview-resizer");
    this.setupResizer();
    document.addEventListener("wheel", (e) => {
      if (e.ctrlKey) {
        e.preventDefault();
        this.adjustCardSize(e.deltaY);
      }
    }, { passive: false });
    await this.loadNotes();
  }
  async loadTags() {
    const tags = this.getAllTags();
    const allTagBtn = this.tagContainer.createEl("button", {
      text: "All",
      cls: "tag-btn active"
    });
    allTagBtn.addEventListener("click", () => {
      this.clearTagSelection();
      allTagBtn.addClass("active");
      this.refreshView();
    });
    tags.forEach((tag) => {
      const tagBtn = this.tagContainer.createEl("button", {
        text: tag,
        cls: "tag-btn"
      });
      tagBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        this.toggleTag(tag, tagBtn);
      });
    });
  }
  getAllTags() {
    const tags = new Set();
    this.app.vault.getMarkdownFiles().forEach((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      if (cache == null ? void 0 : cache.tags) {
        cache.tags.forEach((tag) => tags.add(tag.tag));
      }
    });
    return Array.from(tags);
  }
  createViewSwitcher(container) {
    const views = [
      { id: "card", icon: "grid", text: "\u5361\u7247\u89C6\u56FE" },
      { id: "list", icon: "list", text: "\u5217\u8868\u89C6\u56FE" },
      { id: "timeline", icon: "clock", text: "\u65F6\u95F4\u8F74\u89C6\u56FE" }
    ];
    views.forEach((view) => {
      const btn = container.createEl("button", {
        cls: `view-switch-btn ${view.id === this.currentView ? "active" : ""}`
      });
      const iconHtml = {
        "grid": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>',
        "list": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',
        "clock": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>'
      };
      const iconSpan = btn.createSpan({ cls: "view-switch-icon" });
      iconSpan.innerHTML = iconHtml[view.icon];
      btn.createSpan({ text: view.text, cls: "view-switch-text" });
      btn.addEventListener("click", () => {
        container.querySelectorAll(".view-switch-btn").forEach((b) => b.removeClass("active"));
        btn.addClass("active");
        this.switchView(view.id);
      });
    });
  }
  async loadNotes() {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const cards = await Promise.all(files.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${this.cardSize}px`;
        this.container.appendChild(card);
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
  }
  async createNoteCard(file) {
    const card = document.createElement("div");
    card.addClass("note-card");
    card.setAttribute("data-path", file.path);
    const header = card.createDiv("note-card-header");
    const lastModified = header.createDiv("note-date");
    lastModified.setText(new Date(file.stat.mtime).toLocaleDateString());
    const folderPath = header.createDiv("note-folder");
    const folder = file.parent ? file.parent.path === "/" ? "\u6839\u76EE\u5F55" : file.parent.path : "\u6839\u76EE\u5F55";
    folderPath.setText(folder);
    folderPath.setAttribute("title", `\u6253\u5F00\u6587\u4EF6\u5939: ${folder}`);
    folderPath.addEventListener("click", async (e) => {
      e.stopPropagation();
      const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
      if (fileExplorer) {
        const fileExplorerView = fileExplorer.view;
        if (fileExplorerView.expandFolder) {
          await this.revealFolderInExplorer(folder);
          fileExplorer.setEphemeralState({ focus: true });
        }
      }
    });
    const openButton = header.createDiv("note-open-button");
    openButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>`;
    openButton.setAttribute("title", "\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00");
    openButton.style.opacity = "0";
    const cardContent = card.createDiv("note-card-content");
    const title = cardContent.createDiv("note-title");
    let displayTitle = file.basename;
    const timePattern = /^\d{4}[-./]\d{2}[-./]\d{2}/;
    if (timePattern.test(displayTitle)) {
      displayTitle = displayTitle.replace(timePattern, "").trim();
    }
    title.setText(displayTitle);
    try {
      const content = await this.app.vault.read(file);
      const noteContent = cardContent.createDiv("note-content");
      await import_obsidian.MarkdownRenderer.renderMarkdown(content, noteContent, file.path, this);
      card.addEventListener("mouseenter", async () => {
        openButton.style.opacity = "1";
        title.style.opacity = "0";
        noteContent.style.display = "block";
        try {
          this.previewContainer.empty();
          await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
        } catch (error) {
          console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
        }
      });
      card.addEventListener("mouseleave", () => {
        openButton.style.opacity = "0";
        title.style.opacity = "1";
        noteContent.style.display = "none";
      });
      openButton.addEventListener("click", async (e) => {
        e.stopPropagation();
        const leaf = this.app.workspace.getLeaf("tab");
        await leaf.openFile(file);
      });
      card.addEventListener("click", (e) => {
        this.handleCardSelection(file.path, e);
      });
      card.addEventListener("dblclick", async () => {
        const leaf = this.app.workspace.getLeaf("tab");
        await leaf.openFile(file);
      });
      card.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        this.showContextMenu(e, this.getSelectedFiles());
      });
    } catch (error) {
      console.error("\u7B14\u8BB0\u52A0\u8F7D\u5931\u8D25:", error);
    }
    card.addEventListener("mouseenter", async () => {
      openButton.style.opacity = "1";
    });
    card.addEventListener("mouseleave", () => {
      openButton.style.opacity = "0";
    });
    return card;
  }
  switchView(view) {
    this.currentView = view;
    this.container.setAttribute("data-view", view);
    this.container.empty();
    if (view === "timeline") {
      this.createTimelineView();
    } else {
      this.loadNotes();
    }
  }
  async filterByTag(tag) {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const filteredFiles = files.filter((file) => {
      var _a;
      const cache = this.app.metadataCache.getFileCache(file);
      return (_a = cache == null ? void 0 : cache.tags) == null ? void 0 : _a.some((t) => t.tag === tag);
    });
    const cards = await Promise.all(filteredFiles.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      this.container.appendChild(card);
    });
    this.tagContainer.querySelectorAll("button").forEach((btn) => {
      if (btn.textContent === tag) {
        btn.addClass("active-tag");
      } else {
        btn.removeClass("active-tag");
      }
    });
  }
  togglePreview() {
    this.isPreviewCollapsed = !this.isPreviewCollapsed;
    if (this.isPreviewCollapsed) {
      this.previewContainer.addClass("collapsed");
    } else {
      this.previewContainer.removeClass("collapsed");
    }
  }
  setupResizer() {
    let startX;
    let startWidth;
    const startResize = (e) => {
      e.preventDefault();
      startX = e.pageX;
      startWidth = parseInt(getComputedStyle(this.previewContainer).width, 10);
      document.addEventListener("mousemove", resize);
      document.addEventListener("mouseup", stopResize);
      document.body.style.cursor = "col-resize";
      this.previewResizer.addClass("resizing");
    };
    const resize = (e) => {
      const width = startWidth - (e.pageX - startX);
      if (width >= 50 && width <= 800) {
        this.previewContainer.style.width = `${width}px`;
        this.adjustContentWidth();
        if (this.isPreviewCollapsed) {
          this.isPreviewCollapsed = false;
          this.previewContainer.removeClass("collapsed");
        }
      }
    };
    const stopResize = () => {
      document.removeEventListener("mousemove", resize);
      document.removeEventListener("mouseup", stopResize);
      document.body.style.cursor = "";
      this.previewResizer.removeClass("resizing");
    };
    this.previewResizer.addEventListener("mousedown", startResize);
  }
  adjustContentWidth() {
    const mainLayout = this.containerEl.querySelector(".main-layout");
    const previewWidth = this.previewContainer.offsetWidth;
    const contentSection = this.containerEl.querySelector(".content-section");
    if (mainLayout && contentSection) {
      const totalWidth = mainLayout.offsetWidth;
      const newContentWidth = totalWidth - previewWidth - 4;
      contentSection.style.width = `${newContentWidth}px`;
      const availableWidth = newContentWidth - 32;
      const columns = Math.floor(availableWidth / this.cardSize);
      const gap = 16;
      const actualCardWidth = (availableWidth - (columns - 1) * gap) / columns;
      this.container.style.gridTemplateColumns = `repeat(${columns}, ${actualCardWidth}px)`;
    }
  }
  highlightFolder(folder) {
    this.currentFolder = this.currentFolder === folder ? null : folder;
    this.container.querySelectorAll(".note-card").forEach((card) => {
      const folderElement = card.querySelector(".note-folder");
      const cardFolder = folderElement ? folderElement.textContent : null;
      if (cardFolder) {
        card.toggleClass("folder-highlight", cardFolder === folder);
      }
    });
  }
  async revealFolderInExplorer(folder) {
    const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
    if (fileExplorer) {
      const fileExplorerView = fileExplorer.view;
      if (folder === "\u6839\u76EE\u5F55") {
        if (fileExplorerView.expandFolder) {
          await fileExplorerView.expandFolder("/");
        }
        return;
      }
      if (fileExplorerView.expandFolder) {
        const folderParts = folder.split("/");
        let currentPath = "";
        for (const part of folderParts) {
          currentPath += (currentPath ? "/" : "") + part;
          await fileExplorerView.expandFolder(currentPath);
        }
        if (fileExplorerView.setSelection) {
          await fileExplorerView.setSelection(folder);
        }
      }
    }
  }
  async createNewNote() {
    const date = new Date();
    const fileName = ` ${date.toLocaleString().replace(/[/:]/g, "-")}\u672A\u547D\u540D\u7B14\u8BB0`;
    try {
      const file = await this.app.vault.create(`${fileName}.md`, "# " + fileName + "\n\n");
      const leaf = this.app.workspace.getLeaf("tab");
      await leaf.openFile(file);
      this.loadNotes();
    } catch (error) {
      console.error("\u521B\u5EFA\u7B14\u8BB0\u5931\u8D25:", error);
    }
  }
  async createTimelineView() {
    const timelineContainer = this.container.createDiv("timeline-container");
    const files = this.app.vault.getMarkdownFiles();
    const notesByDate = new Map();
    files.forEach((file) => {
      const date = new Date(file.stat.mtime).toLocaleDateString();
      if (!notesByDate.has(date)) {
        notesByDate.set(date, []);
      }
      const notes = notesByDate.get(date);
      if (notes) {
        notes.push(file);
      }
    });
    const sortedDates = Array.from(notesByDate.keys()).sort((a, b) => new Date(b).getTime() - new Date(a).getTime());
    for (const date of sortedDates) {
      const dateGroup = timelineContainer.createDiv("timeline-date-group");
      const dateNode = dateGroup.createDiv("timeline-date-node");
      dateNode.createDiv("timeline-node-circle");
      dateNode.createDiv("timeline-date-label").setText(date);
      const notesList = dateGroup.createDiv("timeline-notes-list");
      const notes = notesByDate.get(date);
      if (notes) {
        for (const file of notes) {
          const noteItem = notesList.createDiv("timeline-note-item");
          noteItem.createDiv("timeline-note-marker");
          const noteContent = noteItem.createDiv("timeline-note-content");
          noteContent.createDiv("timeline-note-title").setText(file.basename);
          noteItem.addEventListener("click", async () => {
            const leaf = this.app.workspace.getLeaf("tab");
            await leaf.openFile(file);
          });
          noteItem.addEventListener("mouseenter", async () => {
            try {
              this.previewContainer.empty();
              const content = await this.app.vault.read(file);
              await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
            } catch (error) {
              console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
            }
          });
        }
      }
    }
  }
  addContextMenu(card, file) {
    card.addEventListener("contextmenu", (event) => {
      event.preventDefault();
      event.stopPropagation();
      const path = card.getAttribute("data-path");
      if (path && !this.selectedNotes.has(path) && !event.ctrlKey) {
        this.clearSelection();
        this.selectedNotes.add(path);
        card.addClass("selected");
      }
      const selectedFiles = this.getSelectedFiles();
      this.showContextMenu(event, selectedFiles);
    });
  }
  async refreshView() {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const filteredFiles = files.filter((file) => {
      var _a, _b;
      const matchesSearch = !this.currentSearchTerm || file.basename.toLowerCase().includes(this.currentSearchTerm.toLowerCase());
      let matchesTags = true;
      if (this.selectedTags.size > 0) {
        const cache = this.app.metadataCache.getFileCache(file);
        matchesTags = (_b = (_a = cache == null ? void 0 : cache.tags) == null ? void 0 : _a.some((t) => this.selectedTags.has(t.tag))) != null ? _b : false;
      }
      let matchesDate = true;
      if (this.currentFilter.type === "date") {
        const fileDate = new Date(file.stat.mtime);
        const fileDateStr = fileDate.toISOString().split("T")[0];
        if (this.currentFilter.value.length === 7) {
          matchesDate = fileDateStr.startsWith(this.currentFilter.value);
        } else {
          matchesDate = fileDateStr === this.currentFilter.value;
        }
      }
      return matchesSearch && matchesTags && matchesDate;
    });
    const cards = await Promise.all(filteredFiles.map((file) => this.createNoteCard(file, this.currentSearchTerm)));
    cards.forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${this.cardSize}px`;
        this.container.appendChild(card);
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
  }
  toggleTag(tag, tagBtn) {
    if (this.selectedTags.has(tag)) {
      this.selectedTags.delete(tag);
      tagBtn.removeClass("active");
    } else {
      this.selectedTags.add(tag);
      tagBtn.addClass("active");
    }
    const allBtn = this.tagContainer.querySelector("button");
    if (allBtn) {
      allBtn.removeClass("active");
    }
    this.refreshView();
  }
  clearTagSelection() {
    this.selectedTags.clear();
    this.tagContainer.querySelectorAll(".tag-btn").forEach((btn) => {
      btn.removeClass("active");
    });
  }
  handleCardSelection(path, event) {
    const card = this.container.querySelector(`[data-path="${path}"]`);
    if (!card)
      return;
    if (event.ctrlKey) {
      if (this.selectedNotes.has(path)) {
        this.selectedNotes.delete(path);
        card.removeClass("selected");
      } else {
        this.selectedNotes.add(path);
        card.addClass("selected");
      }
    } else if (event.shiftKey && this.lastSelectedNote) {
      const cards = Array.from(this.container.querySelectorAll(".note-card"));
      const lastIndex = cards.findIndex((c) => c.getAttribute("data-path") === this.lastSelectedNote);
      const currentIndex = cards.findIndex((c) => c.getAttribute("data-path") === path);
      const start = Math.min(lastIndex, currentIndex);
      const end = Math.max(lastIndex, currentIndex);
      cards.forEach((c, i) => {
        const cardPath = c.getAttribute("data-path");
        if (i >= start && i <= end && cardPath) {
          this.selectedNotes.add(cardPath);
          c.addClass("selected");
        }
      });
    } else {
      this.clearSelection();
      this.selectedNotes.add(path);
      card.addClass("selected");
    }
    this.lastSelectedNote = path;
  }
  clearSelection() {
    this.selectedNotes.clear();
    this.container.querySelectorAll(".note-card.selected").forEach((card) => {
      card.removeClass("selected");
    });
  }
  getSelectedFiles() {
    return Array.from(this.selectedNotes).map((path) => this.app.vault.getAbstractFileByPath(path)).filter((file) => file instanceof import_obsidian.TFile);
  }
  showContextMenu(event, files) {
    const menu = new import_obsidian.Menu();
    if (files.length > 0) {
      menu.addItem((item) => {
        item.setTitle(`\u5728\u65B0\u6807\u7B7E\u9875\u6253\u5F00`).setIcon("link").onClick(async () => {
          for (const file of files) {
            const leaf = this.app.workspace.getLeaf("tab");
            await leaf.openFile(file);
          }
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u5728\u6587\u4EF6\u7BA1\u7406\u5668\u4E2D\u663E\u793A`).setIcon("folder").onClick(() => {
          var _a;
          const file = files[0];
          this.revealFolderInExplorer(((_a = file.parent) == null ? void 0 : _a.path) || "/");
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u79FB\u52A8 ${files.length} \u4E2A\u6587\u4EF6`).setIcon("move").onClick(() => {
          const modal = new EnhancedFileSelectionModal(this.app, files, this.recentFolders, (folders) => {
            this.recentFolders = folders;
          });
          modal.open();
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u5220\u9664 ${files.length} \u4E2A\u6587\u4EF6`).setIcon("trash").onClick(async () => {
          const confirm = await new ConfirmModal(this.app, "\u786E\u8BA4\u5220\u9664", `\u662F\u5426\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ${files.length} \u4E2A\u6587\u4EF6\uFF1F`).show();
          if (confirm) {
            for (const file of files) {
              await this.app.vault.trash(file, true);
            }
            this.refreshView();
          }
        });
      });
    }
    menu.showAtMouseEvent(event);
  }
  adjustCardSize(delta) {
    const adjustment = delta > 0 ? -10 : 10;
    const newSize = Math.max(this.plugin.settings.minCardWidth, Math.min(this.plugin.settings.maxCardWidth, this.cardSize + adjustment));
    if (newSize !== this.cardSize) {
      this.cardSize = newSize;
      this.updateCardSize(newSize);
      this.plugin.saveCardWidth(newSize);
    }
  }
  updateCardSize(width) {
    this.cardSize = width;
    this.container.querySelectorAll(".note-card").forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${width}px`;
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${width}px)`;
  }
  createCalendarButton(leftTools) {
    const calendarBtn = leftTools.createEl("button", {
      cls: "calendar-toggle-button"
    });
    calendarBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            <span>\u65E5\u5386</span>
        `;
    calendarBtn.addEventListener("click", () => {
      this.toggleCalendar();
      calendarBtn.toggleClass("active", this.isCalendarVisible);
    });
  }
  toggleCalendar() {
    this.isCalendarVisible = !this.isCalendarVisible;
    if (this.isCalendarVisible) {
      this.showCalendar();
      this.filterNotesByMonth(this.currentDate);
    } else {
      this.hideCalendar();
      this.clearDateFilter();
    }
  }
  filterNotesByMonth(date) {
    const year = date.getFullYear();
    const month = date.getMonth();
    this.currentFilter = {
      type: "date",
      value: `${year}-${(month + 1).toString().padStart(2, "0")}`
    };
    this.refreshView();
  }
  showCalendar() {
    var _a;
    if (!this.calendarContainer) {
      const contentSection = this.containerEl.querySelector(".content-section");
      if (!contentSection)
        return;
      this.calendarContainer = createDiv("calendar-container");
      (_a = contentSection.parentElement) == null ? void 0 : _a.insertBefore(this.calendarContainer, contentSection);
    }
    this.calendarContainer.empty();
    this.renderCalendar();
    this.calendarContainer.style.display = "block";
    const mainLayout = this.containerEl.querySelector(".main-layout");
    if (mainLayout) {
      mainLayout.addClass("with-calendar");
    }
  }
  hideCalendar() {
    if (this.calendarContainer) {
      this.calendarContainer.style.display = "none";
      this.calendarContainer.empty();
      const mainLayout = this.containerEl.querySelector(".main-layout");
      if (mainLayout) {
        mainLayout.removeClass("with-calendar");
      }
    }
  }
  renderCalendar() {
    if (!this.calendarContainer) {
      return;
    }
    this.calendarContainer.empty();
    const year = this.currentDate.getFullYear();
    const month = this.currentDate.getMonth();
    const header = this.calendarContainer.createDiv("calendar-header");
    const prevBtn = header.createEl("button", { cls: "calendar-nav-btn" });
    prevBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>';
    prevBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      this.currentDate = new Date(year, month - 1, 1);
      this.renderCalendar();
      this.filterNotesByMonth(this.currentDate);
    });
    header.createDiv("calendar-title").setText(`${year}\u5E74${month + 1}\u6708`);
    const nextBtn = header.createEl("button", { cls: "calendar-nav-btn" });
    nextBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>';
    nextBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      this.currentDate = new Date(year, month + 1, 1);
      this.renderCalendar();
      this.filterNotesByMonth(this.currentDate);
    });
    const weekdays = ["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"];
    const weekHeader = this.calendarContainer.createDiv("calendar-weekdays");
    weekdays.forEach((day) => {
      weekHeader.createDiv("weekday").setText(day);
    });
    const grid = this.calendarContainer.createDiv("calendar-grid");
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const notesCount = this.getNotesCountByDate(year, month);
    for (let i = 0; i < firstDay; i++) {
      grid.createDiv("calendar-day empty");
    }
    for (let day = 1; day <= daysInMonth; day++) {
      const dayEl = grid.createDiv("calendar-day");
      const dateStr = `${year}-${(month + 1).toString().padStart(2, "0")}-${day.toString().padStart(2, "0")}`;
      dayEl.setText(day.toString());
      dayEl.setAttribute("data-date", dateStr);
      if (this.currentFilter.type === "date" && this.currentFilter.value === dateStr) {
        dayEl.addClass("selected");
      }
      const count = notesCount[dateStr] || 0;
      if (count > 0) {
        dayEl.createDiv("note-count").setText(count.toString());
      }
      dayEl.addEventListener("click", () => {
        this.filterNotesByDate(dateStr);
      });
    }
  }
  getNotesCountByDate(year, month) {
    const counts = {};
    const files = this.app.vault.getMarkdownFiles();
    files.forEach((file) => {
      const date = new Date(file.stat.mtime);
      if (date.getFullYear() === year && date.getMonth() === month) {
        const dateStr = date.toISOString().split("T")[0];
        counts[dateStr] = (counts[dateStr] || 0) + 1;
      }
    });
    return counts;
  }
  filterNotesByDate(dateStr) {
    if (this.currentFilter.type === "date" && this.currentFilter.value === dateStr) {
      this.clearDateFilter();
      return;
    }
    this.calendarContainer.querySelectorAll(".calendar-day").forEach((day) => {
      day.removeClass("selected");
    });
    this.currentFilter = { type: "date", value: dateStr };
    const selectedDay = this.calendarContainer.querySelector(`.calendar-day[data-date="${dateStr}"]`);
    if (selectedDay) {
      selectedDay.addClass("selected");
    }
    this.refreshView();
  }
  clearDateFilter() {
    this.currentFilter = { type: "none" };
    if (this.calendarContainer) {
      this.calendarContainer.querySelectorAll(".calendar-day").forEach((day) => {
        day.removeClass("selected");
      });
    }
    this.refreshView();
  }
  async createNoteCard(file, searchTerm = "") {
    const card = document.createElement("div");
    card.addClass("note-card");
    card.setAttribute("data-path", file.path);
    const header = card.createDiv("note-card-header");
    const lastModified = header.createDiv("note-date");
    lastModified.setText(new Date(file.stat.mtime).toLocaleDateString());
    const folderPath = header.createDiv("note-folder");
    const folder = file.parent ? file.parent.path === "/" ? "\u6839\u76EE\u5F55" : file.parent.path : "\u6839\u76EE\u5F55";
    folderPath.setText(folder);
    folderPath.setAttribute("title", `\u6253\u5F00\u6587\u4EF6\u5939: ${folder}`);
    folderPath.addEventListener("click", async (e) => {
      e.stopPropagation();
      const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
      if (fileExplorer) {
        const fileExplorerView = fileExplorer.view;
        if (fileExplorerView.expandFolder) {
          await this.revealFolderInExplorer(folder);
          fileExplorer.setEphemeralState({ focus: true });
        }
      }
    });
    const openButton = header.createDiv("note-open-button");
    openButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>`;
    openButton.setAttribute("title", "\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00");
    openButton.style.opacity = "0";
    const cardContent = card.createDiv("note-card-content");
    const title = cardContent.createDiv("note-title");
    let displayTitle = file.basename;
    const timePattern = /^\d{4}[-./]\d{2}[-./]\d{2}/;
    if (timePattern.test(displayTitle)) {
      displayTitle = displayTitle.replace(timePattern, "").trim();
    }
    title.setText(displayTitle);
    try {
      const content = await this.app.vault.read(file);
      const noteContent = cardContent.createDiv("note-content");
      if (searchTerm) {
        const highlightedContent = this.highlightSearchTerm(content, searchTerm);
        noteContent.innerHTML = highlightedContent;
      }
      await import_obsidian.MarkdownRenderer.renderMarkdown(content, noteContent, file.path, this);
      card.addEventListener("mouseenter", async () => {
        openButton.style.opacity = "1";
        title.style.opacity = "0";
        noteContent.style.display = "block";
        try {
          this.previewContainer.empty();
          await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
        } catch (error) {
          console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
        }
      });
      card.addEventListener("mouseleave", () => {
        openButton.style.opacity = "0";
        title.style.opacity = "1";
        noteContent.style.display = "none";
      });
      openButton.addEventListener("click", async (e) => {
        e.stopPropagation();
        const leaf = this.app.workspace.getLeaf("tab");
        await leaf.openFile(file);
      });
      card.addEventListener("click", (e) => {
        this.handleCardSelection(file.path, e);
      });
      card.addEventListener("dblclick", async () => {
        const leaf = this.app.workspace.getLeaf("tab");
        await leaf.openFile(file);
      });
      card.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        this.showContextMenu(e, this.getSelectedFiles());
      });
    } catch (error) {
      console.error("\u7B14\u8BB0\u52A0\u8F7D\u5931\u8D25:", error);
    }
    card.addEventListener("mouseenter", async () => {
      openButton.style.opacity = "1";
    });
    card.addEventListener("mouseleave", () => {
      openButton.style.opacity = "0";
    });
    return card;
  }
  highlightSearchTerm(content, searchTerm) {
    if (!searchTerm)
      return content;
    const regex = new RegExp(searchTerm, "gi");
    return content.replace(regex, (match) => `<span class="search-highlight">${match}</span>`);
  }
};
var ConfirmModal = class extends import_obsidian.Modal {
  constructor(app, title, message) {
    super(app);
    this.result = false;
    this.title = title;
    this.message = message;
  }
  async show() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: this.title });
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv("button-container");
    const confirmButton = buttonContainer.createEl("button", { text: "\u786E\u8BA4" });
    confirmButton.addEventListener("click", () => {
      this.result = true;
      this.close();
    });
    const cancelButton = buttonContainer.createEl("button", { text: "\u53D6\u6D88" });
    cancelButton.addEventListener("click", () => {
      this.result = false;
      this.close();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.resolvePromise(this.result);
  }
};
var EnhancedFileSelectionModal = class extends import_obsidian.Modal {
  constructor(app, files, recentFolders, onFoldersUpdate) {
    super(app);
    this.selectedFolder = null;
    this.files = files;
    this.recentFolders = recentFolders;
    this.onFoldersUpdate = onFoldersUpdate;
  }
  async onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", {
      text: `\u79FB\u52A8 ${this.files.length} \u4E2A\u6587\u4EF6`
    });
    if (this.recentFolders.length > 0) {
      const recentSection = contentEl.createDiv("recent-folders-section");
      recentSection.createEl("h4", { text: "\u6700\u4F7F\u7528" });
      const recentList = recentSection.createDiv("recent-folders-list");
      this.recentFolders.forEach((folder) => {
        const item = recentList.createDiv("folder-item recent");
        item.setText(folder);
        item.addEventListener("click", () => this.selectFolder(item, folder));
      });
    }
    const folderList = contentEl.createDiv("folder-list");
    const folders = this.getFoldersWithHierarchy();
    this.createFolderTree(folderList, folders);
    const buttonContainer = contentEl.createDiv("modal-button-container");
    const confirmButton = buttonContainer.createEl("button", {
      text: "\u786E\u8BA4\u79FB\u52A8",
      cls: "mod-cta"
    });
    confirmButton.addEventListener("click", () => {
      if (this.selectedFolder) {
        this.moveFiles(this.selectedFolder);
      }
    });
    const cancelButton = buttonContainer.createEl("button", {
      text: "\u53D6\u6D88"
    });
    cancelButton.addEventListener("click", () => this.close());
  }
  getFoldersWithHierarchy() {
    const folders = [];
    const seen = new Set();
    this.app.vault.getAllLoadedFiles().forEach((file) => {
      if (file instanceof import_obsidian.TFolder) {
        const parts = file.path.split("/");
        let currentPath = "";
        let level = 0;
        parts.forEach((part) => {
          if (part) {
            currentPath += (currentPath ? "/" : "") + part;
            if (!seen.has(currentPath)) {
              seen.add(currentPath);
              folders.push({
                path: currentPath,
                name: part,
                level
              });
            }
            level++;
          }
        });
      }
    });
    return folders.sort((a, b) => a.path.localeCompare(b.path));
  }
  createFolderTree(container, folders) {
    folders.forEach((folder) => {
      const item = container.createDiv({
        cls: "folder-item"
      });
      item.style.paddingLeft = `${folder.level * 20 + 10}px`;
      const icon = item.createSpan({
        cls: "folder-icon"
      });
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>`;
      const name = item.createSpan({
        cls: "folder-name",
        text: folder.name
      });
      item.addEventListener("click", () => this.selectFolder(item, folder.path));
    });
  }
  selectFolder(element, path) {
    this.contentEl.querySelectorAll(".folder-item").forEach((item) => {
      item.removeClass("selected");
    });
    element.addClass("selected");
    this.selectedFolder = path;
  }
  async moveFiles(targetFolder) {
    const confirmModal = new ConfirmModal(this.app, "\u786E\u8BA4\u79FB\u52A8", `\u662F\u5426\u5C06\u9009\u4E2D\u7684 ${this.files.length} \u4E2A\u6587\u4EF6\u79FB\u52A8\u5230 "${targetFolder}"\uFF1F`);
    if (await confirmModal.show()) {
      for (const file of this.files) {
        const newPath = `${targetFolder}/${file.name}`;
        await this.app.fileManager.renameFile(file, newPath);
      }
      this.recentFolders = [targetFolder, ...this.recentFolders.filter((f) => f !== targetFolder)].slice(0, 5);
      this.onFoldersUpdate(this.recentFolders);
      this.close();
    }
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  defaultView: "card",
  cardWidth: 280,
  minCardWidth: 280,
  maxCardWidth: 600
};
var CardViewSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("\u9ED8\u8BA4\u89C6\u56FE").setDesc("\u9009\u62E9\u9ED8\u8BA4\u7684\u89C6\u56FE\u6A21\u5F0F").addDropdown((dropdown) => {
      dropdown.addOption("card", "\u5361\u7247 \u89C6\u56FE").addOption("list", "\u5217\u8868\u89C6\u56FE").addOption("timeline", "\u65F6\u95F4\u8F74\u89C6\u56FE").setValue(this.plugin.settings.defaultView);
      dropdown.onChange(async (value) => {
        if (value === "card" || value === "list" || value === "timeline") {
          this.plugin.settings.defaultView = value;
          await this.plugin.saveSettings();
        }
      });
    });
    new import_obsidian2.Setting(containerEl).setName("\u5361\u7247\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u5BBD\u5EA6\uFF08280-600\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("280").setValue(this.plugin.settings.cardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width >= 280 && width <= 600) {
        this.plugin.settings.cardWidth = width;
        await this.plugin.saveSettings();
        this.plugin.updateAllCardViews();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5C0F\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u6700\u5C0F\u5BBD\u5EA6\uFF08\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("280").setValue(this.plugin.settings.minCardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width >= 200) {
        this.plugin.settings.minCardWidth = width;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u6700\u5927\u5BBD\u5EA6\uFF08\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("600").setValue(this.plugin.settings.maxCardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width <= 800) {
        this.plugin.settings.maxCardWidth = width;
        await this.plugin.saveSettings();
      }
    }));
  }
};
var CardViewPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    await this.loadSettings();
    this.registerView(VIEW_TYPE_CARD, (leaf) => new CardView(leaf, this));
    this.addRibbonIcon("layout-grid", "\u5361\u7247\u89C6\u56FE", () => {
      this.activateView();
    });
    this.addSettingTab(new CardViewSettingTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_CARD)[0];
    if (!leaf) {
      leaf = workspace.getLeaf("tab");
      await leaf.setViewState({
        type: VIEW_TYPE_CARD,
        active: true
      });
    }
    workspace.revealLeaf(leaf);
  }
  updateAllCardViews() {
    this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD).forEach((leaf) => {
      const view = leaf.view;
      if (view) {
        view.updateCardSize(this.settings.cardWidth);
      }
    });
  }
  async saveCardWidth(width) {
    this.settings.cardWidth = width;
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJjYXJkVmlldy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBDYXJkVmlldywgVklFV19UWVBFX0NBUkQgfSBmcm9tICcuL2NhcmRWaWV3JztcclxuXHJcbmludGVyZmFjZSBDYXJkVmlld1BsdWdpblNldHRpbmdzIHtcclxuICAgIGRlZmF1bHRWaWV3OiAnY2FyZCcgfCAnbGlzdCcgfCAndGltZWxpbmUnO1xyXG4gICAgY2FyZFdpZHRoOiBudW1iZXI7XHJcbiAgICBtaW5DYXJkV2lkdGg6IG51bWJlcjtcclxuICAgIG1heENhcmRXaWR0aDogbnVtYmVyO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBDYXJkVmlld1BsdWdpblNldHRpbmdzID0ge1xyXG4gICAgZGVmYXVsdFZpZXc6ICdjYXJkJyxcclxuICAgIGNhcmRXaWR0aDogMjgwLFxyXG4gICAgbWluQ2FyZFdpZHRoOiAyODAsXHJcbiAgICBtYXhDYXJkV2lkdGg6IDYwMFxyXG59XHJcblxyXG5jbGFzcyBDYXJkVmlld1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogQ2FyZFZpZXdQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQ2FyZFZpZXdQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU5RUQ4XHU4QkE0XHU4OUM2XHU1NkZFJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1x1OTAwOVx1NjJFOVx1OUVEOFx1OEJBNFx1NzY4NFx1ODlDNlx1NTZGRVx1NkEyMVx1NUYwRicpXHJcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2NhcmQnLCAnXHU1MzYxXHU3MjQ3IFx1ODlDNlx1NTZGRScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignbGlzdCcsICdcdTUyMTdcdTg4NjhcdTg5QzZcdTU2RkUnKVxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ3RpbWVsaW5lJywgJ1x1NjVGNlx1OTVGNFx1OEY3NFx1ODlDNlx1NTZGRScpXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRWaWV3KTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgZHJvcGRvd24ub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlID09PSAnY2FyZCcgfHwgdmFsdWUgPT09ICdsaXN0JyB8fCB2YWx1ZSA9PT0gJ3RpbWVsaW5lJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0VmlldyA9IHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU1MzYxXHU3MjQ3XHU1QkJEXHU1RUE2JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1x1OEJCRVx1N0Y2RVx1NTM2MVx1NzI0N1x1NzY4NFx1NUJCRFx1NUVBNlx1RkYwODI4MC02MDBcdTUwQ0ZcdTdEMjBcdUZGMDknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMjgwJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXJkV2lkdGgudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB3aWR0aCA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTih3aWR0aCkgJiYgd2lkdGggPj0gMjgwICYmIHdpZHRoIDw9IDYwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXJkV2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnVwZGF0ZUFsbENhcmRWaWV3cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTY3MDBcdTVDMEZcdTVCQkRcdTVFQTYnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU4QkJFXHU3RjZFXHU1MzYxXHU3MjQ3XHU3Njg0XHU2NzAwXHU1QzBGXHU1QkJEXHU1RUE2XHVGRjA4XHU1MENGXHU3RDIwXHVGRjA5JylcclxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XHJcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJzI4MCcpXHJcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubWluQ2FyZFdpZHRoLnRvU3RyaW5nKCkpXHJcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgd2lkdGggPSBOdW1iZXIodmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICghaXNOYU4od2lkdGgpICYmIHdpZHRoID49IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5taW5DYXJkV2lkdGggPSB3aWR0aDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NjcwMFx1NTkyN1x1NUJCRFx1NUVBNicpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdThCQkVcdTdGNkVcdTUzNjFcdTcyNDdcdTc2ODRcdTY3MDBcdTU5MjdcdTVCQkRcdTVFQTZcdUZGMDhcdTUwQ0ZcdTdEMjBcdUZGMDknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignNjAwJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5tYXhDYXJkV2lkdGgudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB3aWR0aCA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTih3aWR0aCkgJiYgd2lkdGggPD0gODAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1heENhcmRXaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmRWaWV3UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcclxuICAgIHNldHRpbmdzOiBDYXJkVmlld1BsdWdpblNldHRpbmdzO1xyXG5cclxuICAgIGFzeW5jIG9ubG9hZCgpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xyXG5cclxuICAgICAgICB0aGlzLnJlZ2lzdGVyVmlldyhcclxuICAgICAgICAgICAgVklFV19UWVBFX0NBUkQsXHJcbiAgICAgICAgICAgIChsZWFmOiBXb3Jrc3BhY2VMZWFmKSA9PiBuZXcgQ2FyZFZpZXcobGVhZiwgdGhpcylcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ2xheW91dC1ncmlkJywgJ1x1NTM2MVx1NzI0N1x1ODlDNlx1NTZGRScsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5hY3RpdmF0ZVZpZXcoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBDYXJkVmlld1NldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgYWN0aXZhdGVWaWV3KCkge1xyXG4gICAgICAgIGNvbnN0IHsgd29ya3NwYWNlIH0gPSB0aGlzLmFwcDtcclxuICAgICAgICBcclxuICAgICAgICBsZXQgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NBUkQpWzBdO1xyXG4gICAgICAgIGlmICghbGVhZikge1xyXG4gICAgICAgICAgICBsZWFmID0gd29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICBhd2FpdCBsZWFmLnNldFZpZXdTdGF0ZSh7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBWSUVXX1RZUEVfQ0FSRCxcclxuICAgICAgICAgICAgICAgIGFjdGl2ZTogdHJ1ZSxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHdvcmtzcGFjZS5yZXZlYWxMZWFmKGxlYWYpO1xyXG4gICAgfVxyXG5cclxuICAgIHVwZGF0ZUFsbENhcmRWaWV3cygpIHtcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9DQVJEKS5mb3JFYWNoKGxlYWYgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB2aWV3ID0gbGVhZi52aWV3IGFzIENhcmRWaWV3O1xyXG4gICAgICAgICAgICBpZiAodmlldykge1xyXG4gICAgICAgICAgICAgICAgdmlldy51cGRhdGVDYXJkU2l6ZSh0aGlzLnNldHRpbmdzLmNhcmRXaWR0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzYXZlQ2FyZFdpZHRoKHdpZHRoOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzLmNhcmRXaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2F2ZVNldHRpbmdzKCk7XHJcbiAgICB9XHJcbn0gIiwgImltcG9ydCB7XHJcbiAgICBJdGVtVmlldyxcclxuICAgIFdvcmtzcGFjZUxlYWYsXHJcbiAgICBURmlsZSxcclxuICAgIE1hcmtkb3duUmVuZGVyZXIsXHJcbiAgICBNZW51LFxyXG4gICAgTW9kYWwsXHJcbiAgICBURm9sZGVyLFxyXG4gICAgQXBwLFxyXG4gICAgTm90aWNlXHJcbn0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgQ2FyZFZpZXdQbHVnaW4gZnJvbSAnLi9tYWluJztcclxuXHJcbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfQ0FSRCA9ICdjYXJkLXZpZXcnO1xyXG5cclxuZXhwb3J0IGNsYXNzIENhcmRWaWV3IGV4dGVuZHMgSXRlbVZpZXcge1xyXG4gICAgcHJpdmF0ZSBwbHVnaW46IENhcmRWaWV3UGx1Z2luO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50VmlldzogJ2NhcmQnIHwgJ2xpc3QnIHwgJ3RpbWVsaW5lJztcclxuICAgIHByaXZhdGUgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgdGFnQ29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgY29udGVudENvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHByZXZpZXdDb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBwcmV2aWV3UmVzaXplcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGlzUHJldmlld0NvbGxhcHNlZDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50Rm9sZGVyOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgc2VhcmNoSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRTZWFyY2hUZXJtOiBzdHJpbmcgPSAnJztcclxuICAgIHByaXZhdGUgc2VsZWN0ZWRUYWdzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICAgIHByaXZhdGUgc2VsZWN0ZWROb3RlczogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XHJcbiAgICBwcml2YXRlIGxhc3RTZWxlY3RlZE5vdGU6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSByZWNlbnRGb2xkZXJzOiBzdHJpbmdbXSA9IFtdO1xyXG4gICAgcHJpdmF0ZSBjYXJkU2l6ZTogbnVtYmVyID0gMjgwOyAgLy8gXHU5RUQ4XHU4QkE0XHU1MzYxXHU3MjQ3XHU1QkJEXHU1RUE2XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IE1JTl9DQVJEX1NJWkUgPSAyODA7ICAvLyBcdTY3MDBcdTVDMEZcdTUzNjFcdTcyNDdcdTVCQkRcdTVFQTZcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgTUFYX0NBUkRfU0laRSA9IDYwMDsgIC8vIFx1NjcwMFx1NTkyN1x1NTM2MVx1NzI0N1x1NUJCRFx1NUVBNlxyXG4gICAgcHJpdmF0ZSBjYWxlbmRhckNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGlzQ2FsZW5kYXJWaXNpYmxlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIGN1cnJlbnREYXRlOiBEYXRlID0gbmV3IERhdGUoKTtcclxuICAgIHByaXZhdGUgY3VycmVudEZpbHRlcjogeyB0eXBlOiAnZGF0ZScgfCAnbm9uZScsIHZhbHVlPzogc3RyaW5nIH0gPSB7IHR5cGU6ICdub25lJyB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU2Nzg0XHU5MDIwXHU1MUZEXHU2NTcwXHJcbiAgICAgKiBAcGFyYW0gbGVhZiAtIFx1NURFNVx1NEY1Q1x1NTMzQVx1NTNGNlx1NUI1MFx1ODI4Mlx1NzBCOVxyXG4gICAgICogQHBhcmFtIHBsdWdpbiAtIFx1NjNEMlx1NEVGNlx1NUI5RVx1NEY4QlxyXG4gICAgICovXHJcbiAgICBjb25zdHJ1Y3RvcihsZWFmOiBXb3Jrc3BhY2VMZWFmLCBwbHVnaW46IENhcmRWaWV3UGx1Z2luKSB7XHJcbiAgICAgICAgc3VwZXIobGVhZik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VmlldyA9IHBsdWdpbi5zZXR0aW5ncy5kZWZhdWx0VmlldztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODNCN1x1NTNENlx1ODlDNlx1NTZGRVx1N0M3Qlx1NTc4QlxyXG4gICAgICogQHJldHVybnMgXHU4OUM2XHU1NkZFXHU3QzdCXHU1NzhCXHU2ODA3XHU4QkM2XHU3QjI2XHJcbiAgICAgKi9cclxuICAgIGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIFZJRVdfVFlQRV9DQVJEO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU4M0I3XHU1M0Q2XHU4OUM2XHU1NkZFXHU2NjNFXHU3OTNBXHU2NTg3XHU2NzJDXHJcbiAgICAgKiBAcmV0dXJucyBcdTY2M0VcdTc5M0FcdTU3MjhcdTY4MDdcdTdCN0VcdTk4NzVcdTRFMEFcdTc2ODRcdTY1ODdcdTY3MkNcclxuICAgICAqL1xyXG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gJ1x1NTM2MVx1NzI0N1x1ODlDNlx1NTZGRSc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTg5QzZcdTU2RkVcdTYyNTNcdTVGMDBcdTY1RjZcdTc2ODRcdTUyMURcdTU5Q0JcdTUzMTZcdTUxRkRcdTY1NzBcclxuICAgICAqIFx1NTIxQlx1NUVGQVx1NjgwN1x1N0I3RVx1OEZDN1x1NkVFNFx1NTY2OFx1MzAwMVx1ODlDNlx1NTZGRVx1NTIwN1x1NjM2Mlx1NjMwOVx1OTRBRVx1NTQ4Q1x1NUJCOVx1NTY2OFxyXG4gICAgICovXHJcbiAgICBhc3luYyBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250YWluZXJFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmFkZENsYXNzKCdjYXJkLXZpZXctY29udGFpbmVyJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU0RTNCXHU1RTAzXHU1QzQwXHU1QkI5XHU1NjY4XHJcbiAgICAgICAgY29uc3QgbWFpbkxheW91dCA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdignbWFpbi1sYXlvdXQnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTVERTZcdTRGQTdcdTUxODVcdTVCQjlcdTUzM0FcdTU3REZcclxuICAgICAgICBjb25zdCBjb250ZW50U2VjdGlvbiA9IG1haW5MYXlvdXQuY3JlYXRlRGl2KCdjb250ZW50LXNlY3Rpb24nKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTVERTVcdTUxNzdcdTY4MEZcclxuICAgICAgICBjb25zdCB0b29sYmFyID0gY29udGVudFNlY3Rpb24uY3JlYXRlRGl2KCdjYXJkLXZpZXctdG9vbGJhcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NURFNlx1NEZBN1x1NURFNVx1NTE3N1x1N0VDNFxyXG4gICAgICAgIGNvbnN0IGxlZnRUb29scyA9IHRvb2xiYXIuY3JlYXRlRGl2KCd0b29sYmFyLWxlZnQnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTY1QjBcdTVFRkFcdTdCMTRcdThCQjBcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBuZXdOb3RlQnRuID0gbGVmdFRvb2xzLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIGNsczogJ25ldy1ub3RlLWJ1dHRvbicsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmV3Tm90ZUJ0bi5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImx1Y2lkZSBsdWNpZGUtcGx1c1wiPjxsaW5lIHgxPVwiMTJcIiB5MT1cIjVcIiB4Mj1cIjEyXCIgeTI9XCIxOVwiPjwvbGluZT48bGluZSB4MT1cIjVcIiB5MT1cIjEyXCIgeDI9XCIxOVwiIHkyPVwiMTJcIj48L2xpbmU+PC9zdmc+XHJcbiAgICAgICAgICAgIDxzcGFuPlx1NjVCMFx1NUVGQVx1N0IxNFx1OEJCMDwvc3Bhbj5cclxuICAgICAgICBgO1xyXG4gICAgICAgIG5ld05vdGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmNyZWF0ZU5ld05vdGUoKSk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NjVFNVx1NTM4Nlx1NjMwOVx1OTRBRSAtIFx1NTcyOFx1ODlDNlx1NTZGRVx1NTIwN1x1NjM2Mlx1NjMwOVx1OTRBRVx1NEU0Qlx1NTI0RFx1NkRGQlx1NTJBMFxyXG4gICAgICAgIHRoaXMuY3JlYXRlQ2FsZW5kYXJCdXR0b24obGVmdFRvb2xzKTtcclxuXHJcbiAgICAgICAgLy8gXHU4OUM2XHU1NkZFXHU1MjA3XHU2MzYyXHU2MzA5XHU5NEFFXHU3RUM0XHJcbiAgICAgICAgY29uc3Qgdmlld1N3aXRjaGVyID0gbGVmdFRvb2xzLmNyZWF0ZURpdigndmlldy1zd2l0Y2hlcicpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlVmlld1N3aXRjaGVyKHZpZXdTd2l0Y2hlcik7XHJcblxyXG4gICAgICAgIC8vIFx1NTNGM1x1NEZBN1x1NjQxQ1x1N0QyMlx1Njg0NlxyXG4gICAgICAgIGNvbnN0IHNlYXJjaENvbnRhaW5lciA9IHRvb2xiYXIuY3JlYXRlRGl2KCdzZWFyY2gtY29udGFpbmVyJyk7XHJcbiAgICAgICAgdGhpcy5zZWFyY2hJbnB1dCA9IHNlYXJjaENvbnRhaW5lci5jcmVhdGVFbCgnaW5wdXQnLCB7XHJcbiAgICAgICAgICAgIHR5cGU6ICd0ZXh0JyxcclxuICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdcdTY0MUNcdTdEMjJcdTdCMTRcdThCQjAuLi4nLFxyXG4gICAgICAgICAgICBjbHM6ICdzZWFyY2gtaW5wdXQnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5zZWFyY2hJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50U2VhcmNoVGVybSA9IHRoaXMuc2VhcmNoSW5wdXQudmFsdWU7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2ODA3XHU3QjdFXHU2ODBGXHJcbiAgICAgICAgdGhpcy50YWdDb250YWluZXIgPSBjb250ZW50U2VjdGlvbi5jcmVhdGVEaXYoJ3RhZy1maWx0ZXInKTtcclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWRUYWdzKCk7XHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NEUzQlx1NTE4NVx1NUJCOVx1NTMzQVx1NTdERlxyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRBcmVhID0gY29udGVudFNlY3Rpb24uY3JlYXRlRGl2KCdjYXJkLXZpZXctY29udGVudCcpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyID0gY29udGVudEFyZWEuY3JlYXRlRGl2KCdjYXJkLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NEY3Rlx1NzUyOFx1NEZERFx1NUI1OFx1NzY4NFx1NUJCRFx1NUVBNlx1NTIxRFx1NTlDQlx1NTMxNlx1NTM2MVx1NzI0N1x1NUJCOVx1NTY2OFxyXG4gICAgICAgIHRoaXMuY2FyZFNpemUgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5jYXJkV2lkdGg7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoYXV0by1maWxsLCAke3RoaXMuY2FyZFNpemV9cHgpYDtcclxuXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU5ODg0XHU4OUM4XHU1MzNBXHU1N0RGXHJcbiAgICAgICAgY29uc3QgcHJldmlld1dyYXBwZXIgPSBtYWluTGF5b3V0LmNyZWF0ZURpdigncHJldmlldy13cmFwcGVyJyk7XHJcbiAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyID0gcHJldmlld1dyYXBwZXIuY3JlYXRlRGl2KCdwcmV2aWV3LWNvbnRhaW5lcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1OTg4NFx1ODlDOFx1NjNBN1x1NTIzNlx1NjMwOVx1OTRBRVxyXG4gICAgICAgIGNvbnN0IHByZXZpZXdDb250cm9scyA9IHByZXZpZXdXcmFwcGVyLmNyZWF0ZURpdigncHJldmlldy1jb250cm9scycpO1xyXG4gICAgICAgIGNvbnN0IHRvZ2dsZUJ1dHRvbiA9IHByZXZpZXdDb250cm9scy5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgICAgICBjbHM6ICdwcmV2aWV3LXRvZ2dsZScsXHJcbiAgICAgICAgICAgIGF0dHI6IHsgJ2FyaWEtbGFiZWwnOiAnXHU2Mjk4XHU1M0UwXHU5ODg0XHU4OUM4JyB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdG9nZ2xlQnV0dG9uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjI0XCIgaGVpZ2h0PVwiMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJmZWF0aGVyIGZlYXRoZXItY2hldnJvbi1yaWdodFwiPjxwb2x5bGluZSBwb2ludHM9XCI5IDE4IDE1IDEyIDkgNlwiPjwvcG9seWxpbmU+PC9zdmc+YDtcclxuICAgICAgICBcclxuICAgICAgICB0b2dnbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLnRvZ2dsZVByZXZpZXcoKSk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1OEMwM1x1NjU3NFx1NTkyN1x1NUMwRlx1NzY4NFx1NTI5Rlx1ODBGRFxyXG4gICAgICAgIHRoaXMucHJldmlld1Jlc2l6ZXIgPSBwcmV2aWV3V3JhcHBlci5jcmVhdGVEaXYoJ3ByZXZpZXctcmVzaXplcicpO1xyXG4gICAgICAgIHRoaXMuc2V0dXBSZXNpemVyKCk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NTE2OFx1NUM0MFx1NkVEQVx1OEY2RVx1NEU4Qlx1NEVGNlx1NzZEMVx1NTQyQ1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3doZWVsJywgKGU6IFdoZWVsRXZlbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGUuY3RybEtleSkge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RDYXJkU2l6ZShlLmRlbHRhWSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCB7IHBhc3NpdmU6IGZhbHNlIH0pO1xyXG5cclxuICAgICAgICBhd2FpdCB0aGlzLmxvYWROb3RlcygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU1MkEwXHU4RjdEXHU2MjQwXHU2NzA5XHU2ODA3XHU3QjdFXHU1RTc2XHU1MjFCXHU1RUZBXHU2ODA3XHU3QjdFXHU4RkM3XHU2RUU0XHU1NjY4XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgYXN5bmMgbG9hZFRhZ3MoKSB7XHJcbiAgICAgICAgY29uc3QgdGFncyA9IHRoaXMuZ2V0QWxsVGFncygpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMCBcIkFsbFwiIFx1NjgwN1x1N0I3RVxyXG4gICAgICAgIGNvbnN0IGFsbFRhZ0J0biA9IHRoaXMudGFnQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IFxyXG4gICAgICAgICAgICB0ZXh0OiAnQWxsJyxcclxuICAgICAgICAgICAgY2xzOiAndGFnLWJ0biBhY3RpdmUnICAvLyBcdTlFRDhcdThCQTRcdTkwMDlcdTRFMkRcclxuICAgICAgICB9KTtcclxuICAgICAgICBhbGxUYWdCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xlYXJUYWdTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgYWxsVGFnQnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgdGhpcy5yZWZyZXNoVmlldygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTUxNzZcdTRFRDZcdTY4MDdcdTdCN0VcclxuICAgICAgICB0YWdzLmZvckVhY2godGFnID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdGFnQnRuID0gdGhpcy50YWdDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiB0YWcsXHJcbiAgICAgICAgICAgICAgICBjbHM6ICd0YWctYnRuJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgdGFnQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZVRhZyh0YWcsIHRhZ0J0bik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU4M0I3XHU1M0Q2XHU2MjQwXHU2NzA5XHU3QjE0XHU4QkIwXHU0RTJEXHU3Njg0XHU2ODA3XHU3QjdFXHJcbiAgICAgKiBAcmV0dXJucyBcdTUzQkJcdTkxQ0RcdTU0MEVcdTc2ODRcdTY4MDdcdTdCN0VcdTY1NzBcdTdFQzRcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBnZXRBbGxUYWdzKCk6IHN0cmluZ1tdIHtcclxuICAgICAgICBjb25zdCB0YWdzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgICAgdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAgIGlmIChjYWNoZT8udGFncykge1xyXG4gICAgICAgICAgICAgICAgY2FjaGUudGFncy5mb3JFYWNoKHRhZyA9PiB0YWdzLmFkZCh0YWcudGFnKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0YWdzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTIxQlx1NUVGQVx1ODlDNlx1NTZGRVx1NTIwN1x1NjM2Mlx1NjMwOVx1OTRBRVxyXG4gICAgICogQHBhcmFtIGNvbnRhaW5lciAtIFx1NjMwOVx1OTRBRVx1NUJCOVx1NTY2OFx1NTE0M1x1N0QyMFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGNyZWF0ZVZpZXdTd2l0Y2hlcihjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3Qgdmlld3MgPSBbXHJcbiAgICAgICAgICAgIHsgaWQ6ICdjYXJkJywgaWNvbjogJ2dyaWQnLCB0ZXh0OiAnXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFJyB9LFxyXG4gICAgICAgICAgICB7IGlkOiAnbGlzdCcsIGljb246ICdsaXN0JywgdGV4dDogJ1x1NTIxN1x1ODg2OFx1ODlDNlx1NTZGRScgfSxcclxuICAgICAgICAgICAgeyBpZDogJ3RpbWVsaW5lJywgaWNvbjogJ2Nsb2NrJywgdGV4dDogJ1x1NjVGNlx1OTVGNFx1OEY3NFx1ODlDNlx1NTZGRScgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmlld3MuZm9yRWFjaCh2aWV3ID0+IHtcclxuICAgICAgICAgICAgY29uc3QgYnRuID0gY29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgICAgICBjbHM6IGB2aWV3LXN3aXRjaC1idG4gJHt2aWV3LmlkID09PSB0aGlzLmN1cnJlbnRWaWV3ID8gJ2FjdGl2ZScgOiAnJ31gLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NzZGNFx1NjNBNVx1NEY3Rlx1NzUyOCBTVkcgXHU1NkZFXHU2ODA3XHJcbiAgICAgICAgICAgIGNvbnN0IGljb25IdG1sID0ge1xyXG4gICAgICAgICAgICAgICAgJ2dyaWQnOiAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxyZWN0IHg9XCIzXCIgeT1cIjNcIiB3aWR0aD1cIjdcIiBoZWlnaHQ9XCI3XCI+PC9yZWN0PjxyZWN0IHg9XCIxNFwiIHk9XCIzXCIgd2lkdGg9XCI3XCIgaGVpZ2h0PVwiN1wiPjwvcmVjdD48cmVjdCB4PVwiMTRcIiB5PVwiMTRcIiB3aWR0aD1cIjdcIiBoZWlnaHQ9XCI3XCI+PC9yZWN0PjxyZWN0IHg9XCIzXCIgeT1cIjE0XCIgd2lkdGg9XCI3XCIgaGVpZ2h0PVwiN1wiPjwvcmVjdD48L3N2Zz4nLFxyXG4gICAgICAgICAgICAgICAgJ2xpc3QnOiAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxsaW5lIHgxPVwiOFwiIHkxPVwiNlwiIHgyPVwiMjFcIiB5Mj1cIjZcIj48L2xpbmU+PGxpbmUgeDE9XCI4XCIgeTE9XCIxMlwiIHgyPVwiMjFcIiB5Mj1cIjEyXCI+PC9saW5lPjxsaW5lIHgxPVwiOFwiIHkxPVwiMThcIiB4Mj1cIjIxXCIgeTI9XCIxOFwiPjwvbGluZT48bGluZSB4MT1cIjNcIiB5MT1cIjZcIiB4Mj1cIjMuMDFcIiB5Mj1cIjZcIj48L2xpbmU+PGxpbmUgeDE9XCIzXCIgeTE9XCIxMlwiIHgyPVwiMy4wMVwiIHkyPVwiMTJcIj48L2xpbmU+PGxpbmUgeDE9XCIzXCIgeTE9XCIxOFwiIHgyPVwiMy4wMVwiIHkyPVwiMThcIj48L2xpbmU+PC9zdmc+JyxcclxuICAgICAgICAgICAgICAgICdjbG9jayc6ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGNpcmNsZSBjeD1cIjEyXCIgY3k9XCIxMlwiIHI9XCIxMFwiPjwvY2lyY2xlPjxwb2x5bGluZSBwb2ludHM9XCIxMiA2IDEyIDEyIDE2IDE0XCI+PC9wb2x5bGluZT48L3N2Zz4nXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTU2RkVcclxuICAgICAgICAgICAgY29uc3QgaWNvblNwYW4gPSBidG4uY3JlYXRlU3Bhbih7IGNsczogJ3ZpZXctc3dpdGNoLWljb24nIH0pO1xyXG4gICAgICAgICAgICBpY29uU3Bhbi5pbm5lckhUTUwgPSBpY29uSHRtbFt2aWV3Lmljb25dO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2NTg3XHU1QjU3XHJcbiAgICAgICAgICAgIGJ0bi5jcmVhdGVTcGFuKHsgdGV4dDogdmlldy50ZXh0LCBjbHM6ICd2aWV3LXN3aXRjaC10ZXh0JyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudmlldy1zd2l0Y2gtYnRuJykuZm9yRWFjaChiID0+IGIucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpKTtcclxuICAgICAgICAgICAgICAgIGJ0bi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnN3aXRjaFZpZXcodmlldy5pZCBhcyAnY2FyZCcgfCAnbGlzdCcgfCAndGltZWxpbmUnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTUyQTBcdThGN0RcdTYyNDBcdTY3MDlcdTdCMTRcdThCQjBcdTVFNzZcdTUyMUJcdTVFRkFcdTUzNjFcdTcyNDdcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkTm90ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgLy8gXHU0RjdGXHU3NTI4IFByb21pc2UuYWxsIFx1N0I0OVx1NUY4NVx1NjI0MFx1NjcwOVx1NTM2MVx1NzI0N1x1NTIxQlx1NUVGQVx1NUI4Q1x1NjIxMFxyXG4gICAgICAgIGNvbnN0IGNhcmRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICAgIGZpbGVzLm1hcChmaWxlID0+IHRoaXMuY3JlYXRlTm90ZUNhcmQoZmlsZSkpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU1MjMwXHU1QkI5XHU1NjY4XHVGRjBDXHU1RTc2XHU4QkJFXHU3RjZFXHU2QjYzXHU3ODZFXHU3Njg0XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgaWYgKGNhcmQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgY2FyZC5zdHlsZS53aWR0aCA9IGAke3RoaXMuY2FyZFNpemV9cHhgO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY2FyZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU3ODZFXHU0RkREXHU1QkI5XHU1NjY4XHU0RjdGXHU3NTI4XHU2QjYzXHU3ODZFXHU3Njg0XHU3RjUxXHU2ODNDXHU1MjE3XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoYXV0by1maWxsLCAke3RoaXMuY2FyZFNpemV9cHgpYDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTIxQlx1NUVGQVx1NTM1NVx1NEUyQVx1N0IxNFx1OEJCMFx1NTM2MVx1NzI0N1xyXG4gICAgICogQHBhcmFtIGZpbGUgLSBcdTdCMTRcdThCQjBcdTY1ODdcdTRFRjZcclxuICAgICAqIEByZXR1cm5zIFx1NTM2MVx1NzI0N0hUTUxcdTUxNDNcdTdEMjBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVOb3RlQ2FyZChmaWxlOiBURmlsZSk6IFByb21pc2U8SFRNTEVsZW1lbnQ+IHtcclxuICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgY2FyZC5hZGRDbGFzcygnbm90ZS1jYXJkJyk7XHJcbiAgICAgICAgY2FyZC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcsIGZpbGUucGF0aCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1MzYxXHU3MjQ3XHU1OTM0XHU5MEU4XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gY2FyZC5jcmVhdGVEaXYoJ25vdGUtY2FyZC1oZWFkZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTRGRUVcdTY1MzlcdTY1RjZcdTk1RjRcclxuICAgICAgICBjb25zdCBsYXN0TW9kaWZpZWQgPSBoZWFkZXIuY3JlYXRlRGl2KCdub3RlLWRhdGUnKTtcclxuICAgICAgICBsYXN0TW9kaWZpZWQuc2V0VGV4dChuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpKTtcclxuXHJcbiAgICAgICAgLy8gXHU0RkVFXHU2NTM5XHU2NTg3XHU0RUY2XHU1OTM5XHU4REVGXHU1Rjg0XHU3Njg0XHU1MjFCXHU1RUZBXHU1NDhDXHU2ODM3XHU1RjBGXHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IGhlYWRlci5jcmVhdGVEaXYoJ25vdGUtZm9sZGVyJyk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyID0gZmlsZS5wYXJlbnQgPyAoZmlsZS5wYXJlbnQucGF0aCA9PT0gJy8nID8gJ1x1NjgzOVx1NzZFRVx1NUY1NScgOiBmaWxlLnBhcmVudC5wYXRoKSA6ICdcdTY4MzlcdTc2RUVcdTVGNTUnO1xyXG4gICAgICAgIGZvbGRlclBhdGguc2V0VGV4dChmb2xkZXIpO1xyXG4gICAgICAgIGZvbGRlclBhdGguc2V0QXR0cmlidXRlKCd0aXRsZScsIGBcdTYyNTNcdTVGMDBcdTY1ODdcdTRFRjZcdTU5Mzk6ICR7Zm9sZGVyfWApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlxyXG4gICAgICAgIGZvbGRlclBhdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAvLyBcdTYyNTNcdTVGMDBcdTY1ODdcdTRFRjZcdTU5MzlcclxuICAgICAgICAgICAgY29uc3QgZmlsZUV4cGxvcmVyID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZmlsZS1leHBsb3JlcicpWzBdO1xyXG4gICAgICAgICAgICBpZiAoZmlsZUV4cGxvcmVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRXhwbG9yZXJWaWV3ID0gZmlsZUV4cGxvcmVyLnZpZXcgYXMgYW55O1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHBsb3JlclZpZXcuZXhwYW5kRm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXZlYWxGb2xkZXJJbkV4cGxvcmVyKGZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU4MDVBXHU3MTI2XHU1MjMwXHU2NTg3XHU0RUY2XHU2RDRGXHU4OUM4XHU1NjY4XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZUV4cGxvcmVyLnNldEVwaGVtZXJhbFN0YXRlKHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgY29uc3Qgb3BlbkJ1dHRvbiA9IGhlYWRlci5jcmVhdGVEaXYoJ25vdGUtb3Blbi1idXR0b24nKTtcclxuICAgICAgICBvcGVuQnV0dG9uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBhdGggZD1cIk0xOCAxM3Y2YTIgMiAwIDAgMS0yIDJINWEyIDIgMCAwIDEtMi0yVjhhMiAyIDAgMCAxIDItMmg2XCI+PC9wYXRoPjxwb2x5bGluZSBwb2ludHM9XCIxNSAzIDIxIDMgMjEgOVwiPjwvcG9seWxpbmU+PGxpbmUgeDE9XCIxMFwiIHkxPVwiMTRcIiB4Mj1cIjIxXCIgeTI9XCIzXCI+PC9saW5lPjwvc3ZnPmA7XHJcbiAgICAgICAgb3BlbkJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ1x1NTcyOFx1NjVCMFx1NjgwN1x1N0I3RVx1OTg3NVx1NEUyRFx1NjI1M1x1NUYwMCcpO1xyXG4gICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcwJzsgIC8vIFx1OUVEOFx1OEJBNFx1OTY5MFx1ODVDRlxyXG5cclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTUzNjFcdTcyNDdcdTUxODVcdTVCQjlcdTVCQjlcdTU2NjhcclxuICAgICAgICBjb25zdCBjYXJkQ29udGVudCA9IGNhcmQuY3JlYXRlRGl2KCdub3RlLWNhcmQtY29udGVudCcpO1xyXG5cclxuICAgICAgICAvLyBcdTU5MDRcdTc0MDZcdTY4MDdcdTk4OThcdUZGMDhcdTc5RkJcdTUyMzBcdTUxODVcdTVCQjlcdTUzM0FcdTU3REZcdTk4NzZcdTkwRThcdUZGMDlcclxuICAgICAgICBjb25zdCB0aXRsZSA9IGNhcmRDb250ZW50LmNyZWF0ZURpdignbm90ZS10aXRsZScpO1xyXG4gICAgICAgIGxldCBkaXNwbGF5VGl0bGUgPSBmaWxlLmJhc2VuYW1lO1xyXG4gICAgICAgIC8vIFx1NTkwNFx1NzQwNlx1NjVFNVx1NjcxRlx1NUYwMFx1NTkzNFx1NzY4NFx1NjgwN1x1OTg5OFxyXG4gICAgICAgIGNvbnN0IHRpbWVQYXR0ZXJuID0gL15cXGR7NH1bLS4vXVxcZHsyfVstLi9dXFxkezJ9LztcclxuICAgICAgICBpZiAodGltZVBhdHRlcm4udGVzdChkaXNwbGF5VGl0bGUpKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlUaXRsZSA9IGRpc3BsYXlUaXRsZS5yZXBsYWNlKHRpbWVQYXR0ZXJuLCAnJykudHJpbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aXRsZS5zZXRUZXh0KGRpc3BsYXlUaXRsZSk7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFx1OEJGQlx1NTNENlx1N0IxNFx1OEJCMFx1NTE4NVx1NUJCOVxyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1N0IxNFx1OEJCMFx1NTE4NVx1NUJCOVx1NUJCOVx1NTY2OFxyXG4gICAgICAgICAgICBjb25zdCBub3RlQ29udGVudCA9IGNhcmRDb250ZW50LmNyZWF0ZURpdignbm90ZS1jb250ZW50Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTZFMzJcdTY3RDMgTWFya2Rvd24gXHU1MTg1XHU1QkI5XHJcbiAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oXHJcbiAgICAgICAgICAgICAgICBjb250ZW50LFxyXG4gICAgICAgICAgICAgICAgbm90ZUNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBmaWxlLnBhdGgsXHJcbiAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTlGMjBcdTY4MDdcdTYwQUNcdTUwNUNcdTRFOEJcdTRFRjZcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzEnOyAgLy8gXHU2NjNFXHU3OTNBXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgICAgICAgICB0aXRsZS5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gICAgICAgICAgICAgICAgbm90ZUNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFx1NTcyOFx1OTg4NFx1ODlDOFx1NjgwRlx1NEUyRFx1NjYzRVx1NzkzQVx1NUI4Q1x1NjU3NFx1NTE4NVx1NUJCOVxyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1OTg4NFx1ODlDOFx1NTJBMFx1OEY3RFx1NTkzMVx1OEQyNTonLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzAnOyAgLy8gXHU5NjkwXHU4NUNGXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgICAgICAgICB0aXRsZS5zdHlsZS5vcGFjaXR5ID0gJzEnO1xyXG4gICAgICAgICAgICAgICAgbm90ZUNvbnRlbnQuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTRGRUVcdTY1MzlcdTRFOEJcdTRFRjZcdTc2RDFcdTU0MkNcclxuICAgICAgICAgICAgb3BlbkJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU1MzU1XHU1MUZCXHU5MDA5XHU2MkU5XHJcbiAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVDYXJkU2VsZWN0aW9uKGZpbGUucGF0aCwgZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU1M0NDXHU1MUZCXHU2MjUzXHU1RjAwXHJcbiAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignZGJsY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTUzRjNcdTk1MkVcdTgzRENcdTUzNTVcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNob3dDb250ZXh0TWVudShlLCB0aGlzLmdldFNlbGVjdGVkRmlsZXMoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcdTdCMTRcdThCQjBcdTUyQTBcdThGN0RcdTU5MzFcdThEMjU6JywgZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU1MzYxXHU3MjQ3XHU2MEFDXHU1MDVDXHU0RThCXHU0RUY2XHJcbiAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICBvcGVuQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMSc7ICAvLyBcdTY2M0VcdTc5M0FcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICAgICAgLy8gLi4uIFx1NTE3Nlx1NEVENlx1NjBBQ1x1NTA1Q1x1NEU4Qlx1NEVGNlx1NEVFM1x1NzgwMSAuLi5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWxlYXZlJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBvcGVuQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMCc7ICAvLyBcdTk2OTBcdTg1Q0ZcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICAgICAgLy8gLi4uIFx1NTE3Nlx1NEVENlx1NzlCQlx1NUYwMFx1NEU4Qlx1NEVGNlx1NEVFM1x1NzgwMSAuLi5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNhcmQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTUyMDdcdTYzNjJcdTg5QzZcdTU2RkVcdTZBMjFcdTVGMEZcclxuICAgICAqIEBwYXJhbSB2aWV3IC0gXHU3NkVFXHU2ODA3XHU4OUM2XHU1NkZFXHU2QTIxXHU1RjBGXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc3dpdGNoVmlldyh2aWV3OiAnY2FyZCcgfCAnbGlzdCcgfCAndGltZWxpbmUnKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VmlldyA9IHZpZXc7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc2V0QXR0cmlidXRlKCdkYXRhLXZpZXcnLCB2aWV3KTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICh2aWV3ID09PSAndGltZWxpbmUnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVGltZWxpbmVWaWV3KCk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5sb2FkTm90ZXMoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTY4MzlcdTYzNkVcdTY4MDdcdTdCN0VcdThGQzdcdTZFRTRcdTdCMTRcdThCQjBcclxuICAgICAqIEBwYXJhbSB0YWcgLSBcdTY4MDdcdTdCN0VcdTU0MERcdTc5RjBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBmaWx0ZXJCeVRhZyh0YWc6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAgIHJldHVybiBjYWNoZT8udGFncz8uc29tZSh0ID0+IHQudGFnID09PSB0YWcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTRGN0ZcdTc1MjggUHJvbWlzZS5hbGwgXHU3QjQ5XHU1Rjg1XHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU1MjFCXHU1RUZBXHU1QjhDXHU2MjEwXHJcbiAgICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuICAgICAgICAgICAgZmlsdGVyZWRGaWxlcy5tYXAoZmlsZSA9PiB0aGlzLmNyZWF0ZU5vdGVDYXJkKGZpbGUpKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NjI0MFx1NjcwOVx1NTM2MVx1NzI0N1x1NTIzMFx1NUJCOVx1NTY2OFxyXG4gICAgICAgIGNhcmRzLmZvckVhY2goY2FyZCA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKGNhcmQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTlBRDhcdTRFQUVcdTkwMDlcdTRFMkRcdTc2ODRcdTY4MDdcdTdCN0VcclxuICAgICAgICB0aGlzLnRhZ0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCdidXR0b24nKS5mb3JFYWNoKGJ0biA9PiB7XHJcbiAgICAgICAgICAgIGlmIChidG4udGV4dENvbnRlbnQgPT09IHRhZykge1xyXG4gICAgICAgICAgICAgICAgYnRuLmFkZENsYXNzKCdhY3RpdmUtdGFnJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBidG4ucmVtb3ZlQ2xhc3MoJ2FjdGl2ZS10YWcnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgdG9nZ2xlUHJldmlldygpIHtcclxuICAgICAgICB0aGlzLmlzUHJldmlld0NvbGxhcHNlZCA9ICF0aGlzLmlzUHJldmlld0NvbGxhcHNlZDtcclxuICAgICAgICBpZiAodGhpcy5pc1ByZXZpZXdDb2xsYXBzZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLmFkZENsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTRGRUVcdTY1MzlcdTk4ODRcdTg5QzhcdTY4MEZcdTU5MjdcdTVDMEZcdThDMDNcdTY1NzRcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgc2V0dXBSZXNpemVyKCkge1xyXG4gICAgICAgIGxldCBzdGFydFg6IG51bWJlcjtcclxuICAgICAgICBsZXQgc3RhcnRXaWR0aDogbnVtYmVyO1xyXG5cclxuICAgICAgICBjb25zdCBzdGFydFJlc2l6ZSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgc3RhcnRYID0gZS5wYWdlWDtcclxuICAgICAgICAgICAgc3RhcnRXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5wcmV2aWV3Q29udGFpbmVyKS53aWR0aCwgMTApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCByZXNpemUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgc3RvcFJlc2l6ZSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ2NvbC1yZXNpemUnO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXdSZXNpemVyLmFkZENsYXNzKCdyZXNpemluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc2l6ZSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gc3RhcnRXaWR0aCAtIChlLnBhZ2VYIC0gc3RhcnRYKTtcclxuICAgICAgICAgICAgaWYgKHdpZHRoID49IDUwICYmIHdpZHRoIDw9IDgwMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xyXG4gICAgICAgICAgICAgICAgLy8gXHU4QzAzXHU2NTc0XHU1MzYxXHU3MjQ3XHU1QkI5XHU1NjY4XHU3Njg0XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkanVzdENvbnRlbnRXaWR0aCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmV2aWV3Q29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ByZXZpZXdDb2xsYXBzZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3Qgc3RvcFJlc2l6ZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgcmVzaXplKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN0b3BSZXNpemUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXdSZXNpemVyLnJlbW92ZUNsYXNzKCdyZXNpemluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMucHJldmlld1Jlc2l6ZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3RhcnRSZXNpemUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NkRGQlx1NTJBMFx1NTE4NVx1NUJCOVx1NTMzQVx1NTdERlx1NUJCRFx1NUVBNlx1OEMwM1x1NjU3NFx1NjVCOVx1NkNENVxyXG4gICAgcHJpdmF0ZSBhZGp1c3RDb250ZW50V2lkdGgoKSB7XHJcbiAgICAgICAgY29uc3QgbWFpbkxheW91dCA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm1haW4tbGF5b3V0Jyk7XHJcbiAgICAgICAgY29uc3QgcHJldmlld1dpZHRoID0gdGhpcy5wcmV2aWV3Q29udGFpbmVyLm9mZnNldFdpZHRoO1xyXG4gICAgICAgIGNvbnN0IGNvbnRlbnRTZWN0aW9uID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuY29udGVudC1zZWN0aW9uJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKG1haW5MYXlvdXQgJiYgY29udGVudFNlY3Rpb24pIHtcclxuICAgICAgICAgICAgY29uc3QgdG90YWxXaWR0aCA9IG1haW5MYXlvdXQub2Zmc2V0V2lkdGg7XHJcbiAgICAgICAgICAgIGNvbnN0IG5ld0NvbnRlbnRXaWR0aCA9IHRvdGFsV2lkdGggLSBwcmV2aWV3V2lkdGggLSA0OyAvLyA0cHggXHU2NjJGXHU1MjA2XHU5Njk0XHU3RUJGXHU1QkJEXHU1RUE2XHJcbiAgICAgICAgICAgIGNvbnRlbnRTZWN0aW9uLnN0eWxlLndpZHRoID0gYCR7bmV3Q29udGVudFdpZHRofXB4YDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1OTFDRFx1NjVCMFx1OEJBMVx1N0I5N1x1NTM2MVx1NzI0N1x1NTIxN1x1NjU3MFxyXG4gICAgICAgICAgICBjb25zdCBhdmFpbGFibGVXaWR0aCA9IG5ld0NvbnRlbnRXaWR0aCAtIDMyOyAvLyBcdTUxQ0ZcdTUzQkJcdTUxODVcdThGQjlcdThERERcclxuICAgICAgICAgICAgY29uc3QgY29sdW1ucyA9IE1hdGguZmxvb3IoYXZhaWxhYmxlV2lkdGggLyB0aGlzLmNhcmRTaXplKTtcclxuICAgICAgICAgICAgY29uc3QgZ2FwID0gMTY7IC8vIFx1NTM2MVx1NzI0N1x1OTVGNFx1OERERFxyXG4gICAgICAgICAgICBjb25zdCBhY3R1YWxDYXJkV2lkdGggPSAoYXZhaWxhYmxlV2lkdGggLSAoY29sdW1ucyAtIDEpICogZ2FwKSAvIGNvbHVtbnM7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdCgke2NvbHVtbnN9LCAke2FjdHVhbENhcmRXaWR0aH1weClgO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGhpZ2hsaWdodEZvbGRlcihmb2xkZXI6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlciA9IHRoaXMuY3VycmVudEZvbGRlciA9PT0gZm9sZGVyID8gbnVsbCA6IGZvbGRlcjtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubm90ZS1jYXJkJykuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZm9sZGVyRWxlbWVudCA9IGNhcmQucXVlcnlTZWxlY3RvcignLm5vdGUtZm9sZGVyJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhcmRGb2xkZXIgPSBmb2xkZXJFbGVtZW50ID8gZm9sZGVyRWxlbWVudC50ZXh0Q29udGVudCA6IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChjYXJkRm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnRvZ2dsZUNsYXNzKCdmb2xkZXItaGlnaGxpZ2h0JywgY2FyZEZvbGRlciA9PT0gZm9sZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgcmV2ZWFsRm9sZGVySW5FeHBsb3Jlcihmb2xkZXI6IHN0cmluZykge1xyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFx1ODlDNlx1NTZGRVxyXG4gICAgICAgIGNvbnN0IGZpbGVFeHBsb3JlciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2ZpbGUtZXhwbG9yZXInKVswXTtcclxuICAgICAgICBpZiAoZmlsZUV4cGxvcmVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVFeHBsb3JlclZpZXcgPSBmaWxlRXhwbG9yZXIudmlldyBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTY2MkZcdTY4MzlcdTc2RUVcdTVGNTVcdUZGMENcdTc2RjRcdTYzQTVcdTVDNTVcdTVGMDBcdTY4MzlcdTc2RUVcdTVGNTVcclxuICAgICAgICAgICAgaWYgKGZvbGRlciA9PT0gJ1x1NjgzOVx1NzZFRVx1NUY1NScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXJWaWV3LmV4cGFuZEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVFeHBsb3JlclZpZXcuZXhwYW5kRm9sZGVyKCcvJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFx1NUM1NVx1NUYwMFx1NUU3Nlx1OTAwOVx1NEUyRFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICBpZiAoZmlsZUV4cGxvcmVyVmlldy5leHBhbmRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIFx1NUM1NVx1NUYwMFx1NzIzNlx1NjU4N1x1NEVGNlx1NTkzOVx1OERFRlxyXG4gICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyUGFydHMgPSBmb2xkZXIuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBcdTkwMTBcdTdFQTdcdTVDNTVcdTVGMDBcdTY1ODdcdTRFRjZcdTU5MzlcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBmb2xkZXJQYXJ0cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoICs9IChjdXJyZW50UGF0aCA/ICcvJyA6ICcnKSArIHBhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUV4cGxvcmVyVmlldy5leHBhbmRGb2xkZXIoY3VycmVudFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIFx1OTAwOVx1NEUyRFx1NzZFRVx1NjgwN1x1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHBsb3JlclZpZXcuc2V0U2VsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUV4cGxvcmVyVmlldy5zZXRTZWxlY3Rpb24oZm9sZGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZU5ld05vdGUoKSB7XHJcbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU1RjUzXHU1MjREXHU2NUU1XHU2NzFGXHU0RjVDXHU0RTNBXHU5RUQ4XHU4QkE0XHU2NTg3XHU0RUY2XHU1NDBEXHJcbiAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBgICR7ZGF0ZS50b0xvY2FsZVN0cmluZygpLnJlcGxhY2UoL1svOl0vZywgJy0nKX1cdTY3MkFcdTU0N0RcdTU0MERcdTdCMTRcdThCQjBgO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjVCMFx1N0IxNFx1OEJCMFxyXG4gICAgICAgICAgICBjb25zdCBmaWxlID0gYXdhaXQgdGhpcy5hcHAudmF1bHQuY3JlYXRlKFxyXG4gICAgICAgICAgICAgICAgYCR7ZmlsZU5hbWV9Lm1kYCxcclxuICAgICAgICAgICAgICAgICcjICcgKyBmaWxlTmFtZSArICdcXG5cXG4nXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTU3MjhcdTY1QjBcdTY4MDdcdTdCN0VcdTk4NzVcdTRFMkRcdTYyNTNcdTVGMDBcdTdCMTRcdThCQjBcclxuICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTIzN1x1NjVCMFx1NTM2MVx1NzI0N1x1ODlDNlx1NTZGRVxyXG4gICAgICAgICAgICB0aGlzLmxvYWROb3RlcygpO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1NTIxQlx1NUVGQVx1N0IxNFx1OEJCMFx1NTkzMVx1OEQyNTonLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlVGltZWxpbmVWaWV3KCkge1xyXG4gICAgICAgIGNvbnN0IHRpbWVsaW5lQ29udGFpbmVyID0gdGhpcy5jb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTgzQjdcdTUzRDZcdTYyNDBcdTY3MDlcdTdCMTRcdThCQjBcdTVFNzZcdTYzMDlcdTY1RTVcdTY3MUZcdTUyMDZcdTdFQzRcclxuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgICAgICBjb25zdCBub3Rlc0J5RGF0ZSA9IG5ldyBNYXA8c3RyaW5nLCBURmlsZVtdPigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpO1xyXG4gICAgICAgICAgICBpZiAoIW5vdGVzQnlEYXRlLmhhcyhkYXRlKSkge1xyXG4gICAgICAgICAgICAgICAgbm90ZXNCeURhdGUuc2V0KGRhdGUsIFtdKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjb25zdCBub3RlcyA9IG5vdGVzQnlEYXRlLmdldChkYXRlKTtcclxuICAgICAgICAgICAgaWYgKG5vdGVzKSB7XHJcbiAgICAgICAgICAgICAgICBub3Rlcy5wdXNoKGZpbGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NjMwOVx1NjVFNVx1NjcxRlx1NjM5Mlx1NUU4RlxyXG4gICAgICAgIGNvbnN0IHNvcnRlZERhdGVzID0gQXJyYXkuZnJvbShub3Rlc0J5RGF0ZS5rZXlzKCkpLnNvcnQoKGEsIGIpID0+IFxyXG4gICAgICAgICAgICBuZXcgRGF0ZShiKS5nZXRUaW1lKCkgLSBuZXcgRGF0ZShhKS5nZXRUaW1lKClcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTY1RjZcdTk1RjRcdThGNzRcclxuICAgICAgICBmb3IgKGNvbnN0IGRhdGUgb2Ygc29ydGVkRGF0ZXMpIHtcclxuICAgICAgICAgICAgY29uc3QgZGF0ZUdyb3VwID0gdGltZWxpbmVDb250YWluZXIuY3JlYXRlRGl2KCd0aW1lbGluZS1kYXRlLWdyb3VwJyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTY1RTVcdTY3MUZcdTgyODJcdTcwQjlcclxuICAgICAgICAgICAgY29uc3QgZGF0ZU5vZGUgPSBkYXRlR3JvdXAuY3JlYXRlRGl2KCd0aW1lbGluZS1kYXRlLW5vZGUnKTtcclxuICAgICAgICAgICAgZGF0ZU5vZGUuY3JlYXRlRGl2KCd0aW1lbGluZS1ub2RlLWNpcmNsZScpO1xyXG4gICAgICAgICAgICBkYXRlTm9kZS5jcmVhdGVEaXYoJ3RpbWVsaW5lLWRhdGUtbGFiZWwnKS5zZXRUZXh0KGRhdGUpO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU3QjE0XHU4QkIwXHU1MjE3XHU4ODY4XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdGVzTGlzdCA9IGRhdGVHcm91cC5jcmVhdGVEaXYoJ3RpbWVsaW5lLW5vdGVzLWxpc3QnKTtcclxuICAgICAgICAgICAgY29uc3Qgbm90ZXMgPSBub3Rlc0J5RGF0ZS5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGlmIChub3Rlcykge1xyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIG5vdGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZUl0ZW0gPSBub3Rlc0xpc3QuY3JlYXRlRGl2KCd0aW1lbGluZS1ub3RlLWl0ZW0nKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTY4MDdcdThCQjBcdTdFQkZcclxuICAgICAgICAgICAgICAgICAgICBub3RlSXRlbS5jcmVhdGVEaXYoJ3RpbWVsaW5lLW5vdGUtbWFya2VyJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU3QjE0XHU4QkIwXHU1MTg1XHU1QkI5XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgbm90ZUNvbnRlbnQgPSBub3RlSXRlbS5jcmVhdGVEaXYoJ3RpbWVsaW5lLW5vdGUtY29udGVudCcpO1xyXG4gICAgICAgICAgICAgICAgICAgIG5vdGVDb250ZW50LmNyZWF0ZURpdigndGltZWxpbmUtbm90ZS10aXRsZScpLnNldFRleHQoZmlsZS5iYXNlbmFtZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU3MEI5XHU1MUZCXHU0RThCXHU0RUY2XHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1OTg4NFx1ODlDOFx1NTI5Rlx1ODBGRFxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1OTg4NFx1ODlDOFx1NTJBMFx1OEY3RFx1NTkzMVx1OEQyNTonLCBlcnJvcik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTUzRjNcdTk1MkVcdTgzRENcdTUzNTVcdTUyOUZcdTgwRkRcclxuICAgIHByaXZhdGUgYWRkQ29udGV4dE1lbnUoY2FyZDogSFRNTEVsZW1lbnQsIGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIChldmVudCkgPT4ge1xyXG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NzBCOVx1NTFGQlx1NzY4NFx1NTM2MVx1NzI0N1x1NkNBMVx1NjcwOVx1ODhBQlx1OTAwOVx1NEUyRFx1RkYwQ1x1NEUxNFx1NkNBMVx1NjcwOVx1NjMwOVx1NEY0RiBDdHJsIFx1OTUyRVx1RkYwQ1xyXG4gICAgICAgICAgICAvLyBcdTUyMTlcdTZFMDVcdTk2NjRcdTUxNzZcdTRFRDZcdTkwMDlcdTYyRTlcdTVFNzZcdTkwMDlcdTRFMkRcdTVGNTNcdTUyNERcdTUzNjFcdTcyNDdcclxuICAgICAgICAgICAgY29uc3QgcGF0aCA9IGNhcmQuZ2V0QXR0cmlidXRlKCdkYXRhLXBhdGgnKTtcclxuICAgICAgICAgICAgaWYgKHBhdGggJiYgIXRoaXMuc2VsZWN0ZWROb3Rlcy5oYXMocGF0aCkgJiYgIWV2ZW50LmN0cmxLZXkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb3Rlcy5hZGQocGF0aCk7XHJcbiAgICAgICAgICAgICAgICBjYXJkLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBjb25zdCBzZWxlY3RlZEZpbGVzID0gdGhpcy5nZXRTZWxlY3RlZEZpbGVzKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2hvd0NvbnRleHRNZW51KGV2ZW50LCBzZWxlY3RlZEZpbGVzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTUyMzdcdTY1QjBcdTg5QzZcdTU2RkVcdUZGMDhcdTc1MjhcdTRFOEVcdTY0MUNcdTdEMjJcdTU0OENcdThGQzdcdTZFRTRcdUZGMDlcclxuICAgIHByaXZhdGUgYXN5bmMgcmVmcmVzaFZpZXcoKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IHtcclxuICAgICAgICAgICAgLy8gXHU2NDFDXHU3RDIyXHU4RkM3XHU2RUU0XHJcbiAgICAgICAgICAgIGNvbnN0IG1hdGNoZXNTZWFyY2ggPSAhdGhpcy5jdXJyZW50U2VhcmNoVGVybSB8fCBcclxuICAgICAgICAgICAgICAgIGZpbGUuYmFzZW5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyh0aGlzLmN1cnJlbnRTZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCkpO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU2ODA3XHU3QjdFXHU4RkM3XHU2RUU0XHJcbiAgICAgICAgICAgIGxldCBtYXRjaGVzVGFncyA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVGFncy5zaXplID4gMCkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgICAgIG1hdGNoZXNUYWdzID0gY2FjaGU/LnRhZ3M/LnNvbWUodCA9PiB0aGlzLnNlbGVjdGVkVGFncy5oYXModC50YWcpKSA/PyBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gXHU2NUU1XHU2NzFGXHU4RkM3XHU2RUU0XHJcbiAgICAgICAgICAgIGxldCBtYXRjaGVzRGF0ZSA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWx0ZXIudHlwZSA9PT0gJ2RhdGUnKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRGF0ZSA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRGF0ZVN0ciA9IGZpbGVEYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbHRlci52YWx1ZS5sZW5ndGggPT09IDcpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBcdTYzMDlcdTY3MDhcdTRFRkRcdThGQzdcdTZFRTRcclxuICAgICAgICAgICAgICAgICAgICBtYXRjaGVzRGF0ZSA9IGZpbGVEYXRlU3RyLnN0YXJ0c1dpdGgodGhpcy5jdXJyZW50RmlsdGVyLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU2MzA5XHU1MTc3XHU0RjUzXHU2NUU1XHU2NzFGXHU4RkM3XHU2RUU0XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc0RhdGUgPSBmaWxlRGF0ZVN0ciA9PT0gdGhpcy5jdXJyZW50RmlsdGVyLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlc1NlYXJjaCAmJiBtYXRjaGVzVGFncyAmJiBtYXRjaGVzRGF0ZTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1MzYxXHU3MjQ3XHU1RTc2XHU5QUQ4XHU0RUFFXHU2NDFDXHU3RDIyXHU4QkNEXHJcbiAgICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuICAgICAgICAgICAgZmlsdGVyZWRGaWxlcy5tYXAoZmlsZSA9PiB0aGlzLmNyZWF0ZU5vdGVDYXJkKGZpbGUsIHRoaXMuY3VycmVudFNlYXJjaFRlcm0pKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGNhcmRzLmZvckVhY2goY2FyZCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGNhcmQuc3R5bGUud2lkdGggPSBgJHt0aGlzLmNhcmRTaXplfXB4YDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKGNhcmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KGF1dG8tZmlsbCwgJHt0aGlzLmNhcmRTaXplfXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2REZCXHU1MkEwXHU2ODA3XHU3QjdFXHU1MjA3XHU2MzYyXHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIHRvZ2dsZVRhZyh0YWc6IHN0cmluZywgdGFnQnRuOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVGFncy5oYXModGFnKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGFncy5kZWxldGUodGFnKTtcclxuICAgICAgICAgICAgdGFnQnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGFncy5hZGQodGFnKTtcclxuICAgICAgICAgICAgdGFnQnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFx1NTNENlx1NkQ4OCBcIkFsbFwiIFx1NjgwN1x1N0I3RVx1NzY4NFx1OTAwOVx1NEUyRFx1NzJCNlx1NjAwMVxyXG4gICAgICAgIGNvbnN0IGFsbEJ0biA9IHRoaXMudGFnQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xyXG4gICAgICAgIGlmIChhbGxCdG4pIHtcclxuICAgICAgICAgICAgYWxsQnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTZFMDVcdTk2NjRcdTY4MDdcdTdCN0VcdTkwMDlcdTYyRTlcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgY2xlYXJUYWdTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFRhZ3MuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLnRhZ0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudGFnLWJ0bicpLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgYnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTU5MDRcdTc0MDZcdTUzNjFcdTcyNDdcdTkwMDlcdTYyRTlcclxuICAgIHByaXZhdGUgaGFuZGxlQ2FyZFNlbGVjdGlvbihwYXRoOiBzdHJpbmcsIGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXBhdGg9XCIke3BhdGh9XCJdYCk7XHJcbiAgICAgICAgaWYgKCFjYXJkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChldmVudC5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgIC8vIEN0cmwgKyBcdTcwQjlcdTUxRkJcdUZGMUFcdTUyMDdcdTYzNjJcdTkwMDlcdTYyRTlcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWROb3Rlcy5oYXMocGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb3Rlcy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vdGVzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgICAgIGNhcmQuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnNoaWZ0S2V5ICYmIHRoaXMubGFzdFNlbGVjdGVkTm90ZSkge1xyXG4gICAgICAgICAgICAvLyBTaGlmdCArIFx1NzBCOVx1NTFGQlx1RkYxQVx1OEZERVx1N0VFRFx1OTAwOVx1NjJFOVxyXG4gICAgICAgICAgICBjb25zdCBjYXJkcyA9IEFycmF5LmZyb20odGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm5vdGUtY2FyZCcpKTtcclxuICAgICAgICAgICAgY29uc3QgbGFzdEluZGV4ID0gY2FyZHMuZmluZEluZGV4KGMgPT4gYy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpID09PSB0aGlzLmxhc3RTZWxlY3RlZE5vdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBjYXJkcy5maW5kSW5kZXgoYyA9PiBjLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXRoJykgPT09IHBhdGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1pbihsYXN0SW5kZXgsIGN1cnJlbnRJbmRleCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IE1hdGgubWF4KGxhc3RJbmRleCwgY3VycmVudEluZGV4KTtcclxuXHJcbiAgICAgICAgICAgIGNhcmRzLmZvckVhY2goKGMsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhcmRQYXRoID0gYy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gc3RhcnQgJiYgaSA8PSBlbmQgJiYgY2FyZFBhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZXMuYWRkKGNhcmRQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBjLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBcdTY2NkVcdTkwMUFcdTcwQjlcdTUxRkJcdUZGMUFcdTZFMDVcdTk2NjRcdTUxNzZcdTRFRDZcdTkwMDlcdTYyRTlcdUZGMENcdTkwMDlcdTRFMkRcdTVGNTNcdTUyNERcclxuICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZXMuYWRkKHBhdGgpO1xyXG4gICAgICAgICAgICBjYXJkLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYXN0U2VsZWN0ZWROb3RlID0gcGF0aDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZFMDVcdTk2NjRcdTYyNDBcdTY3MDlcdTkwMDlcdTYyRTlcclxuICAgIHByaXZhdGUgY2xlYXJTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vdGVzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm5vdGUtY2FyZC5zZWxlY3RlZCcpLmZvckVhY2goY2FyZCA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU4M0I3XHU1M0Q2XHU5MDA5XHU0RTJEXHU3Njg0XHU2NTg3XHU0RUY2XHJcbiAgICBwcml2YXRlIGdldFNlbGVjdGVkRmlsZXMoKTogVEZpbGVbXSB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5zZWxlY3RlZE5vdGVzKVxyXG4gICAgICAgICAgICAubWFwKHBhdGggPT4gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpKVxyXG4gICAgICAgICAgICAuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NjYzRVx1NzkzQVx1NTNGM1x1OTUyRVx1ODNEQ1x1NTM1NVxyXG4gICAgcHJpdmF0ZSBzaG93Q29udGV4dE1lbnUoZXZlbnQ6IE1vdXNlRXZlbnQsIGZpbGVzOiBURmlsZVtdKSB7XHJcbiAgICAgICAgY29uc3QgbWVudSA9IG5ldyBNZW51KCk7XHJcblxyXG4gICAgICAgIGlmIChmaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgXHU1NzI4XHU2NUIwXHU2ODA3XHU3QjdFXHU5ODc1XHU2MjUzXHU1RjAwYClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcImxpbmtcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoYFx1NTcyOFx1NjU4N1x1NEVGNlx1N0JBMVx1NzQwNlx1NTY2OFx1NEUyRFx1NjYzRVx1NzkzQWApXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJmb2xkZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlc1swXTsgIC8vIFx1NjYzRVx1NzkzQVx1N0IyQ1x1NEUwMFx1NEUyQVx1OTAwOVx1NEUyRFx1NjU4N1x1NEVGNlx1NzY4NFx1NEY0RFx1N0Y2RVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJldmVhbEZvbGRlckluRXhwbG9yZXIoZmlsZS5wYXJlbnQ/LnBhdGggfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoYFx1NzlGQlx1NTJBOCAke2ZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2YClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcIm1vdmVcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEVuaGFuY2VkRmlsZVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVjZW50Rm9sZGVycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChmb2xkZXJzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNlbnRGb2xkZXJzID0gZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgXHU1MjIwXHU5NjY0ICR7ZmlsZXMubGVuZ3RofSBcdTRFMkFcdTY1ODdcdTRFRjZgKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwidHJhc2hcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCBuZXcgQ29uZmlybU1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlx1Nzg2RVx1OEJBNFx1NTIyMFx1OTY2NFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFx1NjYyRlx1NTQyNlx1Nzg2RVx1NUI5QVx1ODk4MVx1NTIyMFx1OTY2NFx1OTAwOVx1NEUyRFx1NzY4NCAke2ZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2XHVGRjFGYFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25maXJtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC50cmFzaChmaWxlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG1lbnUuc2hvd0F0TW91c2VFdmVudChldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU0RkVFXHU2NTM5XHU4QzAzXHU2NTc0XHU1MzYxXHU3MjQ3XHU1OTI3XHU1QzBGXHU3Njg0XHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIGFkanVzdENhcmRTaXplKGRlbHRhOiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBhZGp1c3RtZW50ID0gZGVsdGEgPiAwID8gLTEwIDogMTA7XHJcbiAgICAgICAgY29uc3QgbmV3U2l6ZSA9IE1hdGgubWF4KFxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5taW5DYXJkV2lkdGgsXHJcbiAgICAgICAgICAgIE1hdGgubWluKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heENhcmRXaWR0aCwgdGhpcy5jYXJkU2l6ZSArIGFkanVzdG1lbnQpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKG5ld1NpemUgIT09IHRoaXMuY2FyZFNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXJkU2l6ZSA9IG5ld1NpemU7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2FyZFNpemUobmV3U2l6ZSk7XHJcbiAgICAgICAgICAgIC8vIFx1NEZERFx1NUI1OFx1NjVCMFx1NzY4NFx1NUJCRFx1NUVBNlxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlQ2FyZFdpZHRoKG5ld1NpemUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTY2RjRcdTY1QjBcdTUzNjFcdTcyNDdcdTU5MjdcdTVDMEZcdTc2ODRcdTY1QjlcdTZDRDVcclxuICAgIHB1YmxpYyB1cGRhdGVDYXJkU2l6ZSh3aWR0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5jYXJkU2l6ZSA9IHdpZHRoO1xyXG4gICAgICAgIC8vIFx1NjZGNFx1NjVCMFx1NjI0MFx1NjcwOVx1NTM2MVx1NzI0N1x1NzY4NFx1NUJCRFx1NUVBNlxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3RlLWNhcmQnKS5mb3JFYWNoKChjYXJkOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGNhcmQuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBcdTY2RjRcdTY1QjBcdTVCQjlcdTU2NjhcdTc2ODRcdTdGNTFcdTY4M0NcdTUyMTdcdTVCQkRcdTVFQTZcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdChhdXRvLWZpbGwsICR7d2lkdGh9cHgpYDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNyZWF0ZUNhbGVuZGFyQnV0dG9uKGxlZnRUb29sczogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCBjYWxlbmRhckJ0biA9IGxlZnRUb29scy5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgICAgICBjbHM6ICdjYWxlbmRhci10b2dnbGUtYnV0dG9uJyxcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYWxlbmRhckJ0bi5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cmVjdCB4PVwiM1wiIHk9XCI0XCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgcng9XCIyXCIgcnk9XCIyXCI+PC9yZWN0PjxsaW5lIHgxPVwiMTZcIiB5MT1cIjJcIiB4Mj1cIjE2XCIgeTI9XCI2XCI+PC9saW5lPjxsaW5lIHgxPVwiOFwiIHkxPVwiMlwiIHgyPVwiOFwiIHkyPVwiNlwiPjwvbGluZT48bGluZSB4MT1cIjNcIiB5MT1cIjEwXCIgeDI9XCIyMVwiIHkyPVwiMTBcIj48L2xpbmU+PC9zdmc+XHJcbiAgICAgICAgICAgIDxzcGFuPlx1NjVFNVx1NTM4Njwvc3Bhbj5cclxuICAgICAgICBgO1xyXG4gICAgICAgIGNhbGVuZGFyQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgICAgIC8vIFx1NTIwN1x1NjM2Mlx1NjMwOVx1OTRBRVx1OUFEOFx1NEVBRVx1NzJCNlx1NjAwMVxyXG4gICAgICAgICAgICBjYWxlbmRhckJ0bi50b2dnbGVDbGFzcygnYWN0aXZlJywgdGhpcy5pc0NhbGVuZGFyVmlzaWJsZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB0b2dnbGVDYWxlbmRhcigpIHtcclxuICAgICAgICB0aGlzLmlzQ2FsZW5kYXJWaXNpYmxlID0gIXRoaXMuaXNDYWxlbmRhclZpc2libGU7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYWxlbmRhclZpc2libGUpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93Q2FsZW5kYXIoKTtcclxuICAgICAgICAgICAgLy8gXHU2NjNFXHU3OTNBXHU1RjUzXHU1MjREXHU2NzA4XHU0RUZEXHU3Njg0XHU2MjQwXHU2NzA5XHU3QjE0XHU4QkIwXHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyTm90ZXNCeU1vbnRoKHRoaXMuY3VycmVudERhdGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgICAgIC8vIFx1NkUwNVx1OTY2NFx1NjVFNVx1NjcxRlx1OEZDN1x1NkVFNFxyXG4gICAgICAgICAgICB0aGlzLmNsZWFyRGF0ZUZpbHRlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTYzMDlcdTY3MDhcdTRFRkRcdThGQzdcdTZFRTRcdTc2ODRcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgZmlsdGVyTm90ZXNCeU1vbnRoKGRhdGU6IERhdGUpIHtcclxuICAgICAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgIGNvbnN0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbHRlciA9IHsgXHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRlJywgXHJcbiAgICAgICAgICAgIHZhbHVlOiBgJHt5ZWFyfS0keyhtb250aCArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gIFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoVmlldygpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2hvd0NhbGVuZGFyKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5jYWxlbmRhckNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICAvLyBcdTRGRUVcdTY1MzlcdUZGMUFcdTVDMDZcdTY1RTVcdTUzODZcdTVCQjlcdTU2NjhcdTZERkJcdTUyQTBcdTUyMzAgY29udGVudC1zZWN0aW9uIFx1NEU0Qlx1NTI0RFxyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50U2VjdGlvbiA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLmNvbnRlbnQtc2VjdGlvbicpO1xyXG4gICAgICAgICAgICBpZiAoIWNvbnRlbnRTZWN0aW9uKSByZXR1cm47XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTU3MjggY29udGVudC1zZWN0aW9uIFx1NEU0Qlx1NTI0RFx1NjNEMlx1NTE2NVx1NjVFNVx1NTM4Nlx1NUJCOVx1NTY2OFxyXG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyID0gY3JlYXRlRGl2KCdjYWxlbmRhci1jb250YWluZXInKTtcclxuICAgICAgICAgICAgY29udGVudFNlY3Rpb24ucGFyZW50RWxlbWVudD8uaW5zZXJ0QmVmb3JlKHRoaXMuY2FsZW5kYXJDb250YWluZXIsIGNvbnRlbnRTZWN0aW9uKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgIHRoaXMucmVuZGVyQ2FsZW5kYXIoKTtcclxuICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NEZFRVx1NjUzOVx1RkYxQVx1NUMwNiB3aXRoLWNhbGVuZGFyIFx1N0M3Qlx1NkRGQlx1NTJBMFx1NTIzMCBtYWluLWxheW91dFxyXG4gICAgICAgIGNvbnN0IG1haW5MYXlvdXQgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5tYWluLWxheW91dCcpO1xyXG4gICAgICAgIGlmIChtYWluTGF5b3V0KSB7XHJcbiAgICAgICAgICAgIG1haW5MYXlvdXQuYWRkQ2xhc3MoJ3dpdGgtY2FsZW5kYXInKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBoaWRlQ2FsZW5kYXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuY2FsZW5kYXJDb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckNvbnRhaW5lci5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTRGRUVcdTY1MzlcdUZGMUFcdTRFQ0UgbWFpbi1sYXlvdXQgXHU3OUZCXHU5NjY0IHdpdGgtY2FsZW5kYXIgXHU3QzdCXHJcbiAgICAgICAgICAgIGNvbnN0IG1haW5MYXlvdXQgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5tYWluLWxheW91dCcpO1xyXG4gICAgICAgICAgICBpZiAobWFpbkxheW91dCkge1xyXG4gICAgICAgICAgICAgICAgbWFpbkxheW91dC5yZW1vdmVDbGFzcygnd2l0aC1jYWxlbmRhcicpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgcmVuZGVyQ2FsZW5kYXIoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNhbGVuZGFyQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHllYXIgPSB0aGlzLmN1cnJlbnREYXRlLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgY29uc3QgbW9udGggPSB0aGlzLmN1cnJlbnREYXRlLmdldE1vbnRoKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2NUU1XHU1Mzg2XHU1OTM0XHU5MEU4XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gdGhpcy5jYWxlbmRhckNvbnRhaW5lci5jcmVhdGVEaXYoJ2NhbGVuZGFyLWhlYWRlcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NEUwQVx1NEUyQVx1NjcwOFx1NjMwOVx1OTRBRVxyXG4gICAgICAgIGNvbnN0IHByZXZCdG4gPSBoZWFkZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnY2FsZW5kYXItbmF2LWJ0bicgfSk7XHJcbiAgICAgICAgcHJldkJ0bi5pbm5lckhUTUwgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwb2x5bGluZSBwb2ludHM9XCIxNSAxOCA5IDEyIDE1IDZcIj48L3BvbHlsaW5lPjwvc3ZnPic7XHJcbiAgICAgICAgcHJldkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIDEpO1xyXG4gICAgICAgICAgICB0aGlzLnJlbmRlckNhbGVuZGFyKCk7XHJcbiAgICAgICAgICAgIC8vIFx1NjYzRVx1NzkzQVx1NjVCMFx1NjcwOFx1NEVGRFx1NzY4NFx1N0IxNFx1OEJCMFxyXG4gICAgICAgICAgICB0aGlzLmZpbHRlck5vdGVzQnlNb250aCh0aGlzLmN1cnJlbnREYXRlKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTY2M0VcdTc5M0FcdTVFNzRcdTY3MDhcclxuICAgICAgICBoZWFkZXIuY3JlYXRlRGl2KCdjYWxlbmRhci10aXRsZScpLnNldFRleHQoXHJcbiAgICAgICAgICAgIGAke3llYXJ9XHU1RTc0JHttb250aCArIDF9XHU2NzA4YFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU0RTBCXHU0RTJBXHU2NzA4XHU2MzA5XHU5NEFFXHJcbiAgICAgICAgY29uc3QgbmV4dEJ0biA9IGhlYWRlci5jcmVhdGVFbCgnYnV0dG9uJywgeyBjbHM6ICdjYWxlbmRhci1uYXYtYnRuJyB9KTtcclxuICAgICAgICBuZXh0QnRuLmlubmVySFRNTCA9ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBvbHlsaW5lIHBvaW50cz1cIjkgMTggMTUgMTIgOSA2XCI+PC9wb2x5bGluZT48L3N2Zz4nO1xyXG4gICAgICAgIG5leHRCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGggKyAxLCAxKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJDYWxlbmRhcigpO1xyXG4gICAgICAgICAgICAvLyBcdTY2M0VcdTc5M0FcdTY1QjBcdTY3MDhcdTRFRkRcdTc2ODRcdTdCMTRcdThCQjBcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJOb3Rlc0J5TW9udGgodGhpcy5jdXJyZW50RGF0ZSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjYxRlx1NTkzNFx1OTBFOFxyXG4gICAgICAgIGNvbnN0IHdlZWtkYXlzID0gWydcdTY1RTUnLCAnXHU0RTAwJywgJ1x1NEU4QycsICdcdTRFMDknLCAnXHU1NkRCJywgJ1x1NEU5NCcsICdcdTUxNkQnXTtcclxuICAgICAgICBjb25zdCB3ZWVrSGVhZGVyID0gdGhpcy5jYWxlbmRhckNvbnRhaW5lci5jcmVhdGVEaXYoJ2NhbGVuZGFyLXdlZWtkYXlzJyk7XHJcbiAgICAgICAgd2Vla2RheXMuZm9yRWFjaChkYXkgPT4ge1xyXG4gICAgICAgICAgICB3ZWVrSGVhZGVyLmNyZWF0ZURpdignd2Vla2RheScpLnNldFRleHQoZGF5KTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2NUU1XHU2NzFGXHU3RjUxXHU2ODNDXHJcbiAgICAgICAgY29uc3QgZ3JpZCA9IHRoaXMuY2FsZW5kYXJDb250YWluZXIuY3JlYXRlRGl2KCdjYWxlbmRhci1ncmlkJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU1RjUzXHU2NzA4XHU3QjJDXHU0RTAwXHU1OTI5XHU2NjJGXHU2NjFGXHU2NzFGXHU1MUUwXHJcbiAgICAgICAgY29uc3QgZmlyc3REYXkgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCwgMSkuZ2V0RGF5KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU1RjUzXHU2NzA4XHU1OTI5XHU2NTcwXHJcbiAgICAgICAgY29uc3QgZGF5c0luTW9udGggPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCArIDEsIDApLmdldERhdGUoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTgzQjdcdTUzRDZcdTZCQ0ZcdTU5MjlcdTc2ODRcdTdCMTRcdThCQjBcdTY1NzBcdTkxQ0ZcclxuICAgICAgICBjb25zdCBub3Rlc0NvdW50ID0gdGhpcy5nZXROb3Rlc0NvdW50QnlEYXRlKHllYXIsIG1vbnRoKTtcclxuXHJcbiAgICAgICAgLy8gXHU1ODZCXHU1MTQ1XHU2NUU1XHU2NzFGXHU2ODNDXHU1QjUwXHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBmaXJzdERheTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGdyaWQuY3JlYXRlRGl2KCdjYWxlbmRhci1kYXkgZW1wdHknKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAobGV0IGRheSA9IDE7IGRheSA8PSBkYXlzSW5Nb250aDsgZGF5KyspIHtcclxuICAgICAgICAgICAgY29uc3QgZGF5RWwgPSBncmlkLmNyZWF0ZURpdignY2FsZW5kYXItZGF5Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGVTdHIgPSBgJHt5ZWFyfS0keyhtb250aCArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX0tJHtkYXkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBkYXlFbC5zZXRUZXh0KGRheS50b1N0cmluZygpKTtcclxuICAgICAgICAgICAgZGF5RWwuc2V0QXR0cmlidXRlKCdkYXRhLWRhdGUnLCBkYXRlU3RyKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NjYyRlx1NUY1M1x1NTI0RFx1OEZDN1x1NkVFNFx1NzY4NFx1NjVFNVx1NjcxRlx1RkYwQ1x1NkRGQlx1NTJBMFx1OTAwOVx1NEUyRFx1NjgzN1x1NUYwRlxyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsdGVyLnR5cGUgPT09ICdkYXRlJyAmJiB0aGlzLmN1cnJlbnRGaWx0ZXIudmFsdWUgPT09IGRhdGVTdHIpIHtcclxuICAgICAgICAgICAgICAgIGRheUVsLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTdCMTRcdThCQjBcdTY1NzBcdTkxQ0ZcdTY4MDdcdThCQjBcclxuICAgICAgICAgICAgY29uc3QgY291bnQgPSBub3Rlc0NvdW50W2RhdGVTdHJdIHx8IDA7XHJcbiAgICAgICAgICAgIGlmIChjb3VudCA+IDApIHtcclxuICAgICAgICAgICAgICAgIGRheUVsLmNyZWF0ZURpdignbm90ZS1jb3VudCcpLnNldFRleHQoY291bnQudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlxyXG4gICAgICAgICAgICBkYXlFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmlsdGVyTm90ZXNCeURhdGUoZGF0ZVN0cik7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldE5vdGVzQ291bnRCeURhdGUoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyKTogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB7XHJcbiAgICAgICAgY29uc3QgY291bnRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcblxyXG4gICAgICAgIGZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpO1xyXG4gICAgICAgICAgICBpZiAoZGF0ZS5nZXRGdWxsWWVhcigpID09PSB5ZWFyICYmIGRhdGUuZ2V0TW9udGgoKSA9PT0gbW9udGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVTdHIgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuICAgICAgICAgICAgICAgIGNvdW50c1tkYXRlU3RyXSA9IChjb3VudHNbZGF0ZVN0cl0gfHwgMCkgKyAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBjb3VudHM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBmaWx0ZXJOb3Rlc0J5RGF0ZShkYXRlU3RyOiBzdHJpbmcpIHtcclxuICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTVERjJcdTdFQ0ZcdTkwMDlcdTRFMkRcdTRFODZcdThGRDlcdTRFMkFcdTY1RTVcdTY3MUZcdUZGMENcdTUyMTlcdTZFMDVcdTk2NjRcdThGQzdcdTZFRTRcclxuICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsdGVyLnR5cGUgPT09ICdkYXRlJyAmJiB0aGlzLmN1cnJlbnRGaWx0ZXIudmFsdWUgPT09IGRhdGVTdHIpIHtcclxuICAgICAgICAgICAgdGhpcy5jbGVhckRhdGVGaWx0ZXIoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gXHU2RTA1XHU5NjY0XHU1MTc2XHU0RUQ2XHU2NUU1XHU2NzFGXHU3Njg0XHU5MDA5XHU0RTJEXHU3MkI2XHU2MDAxXHJcbiAgICAgICAgdGhpcy5jYWxlbmRhckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuY2FsZW5kYXItZGF5JykuZm9yRWFjaChkYXkgPT4ge1xyXG4gICAgICAgICAgICBkYXkucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1OEJCRVx1N0Y2RVx1NjVCMFx1NzY4NFx1OEZDN1x1NkVFNFx1Njc2MVx1NEVGNlxyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbHRlciA9IHsgdHlwZTogJ2RhdGUnLCB2YWx1ZTogZGF0ZVN0ciB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1OUFEOFx1NEVBRVx1OTAwOVx1NEUyRFx1NzY4NFx1NjVFNVx1NjcxRlxyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkRGF5ID0gdGhpcy5jYWxlbmRhckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGAuY2FsZW5kYXItZGF5W2RhdGEtZGF0ZT1cIiR7ZGF0ZVN0cn1cIl1gKTtcclxuICAgICAgICBpZiAoc2VsZWN0ZWREYXkpIHtcclxuICAgICAgICAgICAgc2VsZWN0ZWREYXkuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJlZnJlc2hWaWV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2REZCXHU1MkEwXHU2RTA1XHU5NjY0XHU2NUU1XHU2NzFGXHU4RkM3XHU2RUU0XHU3Njg0XHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIGNsZWFyRGF0ZUZpbHRlcigpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRGaWx0ZXIgPSB7IHR5cGU6ICdub25lJyB9O1xyXG4gICAgICAgIC8vIFx1NkUwNVx1OTY2NFx1NjI0MFx1NjcwOVx1NjVFNVx1NjcxRlx1NzY4NFx1OTAwOVx1NEUyRFx1NzJCNlx1NjAwMVxyXG4gICAgICAgIGlmICh0aGlzLmNhbGVuZGFyQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLmNhbGVuZGFyLWRheScpLmZvckVhY2goZGF5ID0+IHtcclxuICAgICAgICAgICAgICAgIGRheS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIFx1NTIzN1x1NjVCMFx1ODlDNlx1NTZGRVx1NEVFNVx1NjYzRVx1NzkzQVx1NjI0MFx1NjcwOVx1N0IxNFx1OEJCMFxyXG4gICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZU5vdGVDYXJkKGZpbGU6IFRGaWxlLCBzZWFyY2hUZXJtOiBzdHJpbmcgPSAnJyk6IFByb21pc2U8SFRNTEVsZW1lbnQ+IHtcclxuICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgY2FyZC5hZGRDbGFzcygnbm90ZS1jYXJkJyk7XHJcbiAgICAgICAgY2FyZC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcsIGZpbGUucGF0aCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1MzYxXHU3MjQ3XHU1OTM0XHU5MEU4XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gY2FyZC5jcmVhdGVEaXYoJ25vdGUtY2FyZC1oZWFkZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTRGRUVcdTY1MzlcdTY1RjZcdTk1RjRcclxuICAgICAgICBjb25zdCBsYXN0TW9kaWZpZWQgPSBoZWFkZXIuY3JlYXRlRGl2KCdub3RlLWRhdGUnKTtcclxuICAgICAgICBsYXN0TW9kaWZpZWQuc2V0VGV4dChuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpKTtcclxuXHJcbiAgICAgICAgLy8gXHU0RkVFXHU2NTM5XHU2NTg3XHU0RUY2XHU1OTM5XHU4REVGXHU1Rjg0XHU3Njg0XHU1MjFCXHU1RUZBXHU1NDhDXHU2ODM3XHU1RjBGXHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IGhlYWRlci5jcmVhdGVEaXYoJ25vdGUtZm9sZGVyJyk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyID0gZmlsZS5wYXJlbnQgPyAoZmlsZS5wYXJlbnQucGF0aCA9PT0gJy8nID8gJ1x1NjgzOVx1NzZFRVx1NUY1NScgOiBmaWxlLnBhcmVudC5wYXRoKSA6ICdcdTY4MzlcdTc2RUVcdTVGNTUnO1xyXG4gICAgICAgIGZvbGRlclBhdGguc2V0VGV4dChmb2xkZXIpO1xyXG4gICAgICAgIGZvbGRlclBhdGguc2V0QXR0cmlidXRlKCd0aXRsZScsIGBcdTYyNTNcdTVGMDBcdTY1ODdcdTRFRjZcdTU5Mzk6ICR7Zm9sZGVyfWApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlxyXG4gICAgICAgIGZvbGRlclBhdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAvLyBcdTYyNTNcdTVGMDBcdTY1ODdcdTRFRjZcdTU5MzlcclxuICAgICAgICAgICAgY29uc3QgZmlsZUV4cGxvcmVyID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZmlsZS1leHBsb3JlcicpWzBdO1xyXG4gICAgICAgICAgICBpZiAoZmlsZUV4cGxvcmVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRXhwbG9yZXJWaWV3ID0gZmlsZUV4cGxvcmVyLnZpZXcgYXMgYW55O1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHBsb3JlclZpZXcuZXhwYW5kRm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZXZlYWxGb2xkZXJJbkV4cGxvcmVyKGZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU4MDVBXHU3MTI2XHU1MjMwXHU2NTg3XHU0RUY2XHU2RDRGXHU4OUM4XHU1NjY4XHJcbiAgICAgICAgICAgICAgICAgICAgZmlsZUV4cGxvcmVyLnNldEVwaGVtZXJhbFN0YXRlKHsgZm9jdXM6IHRydWUgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgY29uc3Qgb3BlbkJ1dHRvbiA9IGhlYWRlci5jcmVhdGVEaXYoJ25vdGUtb3Blbi1idXR0b24nKTtcclxuICAgICAgICBvcGVuQnV0dG9uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBhdGggZD1cIk0xOCAxM3Y2YTIgMiAwIDAgMS0yIDJINWEyIDIgMCAwIDEtMi0yVjhhMiAyIDAgMCAxIDItMmg2XCI+PC9wYXRoPjxwb2x5bGluZSBwb2ludHM9XCIxNSAzIDIxIDMgMjEgOVwiPjwvcG9seWxpbmU+PGxpbmUgeDE9XCIxMFwiIHkxPVwiMTRcIiB4Mj1cIjIxXCIgeTI9XCIzXCI+PC9saW5lPjwvc3ZnPmA7XHJcbiAgICAgICAgb3BlbkJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgJ1x1NTcyOFx1NjVCMFx1NjgwN1x1N0I3RVx1OTg3NVx1NEUyRFx1NjI1M1x1NUYwMCcpO1xyXG4gICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcwJzsgIC8vIFx1OUVEOFx1OEJBNFx1OTY5MFx1ODVDRlxyXG5cclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTUzNjFcdTcyNDdcdTUxODVcdTVCQjlcdTVCQjlcdTU2NjhcclxuICAgICAgICBjb25zdCBjYXJkQ29udGVudCA9IGNhcmQuY3JlYXRlRGl2KCdub3RlLWNhcmQtY29udGVudCcpO1xyXG5cclxuICAgICAgICAvLyBcdTU5MDRcdTc0MDZcdTY4MDdcdTk4OThcdUZGMDhcdTc5RkJcdTUyMzBcdTUxODVcdTVCQjlcdTUzM0FcdTU3REZcdTk4NzZcdTkwRThcdUZGMDlcclxuICAgICAgICBjb25zdCB0aXRsZSA9IGNhcmRDb250ZW50LmNyZWF0ZURpdignbm90ZS10aXRsZScpO1xyXG4gICAgICAgIGxldCBkaXNwbGF5VGl0bGUgPSBmaWxlLmJhc2VuYW1lO1xyXG4gICAgICAgIC8vIFx1NTkwNFx1NzQwNlx1NjVFNVx1NjcxRlx1NUYwMFx1NTkzNFx1NzY4NFx1NjgwN1x1OTg5OFxyXG4gICAgICAgIGNvbnN0IHRpbWVQYXR0ZXJuID0gL15cXGR7NH1bLS4vXVxcZHsyfVstLi9dXFxkezJ9LztcclxuICAgICAgICBpZiAodGltZVBhdHRlcm4udGVzdChkaXNwbGF5VGl0bGUpKSB7XHJcbiAgICAgICAgICAgIGRpc3BsYXlUaXRsZSA9IGRpc3BsYXlUaXRsZS5yZXBsYWNlKHRpbWVQYXR0ZXJuLCAnJykudHJpbSgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aXRsZS5zZXRUZXh0KGRpc3BsYXlUaXRsZSk7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFx1OEJGQlx1NTNENlx1N0IxNFx1OEJCMFx1NTE4NVx1NUJCOVxyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1N0IxNFx1OEJCMFx1NTE4NVx1NUJCOVx1NUJCOVx1NTY2OFxyXG4gICAgICAgICAgICBjb25zdCBub3RlQ29udGVudCA9IGNhcmRDb250ZW50LmNyZWF0ZURpdignbm90ZS1jb250ZW50Jyk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTU3MjhcdTZFMzJcdTY3RDNcdTUxODVcdTVCQjlcdTRFNEJcdTUyNERcdUZGMENcdTZERkJcdTUyQTBcdTlBRDhcdTRFQUVcdTU5MDRcdTc0MDZcclxuICAgICAgICAgICAgaWYgKHNlYXJjaFRlcm0pIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGhpZ2hsaWdodGVkQ29udGVudCA9IHRoaXMuaGlnaGxpZ2h0U2VhcmNoVGVybShjb250ZW50LCBzZWFyY2hUZXJtKTtcclxuICAgICAgICAgICAgICAgIG5vdGVDb250ZW50LmlubmVySFRNTCA9IGhpZ2hsaWdodGVkQ29udGVudDtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gXHU2RTMyXHU2N0QzIE1hcmtkb3duIFx1NTE4NVx1NUJCOVxyXG4gICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKFxyXG4gICAgICAgICAgICAgICAgY29udGVudCxcclxuICAgICAgICAgICAgICAgIG5vdGVDb250ZW50LFxyXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgdGhpc1xyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU5RjIwXHU2ODA3XHU2MEFDXHU1MDVDXHU0RThCXHU0RUY2XHJcbiAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcxJzsgIC8vIFx1NjYzRVx1NzkzQVx1NjI1M1x1NUYwMFx1NjMwOVx1OTRBRVxyXG4gICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUub3BhY2l0eSA9ICcwJztcclxuICAgICAgICAgICAgICAgIG5vdGVDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBcdTU3MjhcdTk4ODRcdTg5QzhcdTY4MEZcdTRFMkRcdTY2M0VcdTc5M0FcdTVCOENcdTY1NzRcdTUxODVcdTVCQjlcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcdTk4ODRcdTg5QzhcdTUyQTBcdThGN0RcdTU5MzFcdThEMjU6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcclxuICAgICAgICAgICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcwJzsgIC8vIFx1OTY5MFx1ODVDRlx1NjI1M1x1NUYwMFx1NjMwOVx1OTRBRVxyXG4gICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUub3BhY2l0eSA9ICcxJztcclxuICAgICAgICAgICAgICAgIG5vdGVDb250ZW50LnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU0RkVFXHU2NTM5XHU0RThCXHU0RUY2XHU3NkQxXHU1NDJDXHJcbiAgICAgICAgICAgIG9wZW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NTM1NVx1NTFGQlx1OTAwOVx1NjJFOVxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIHRoaXMuaGFuZGxlQ2FyZFNlbGVjdGlvbihmaWxlLnBhdGgsIGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NTNDQ1x1NTFGQlx1NjI1M1x1NUYwMFxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2RibGNsaWNrJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU1M0YzXHU5NTJFXHU4M0RDXHU1MzU1XHJcbiAgICAgICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignY29udGV4dG1lbnUnLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zaG93Q29udGV4dE1lbnUoZSwgdGhpcy5nZXRTZWxlY3RlZEZpbGVzKCkpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignXHU3QjE0XHU4QkIwXHU1MkEwXHU4RjdEXHU1OTMxXHU4RDI1OicsIGVycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NTM2MVx1NzI0N1x1NjBBQ1x1NTA1Q1x1NEU4Qlx1NEVGNlxyXG4gICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzEnOyAgLy8gXHU2NjNFXHU3OTNBXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgICAgIC8vIC4uLiBcdTUxNzZcdTRFRDZcdTYwQUNcdTUwNUNcdTRFOEJcdTRFRjZcdTRFRTNcdTc4MDEgLi4uXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNhcmQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2VsZWF2ZScsICgpID0+IHtcclxuICAgICAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzAnOyAgLy8gXHU5NjkwXHU4NUNGXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgICAgIC8vIC4uLiBcdTUxNzZcdTRFRDZcdTc5QkJcdTVGMDBcdTRFOEJcdTRFRjZcdTRFRTNcdTc4MDEgLi4uXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBjYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGlnaGxpZ2h0U2VhcmNoVGVybShjb250ZW50OiBzdHJpbmcsIHNlYXJjaFRlcm06IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKCFzZWFyY2hUZXJtKSByZXR1cm4gY29udGVudDtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoc2VhcmNoVGVybSwgJ2dpJyk7XHJcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQucmVwbGFjZShyZWdleCwgbWF0Y2ggPT4gYDxzcGFuIGNsYXNzPVwic2VhcmNoLWhpZ2hsaWdodFwiPiR7bWF0Y2h9PC9zcGFuPmApO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBcdTZERkJcdTUyQTBcdTY1ODdcdTRFRjZcdTkwMDlcdTYyRTlcdTZBMjFcdTYwMDFcdTY4NDZcclxuY2xhc3MgRmlsZVNlbGVjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmlsZTogVEZpbGUpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6ICdcdTkwMDlcdTYyRTlcdTc2RUVcdTY4MDdcdTY1ODdcdTRFRjZcdTU5MzknIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBmb2xkZXJMaXN0ID0gY29udGVudEVsLmNyZWF0ZURpdignZm9sZGVyLWxpc3QnKTtcclxuICAgICAgICBjb25zdCBmb2xkZXJzID0gdGhpcy5nZXRGb2xkZXJzKCk7XHJcblxyXG4gICAgICAgIGZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gZm9sZGVyTGlzdC5jcmVhdGVEaXYoJ2ZvbGRlci1pdGVtJyk7XHJcbiAgICAgICAgICAgIGl0ZW0uc2V0VGV4dChmb2xkZXIpO1xyXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5tb3ZlRmlsZShmb2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEZvbGRlcnMoKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IGZvbGRlcnMgPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuICAgICAgICB0aGlzLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgZm9sZGVycy5hZGQoZmlsZS5wYXRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKGZvbGRlcnMpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgbW92ZUZpbGUodGFyZ2V0Rm9sZGVyOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBuZXdQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke3RoaXMuZmlsZS5uYW1lfWA7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZSh0aGlzLmZpbGUsIG5ld1BhdGgpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFx1NkRGQlx1NTJBMFx1Nzg2RVx1OEJBNFx1NUJGOVx1OEJERFx1Njg0NlxyXG5jbGFzcyBDb25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwcml2YXRlIHJlc3VsdDogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSByZXNvbHZlUHJvbWlzZTogKHZhbHVlOiBib29sZWFuKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSB0aXRsZTogc3RyaW5nO1xyXG4gICAgcHJpdmF0ZSBtZXNzYWdlOiBzdHJpbmc7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRpdGxlOiBzdHJpbmcsIG1lc3NhZ2U6IHN0cmluZykge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy50aXRsZSA9IHRpdGxlO1xyXG4gICAgICAgIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2hvdygpOiBQcm9taXNlPGJvb2xlYW4+IHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSA9IHJlc29sdmU7XHJcbiAgICAgICAgICAgIHRoaXMub3BlbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiB0aGlzLnRpdGxlIH0pO1xyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgncCcsIHsgdGV4dDogdGhpcy5tZXNzYWdlIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdidXR0b24tY29udGFpbmVyJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnXHU3ODZFXHU4QkE0JyB9KTtcclxuICAgICAgICBjb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc3VsdCA9IHRydWU7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdcdTUzRDZcdTZEODgnIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXN1bHQgPSBmYWxzZTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2xvc2UoKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcbiAgICAgICAgdGhpcy5yZXNvbHZlUHJvbWlzZSh0aGlzLnJlc3VsdCk7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFx1NEZFRVx1NjUzOVx1NTg5RVx1NUYzQVx1NzY4NFx1NjU4N1x1NEVGNlx1OTAwOVx1NjJFOVx1NkEyMVx1NjAwMVx1Njg0NlxyXG5jbGFzcyBFbmhhbmNlZEZpbGVTZWxlY3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgZmlsZXM6IFRGaWxlW107XHJcbiAgICBwcml2YXRlIHJlY2VudEZvbGRlcnM6IHN0cmluZ1tdO1xyXG4gICAgcHJpdmF0ZSBvbkZvbGRlcnNVcGRhdGU6IChmb2xkZXJzOiBzdHJpbmdbXSkgPT4gdm9pZDtcclxuICAgIHByaXZhdGUgc2VsZWN0ZWRGb2xkZXI6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIGFwcDogQXBwLFxyXG4gICAgICAgIGZpbGVzOiBURmlsZVtdLFxyXG4gICAgICAgIHJlY2VudEZvbGRlcnM6IHN0cmluZ1tdLFxyXG4gICAgICAgIG9uRm9sZGVyc1VwZGF0ZTogKGZvbGRlcnM6IHN0cmluZ1tdKSA9PiB2b2lkXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMuZmlsZXMgPSBmaWxlcztcclxuICAgICAgICB0aGlzLnJlY2VudEZvbGRlcnMgPSByZWNlbnRGb2xkZXJzO1xyXG4gICAgICAgIHRoaXMub25Gb2xkZXJzVXBkYXRlID0gb25Gb2xkZXJzVXBkYXRlO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgLy8gXHU2ODA3XHU5ODk4XHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgXHJcbiAgICAgICAgICAgIHRleHQ6IGBcdTc5RkJcdTUyQTggJHt0aGlzLmZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2YCBcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2NzAwXHU4RkQxXHU0RjdGXHU3NTI4XHU3Njg0XHU2NTg3XHU0RUY2XHU1OTM5XHJcbiAgICAgICAgaWYgKHRoaXMucmVjZW50Rm9sZGVycy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudFNlY3Rpb24gPSBjb250ZW50RWwuY3JlYXRlRGl2KCdyZWNlbnQtZm9sZGVycy1zZWN0aW9uJyk7XHJcbiAgICAgICAgICAgIHJlY2VudFNlY3Rpb24uY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnXHU2NzAwXHU0RjdGXHU3NTI4JyB9KTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGNvbnN0IHJlY2VudExpc3QgPSByZWNlbnRTZWN0aW9uLmNyZWF0ZURpdigncmVjZW50LWZvbGRlcnMtbGlzdCcpO1xyXG4gICAgICAgICAgICB0aGlzLnJlY2VudEZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHJlY2VudExpc3QuY3JlYXRlRGl2KCdmb2xkZXItaXRlbSByZWNlbnQnKTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGV4dChmb2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuc2VsZWN0Rm9sZGVyKGl0ZW0sIGZvbGRlcikpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFx1NjI0MFx1NjcwOVx1NjU4N1x1NEVGNlx1NTkzOVx1NTIxN1x1ODg2OFxyXG4gICAgICAgIGNvbnN0IGZvbGRlckxpc3QgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdmb2xkZXItbGlzdCcpO1xyXG4gICAgICAgIGNvbnN0IGZvbGRlcnMgPSB0aGlzLmdldEZvbGRlcnNXaXRoSGllcmFyY2h5KCk7XHJcbiAgICAgICAgdGhpcy5jcmVhdGVGb2xkZXJUcmVlKGZvbGRlckxpc3QsIGZvbGRlcnMpO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTY0Q0RcdTRGNUNcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBidXR0b25Db250YWluZXIgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdtb2RhbC1idXR0b24tY29udGFpbmVyJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgICAgICB0ZXh0OiAnXHU3ODZFXHU4QkE0XHU3OUZCXHU1MkE4JyxcclxuICAgICAgICAgICAgY2xzOiAnbW9kLWN0YSdcclxuICAgICAgICB9KTtcclxuICAgICAgICBjb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5tb3ZlRmlsZXModGhpcy5zZWxlY3RlZEZvbGRlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIHRleHQ6ICdcdTUzRDZcdTZEODgnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5jbG9zZSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldEZvbGRlcnNXaXRoSGllcmFyY2h5KCk6IEZvbGRlckl0ZW1bXSB7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyczogRm9sZGVySXRlbVtdID0gW107XHJcbiAgICAgICAgY29uc3Qgc2VlbiA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG5cclxuICAgICAgICB0aGlzLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcGFydHMgPSBmaWxlLnBhdGguc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgbGV0IGxldmVsID0gMDtcclxuXHJcbiAgICAgICAgICAgICAgICBwYXJ0cy5mb3JFYWNoKHBhcnQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChwYXJ0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoICs9IChjdXJyZW50UGF0aCA/ICcvJyA6ICcnKSArIHBhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghc2Vlbi5oYXMoY3VycmVudFBhdGgpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWVuLmFkZChjdXJyZW50UGF0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb2xkZXJzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhdGg6IGN1cnJlbnRQYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHBhcnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWw6IGxldmVsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXZlbCsrO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBmb2xkZXJzLnNvcnQoKGEsIGIpID0+IGEucGF0aC5sb2NhbGVDb21wYXJlKGIucGF0aCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgY3JlYXRlRm9sZGVyVHJlZShjb250YWluZXI6IEhUTUxFbGVtZW50LCBmb2xkZXJzOiBGb2xkZXJJdGVtW10pIHtcclxuICAgICAgICBmb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbSA9IGNvbnRhaW5lci5jcmVhdGVEaXYoe1xyXG4gICAgICAgICAgICAgICAgY2xzOiAnZm9sZGVyLWl0ZW0nXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU3RjI5XHU4RkRCXHJcbiAgICAgICAgICAgIGl0ZW0uc3R5bGUucGFkZGluZ0xlZnQgPSBgJHtmb2xkZXIubGV2ZWwgKiAyMCArIDEwfXB4YDtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NjU4N1x1NEVGNlx1NTkzOVx1NTZGRVx1NjgwN1xyXG4gICAgICAgICAgICBjb25zdCBpY29uID0gaXRlbS5jcmVhdGVTcGFuKHtcclxuICAgICAgICAgICAgICAgIGNsczogJ2ZvbGRlci1pY29uJ1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaWNvbi5pbm5lckhUTUwgPSBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwYXRoIGQ9XCJNMjIgMTlhMiAyIDAgMCAxLTIgMkg0YTIgMiAwIDAgMS0yLTJWNWEyIDIgMCAwIDEgMi0yaDVsMiAzaDlhMiAyIDAgMCAxIDIgMnpcIj48L3BhdGg+PC9zdmc+YDtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NjU4N1x1NEVGNlx1NTkzOVx1NTQwRFx1NzlGMFxyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gaXRlbS5jcmVhdGVTcGFuKHtcclxuICAgICAgICAgICAgICAgIGNsczogJ2ZvbGRlci1uYW1lJyxcclxuICAgICAgICAgICAgICAgIHRleHQ6IGZvbGRlci5uYW1lXHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuc2VsZWN0Rm9sZGVyKGl0ZW0sIGZvbGRlci5wYXRoKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBzZWxlY3RGb2xkZXIoZWxlbWVudDogSFRNTEVsZW1lbnQsIHBhdGg6IHN0cmluZykge1xyXG4gICAgICAgIC8vIFx1NzlGQlx1OTY2NFx1NTE3Nlx1NEVENlx1OTAwOVx1NEUyRFx1NzJCNlx1NjAwMVxyXG4gICAgICAgIHRoaXMuY29udGVudEVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5mb2xkZXItaXRlbScpLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAgIGl0ZW0ucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1OTAwOVx1NEUyRFx1NzJCNlx1NjAwMVxyXG4gICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZEZvbGRlciA9IHBhdGg7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBtb3ZlRmlsZXModGFyZ2V0Rm9sZGVyOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBjb25maXJtTW9kYWwgPSBuZXcgQ29uZmlybU1vZGFsKFxyXG4gICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgXCJcdTc4NkVcdThCQTRcdTc5RkJcdTUyQThcIixcclxuICAgICAgICAgICAgYFx1NjYyRlx1NTQyNlx1NUMwNlx1OTAwOVx1NEUyRFx1NzY4NCAke3RoaXMuZmlsZXMubGVuZ3RofSBcdTRFMkFcdTY1ODdcdTRFRjZcdTc5RkJcdTUyQThcdTUyMzAgXCIke3RhcmdldEZvbGRlcn1cIlx1RkYxRmBcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoYXdhaXQgY29uZmlybU1vZGFsLnNob3coKSkge1xyXG4gICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgdGhpcy5maWxlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3UGF0aCA9IGAke3RhcmdldEZvbGRlcn0vJHtmaWxlLm5hbWV9YDtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUoZmlsZSwgbmV3UGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFx1NjZGNFx1NjVCMFx1NjcwMFx1OEZEMVx1NEY3Rlx1NzUyOFx1NzY4NFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICB0aGlzLnJlY2VudEZvbGRlcnMgPSBbdGFyZ2V0Rm9sZGVyLCAuLi50aGlzLnJlY2VudEZvbGRlcnMuZmlsdGVyKGYgPT4gZiAhPT0gdGFyZ2V0Rm9sZGVyKV1cclxuICAgICAgICAgICAgICAgIC5zbGljZSgwLCA1KTtcclxuICAgICAgICAgICAgdGhpcy5vbkZvbGRlcnNVcGRhdGUodGhpcy5yZWNlbnRGb2xkZXJzKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFx1NkRGQlx1NTJBMFx1NjU4N1x1NEVGNlx1NTkzOVx1OTg3OVx1NjNBNVx1NTNFM1xyXG5pbnRlcmZhY2UgRm9sZGVySXRlbSB7XHJcbiAgICBwYXRoOiBzdHJpbmc7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICBsZXZlbDogbnVtYmVyO1xyXG59ICJdLAogICJtYXBwaW5n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
