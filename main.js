/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// main.ts
__export(exports, {
  default: () => CardViewPlugin
});
var import_obsidian2 = __toModule(require("obsidian"));

// cardView.ts
var import_obsidian = __toModule(require("obsidian"));
var VIEW_TYPE_CARD = "card-view";
var CardView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.isPreviewCollapsed = false;
    this.currentFolder = null;
    this.currentSearchTerm = "";
    this.selectedTags = new Set();
    this.selectedNotes = new Set();
    this.lastSelectedNote = null;
    this.recentFolders = [];
    this.cardSize = 280;
    this.MIN_CARD_SIZE = 280;
    this.MAX_CARD_SIZE = 600;
    this.isCalendarVisible = false;
    this.currentDate = new Date();
    this.currentFilter = { type: "none" };
    this.plugin = plugin;
    this.currentView = plugin.settings.defaultView;
  }
  getViewType() {
    return VIEW_TYPE_CARD;
  }
  getDisplayText() {
    return "\u5361\u7247\u89C6\u56FE";
  }
  async onOpen() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("card-view-container");
    const mainLayout = containerEl.createDiv("main-layout");
    const contentSection = mainLayout.createDiv("content-section");
    const toolbar = contentSection.createDiv("card-view-toolbar");
    const leftTools = toolbar.createDiv("toolbar-left");
    const newNoteBtn = leftTools.createEl("button", {
      cls: "new-note-button"
    });
    newNoteBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            <span>\u65B0\u5EFA\u7B14\u8BB0</span>
        `;
    newNoteBtn.addEventListener("click", () => this.createNewNote());
    this.createCalendarButton(leftTools);
    const viewSwitcher = leftTools.createDiv("view-switcher");
    this.createViewSwitcher(viewSwitcher);
    const searchContainer = toolbar.createDiv("search-container");
    this.searchInput = searchContainer.createEl("input", {
      type: "text",
      placeholder: "\u641C\u7D22\u7B14\u8BB0...",
      cls: "search-input"
    });
    this.searchInput.addEventListener("input", () => {
      this.currentSearchTerm = this.searchInput.value;
      this.refreshView();
    });
    this.tagContainer = contentSection.createDiv("tag-filter");
    await this.loadTags();
    const contentArea = contentSection.createDiv("card-view-content");
    this.container = contentArea.createDiv("card-container");
    this.cardSize = this.plugin.settings.cardWidth;
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
    const previewWrapper = mainLayout.createDiv("preview-wrapper");
    this.previewContainer = previewWrapper.createDiv("preview-container");
    const previewControls = previewWrapper.createDiv("preview-controls");
    const toggleButton = previewControls.createEl("button", {
      cls: "preview-toggle",
      attr: { "aria-label": "\u6298\u53E0\u9884\u89C8" }
    });
    toggleButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>`;
    toggleButton.addEventListener("click", () => this.togglePreview());
    this.previewResizer = previewWrapper.createDiv("preview-resizer");
    this.setupResizer();
    document.addEventListener("wheel", (e) => {
      if (e.ctrlKey) {
        e.preventDefault();
        this.adjustCardSize(e.deltaY);
      }
    }, { passive: false });
    await this.loadNotes();
  }
  async loadTags() {
    const tags = this.getAllTags();
    const allTagBtn = this.tagContainer.createEl("button", {
      text: "All",
      cls: "tag-btn active"
    });
    allTagBtn.addEventListener("click", () => {
      this.clearTagSelection();
      allTagBtn.addClass("active");
      this.refreshView();
    });
    tags.forEach((tag) => {
      const tagBtn = this.tagContainer.createEl("button", {
        text: tag,
        cls: "tag-btn"
      });
      tagBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        this.toggleTag(tag, tagBtn);
      });
    });
  }
  getAllTags() {
    const tags = new Set();
    this.app.vault.getMarkdownFiles().forEach((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      if (cache == null ? void 0 : cache.tags) {
        cache.tags.forEach((tag) => tags.add(tag.tag));
      }
    });
    return Array.from(tags);
  }
  createViewSwitcher(container) {
    const views = [
      { id: "card", icon: "grid", text: "\u5361\u7247\u89C6\u56FE" },
      { id: "list", icon: "list", text: "\u5217\u8868\u89C6\u56FE" },
      { id: "timeline", icon: "clock", text: "\u65F6\u95F4\u8F74\u89C6\u56FE" }
    ];
    views.forEach((view) => {
      const btn = container.createEl("button", {
        cls: `view-switch-btn ${view.id === this.currentView ? "active" : ""}`
      });
      const iconHtml = {
        "grid": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>',
        "list": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',
        "clock": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>'
      };
      const iconSpan = btn.createSpan({ cls: "view-switch-icon" });
      iconSpan.innerHTML = iconHtml[view.icon];
      btn.createSpan({ text: view.text, cls: "view-switch-text" });
      btn.addEventListener("click", () => {
        container.querySelectorAll(".view-switch-btn").forEach((b) => b.removeClass("active"));
        btn.addClass("active");
        this.switchView(view.id);
      });
    });
  }
  async loadNotes() {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const cards = await Promise.all(files.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${this.cardSize}px`;
        this.container.appendChild(card);
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
  }
  async createNoteCard(file) {
    const card = document.createElement("div");
    card.addClass("note-card");
    card.setAttribute("data-path", file.path);
    const header = card.createDiv("note-card-header");
    const lastModified = header.createDiv("note-date");
    lastModified.setText(new Date(file.stat.mtime).toLocaleDateString());
    const folderPath = header.createDiv("note-folder");
    const folder = file.parent ? file.parent.path === "/" ? "\u6839\u76EE\u5F55" : file.parent.path : "\u6839\u76EE\u5F55";
    folderPath.setText(folder);
    folderPath.setAttribute("title", `\u6253\u5F00\u6587\u4EF6\u5939: ${folder}`);
    folderPath.addClass("clickable");
    folderPath.addEventListener("click", async (e) => {
      console.log("\u70B9\u51FB\u4E86\u6587\u4EF6\u5939", e);
      e.stopPropagation();
      e.preventDefault();
      console.log("\u70B9\u51FB\u4E86\u6587\u4EF6\u5939", e);
      const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
      if (fileExplorer) {
        console.log("fileExplorer", fileExplorer);
        this.app.workspace.revealLeaf(fileExplorer);
        const fileExplorerView = fileExplorer.view;
        if (fileExplorerView.expandFolder) {
          await this.revealFolderInExplorer(folder);
          fileExplorer.setEphemeralState({ focus: true });
          folderPath.addClass("folder-clicked");
          setTimeout(() => {
            folderPath.removeClass("folder-clicked");
          }, 200);
        }
      }
    });
    const openButton = header.createDiv("note-open-button");
    openButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>`;
    openButton.setAttribute("title", "\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00");
    openButton.style.opacity = "0";
    const cardContent = card.createDiv("note-card-content");
    const title = cardContent.createDiv("note-title");
    let displayTitle = file.basename;
    const timePattern = /^\d{4}[-./]\d{2}[-./]\d{2}/;
    if (timePattern.test(displayTitle)) {
      displayTitle = displayTitle.replace(timePattern, "").trim();
    }
    title.setText(displayTitle);
    try {
      const content = await this.app.vault.read(file);
      const noteContent = cardContent.createDiv("note-content");
      await import_obsidian.MarkdownRenderer.renderMarkdown(content, noteContent, file.path, this);
      card.addEventListener("mouseenter", async () => {
        openButton.style.opacity = "1";
        title.style.opacity = "0";
        title.style.display = "none";
        noteContent.style.opacity = "1";
        try {
          this.previewContainer.empty();
          await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
        } catch (error) {
          console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
        }
      });
      card.addEventListener("mouseleave", () => {
        openButton.style.opacity = "0";
        title.style.opacity = "1";
        title.style.display = "block";
        noteContent.style.opacity = "0.3";
      });
      openButton.addEventListener("click", async (e) => {
        e.stopPropagation();
        await this.openInAppropriateLeaf(file);
      });
      card.addEventListener("click", (e) => {
        this.handleCardSelection(file.path, e);
      });
      card.addEventListener("dblclick", async () => {
        await this.openInAppropriateLeaf(file);
      });
      card.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        this.showContextMenu(e, this.getSelectedFiles());
      });
    } catch (error) {
      console.error("\u7B14\u8BB0\u52A0\u8F7D\u5931\u8D25:", error);
    }
    card.addEventListener("mouseenter", async () => {
      openButton.style.opacity = "1";
    });
    card.addEventListener("mouseleave", () => {
      openButton.style.opacity = "0";
    });
    return card;
  }
  switchView(view) {
    this.currentView = view;
    this.container.setAttribute("data-view", view);
    this.container.empty();
    if (view === "timeline") {
      this.createTimelineView();
    } else {
      this.loadNotes();
    }
  }
  async filterByTag(tag) {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const filteredFiles = files.filter((file) => {
      var _a;
      const cache = this.app.metadataCache.getFileCache(file);
      return (_a = cache == null ? void 0 : cache.tags) == null ? void 0 : _a.some((t) => t.tag === tag);
    });
    const cards = await Promise.all(filteredFiles.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      this.container.appendChild(card);
    });
    this.tagContainer.querySelectorAll("button").forEach((btn) => {
      if (btn.textContent === tag) {
        btn.addClass("active-tag");
      } else {
        btn.removeClass("active-tag");
      }
    });
  }
  togglePreview() {
    this.isPreviewCollapsed = !this.isPreviewCollapsed;
    if (this.isPreviewCollapsed) {
      this.previewContainer.addClass("collapsed");
    } else {
      this.previewContainer.removeClass("collapsed");
    }
  }
  setupResizer() {
    let startX;
    let startWidth;
    const startResize = (e) => {
      e.preventDefault();
      startX = e.pageX;
      startWidth = parseInt(getComputedStyle(this.previewContainer).width, 10);
      document.addEventListener("mousemove", resize);
      document.addEventListener("mouseup", stopResize);
      document.body.style.cursor = "col-resize";
      this.previewResizer.addClass("resizing");
    };
    const resize = (e) => {
      const width = startWidth - (e.pageX - startX);
      if (width >= 50 && width <= 800) {
        this.previewContainer.style.width = `${width}px`;
        this.adjustContentWidth();
        if (this.isPreviewCollapsed) {
          this.isPreviewCollapsed = false;
          this.previewContainer.removeClass("collapsed");
        }
      }
    };
    const stopResize = () => {
      document.removeEventListener("mousemove", resize);
      document.removeEventListener("mouseup", stopResize);
      document.body.style.cursor = "";
      this.previewResizer.removeClass("resizing");
    };
    this.previewResizer.addEventListener("mousedown", startResize);
  }
  adjustContentWidth() {
    const mainLayout = this.containerEl.querySelector(".main-layout");
    const previewWidth = this.previewContainer.offsetWidth;
    const contentSection = this.containerEl.querySelector(".content-section");
    if (mainLayout && contentSection) {
      const totalWidth = mainLayout.offsetWidth;
      const newContentWidth = totalWidth - previewWidth - 4;
      contentSection.style.width = `${newContentWidth}px`;
      const availableWidth = newContentWidth - 32;
      const columns = Math.floor(availableWidth / this.cardSize);
      const gap = 16;
      const actualCardWidth = (availableWidth - (columns - 1) * gap) / columns;
      this.container.style.gridTemplateColumns = `repeat(${columns}, ${actualCardWidth}px)`;
    }
  }
  highlightFolder(folder) {
    this.currentFolder = this.currentFolder === folder ? null : folder;
    this.container.querySelectorAll(".note-card").forEach((card) => {
      const folderElement = card.querySelector(".note-folder");
      const cardFolder = folderElement ? folderElement.textContent : null;
      if (cardFolder) {
        card.toggleClass("folder-highlight", cardFolder === folder);
      }
    });
  }
  async revealFolderInExplorer(folder) {
    const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
    if (fileExplorer) {
      const fileExplorerView = fileExplorer.view;
      if (folder === "\u6839\u76EE\u5F55") {
        if (fileExplorerView.expandFolder) {
          await fileExplorerView.expandFolder("/");
        }
        return;
      }
      if (fileExplorerView.expandFolder) {
        const folderParts = folder.split("/");
        let currentPath = "";
        for (const part of folderParts) {
          currentPath += (currentPath ? "/" : "") + part;
          await fileExplorerView.expandFolder(currentPath);
        }
        if (fileExplorerView.setSelection) {
          await fileExplorerView.setSelection(folder);
        }
      }
    }
  }
  async createNewNote() {
    const date = new Date();
    const fileName = ` ${date.toLocaleString().replace(/[/:]/g, "-")}\u672A\u547D\u540D\u7B14\u8BB0`;
    try {
      const file = await this.app.vault.create(`${fileName}.md`, "# " + fileName + "\n\n");
      const leaf = this.app.workspace.getLeaf("tab");
      await leaf.openFile(file);
      this.loadNotes();
    } catch (error) {
      console.error("\u521B\u5EFA\u7B14\u8BB0\u5931\u8D25:", error);
    }
  }
  async createTimelineView() {
    const timelineContainer = this.container.createDiv("timeline-container");
    const files = this.app.vault.getMarkdownFiles();
    const notesByDate = new Map();
    files.forEach((file) => {
      const date = new Date(file.stat.mtime).toLocaleDateString();
      if (!notesByDate.has(date)) {
        notesByDate.set(date, []);
      }
      const notes = notesByDate.get(date);
      if (notes) {
        notes.push(file);
      }
    });
    const sortedDates = Array.from(notesByDate.keys()).sort((a, b) => new Date(b).getTime() - new Date(a).getTime());
    for (const date of sortedDates) {
      const dateGroup = timelineContainer.createDiv("timeline-date-group");
      const dateNode = dateGroup.createDiv("timeline-date-node");
      dateNode.createDiv("timeline-node-circle");
      dateNode.createDiv("timeline-date-label").setText(date);
      const notesList = dateGroup.createDiv("timeline-notes-list");
      const notes = notesByDate.get(date);
      if (notes) {
        for (const file of notes) {
          const noteItem = notesList.createDiv("timeline-note-item");
          noteItem.createDiv("timeline-note-marker");
          const noteContent = noteItem.createDiv("timeline-note-content");
          noteContent.createDiv("timeline-note-title").setText(file.basename);
          noteItem.addEventListener("click", async () => {
            const leaf = this.app.workspace.getLeaf("tab");
            await leaf.openFile(file);
          });
          noteItem.addEventListener("mouseenter", async () => {
            try {
              this.previewContainer.empty();
              const content = await this.app.vault.read(file);
              await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
            } catch (error) {
              console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
            }
          });
        }
      }
    }
  }
  async refreshView() {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const filteredFiles = files.filter((file) => {
      var _a, _b;
      const matchesSearch = !this.currentSearchTerm || file.basename.toLowerCase().includes(this.currentSearchTerm.toLowerCase());
      let matchesTags = true;
      if (this.selectedTags.size > 0) {
        const cache = this.app.metadataCache.getFileCache(file);
        matchesTags = (_b = (_a = cache == null ? void 0 : cache.tags) == null ? void 0 : _a.some((t) => this.selectedTags.has(t.tag))) != null ? _b : false;
      }
      let matchesDate = true;
      if (this.currentFilter.type === "date") {
        const fileDate = new Date(file.stat.mtime);
        const fileDateStr = fileDate.toISOString().split("T")[0];
        if (this.currentFilter.value.length === 7) {
          matchesDate = fileDateStr.startsWith(this.currentFilter.value);
        } else {
          matchesDate = fileDateStr === this.currentFilter.value;
        }
      }
      return matchesSearch && matchesTags && matchesDate;
    });
    const cards = await Promise.all(filteredFiles.map((file) => this.createNoteCard(file, this.currentSearchTerm)));
    cards.forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${this.cardSize}px`;
        this.container.appendChild(card);
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
  }
  toggleTag(tag, tagBtn) {
    if (this.selectedTags.has(tag)) {
      this.selectedTags.delete(tag);
      tagBtn.removeClass("active");
    } else {
      this.selectedTags.add(tag);
      tagBtn.addClass("active");
    }
    const allBtn = this.tagContainer.querySelector("button");
    if (allBtn) {
      allBtn.removeClass("active");
    }
    this.refreshView();
  }
  clearTagSelection() {
    this.selectedTags.clear();
    this.tagContainer.querySelectorAll(".tag-btn").forEach((btn) => {
      btn.removeClass("active");
    });
  }
  handleCardSelection(path, event) {
    const card = this.container.querySelector(`[data-path="${path}"]`);
    if (!card) {
      this.clearSelection();
      return;
    }
    if (event.ctrlKey) {
      if (this.selectedNotes.has(path)) {
        this.selectedNotes.delete(path);
        card.removeClass("selected");
      } else {
        this.selectedNotes.add(path);
        card.addClass("selected");
      }
    } else if (event.shiftKey && this.lastSelectedNote) {
      const cards = Array.from(this.container.querySelectorAll(".note-card"));
      const lastIndex = cards.findIndex((c) => c.getAttribute("data-path") === this.lastSelectedNote);
      const currentIndex = cards.findIndex((c) => c.getAttribute("data-path") === path);
      const start = Math.min(lastIndex, currentIndex);
      const end = Math.max(lastIndex, currentIndex);
      cards.forEach((c, i) => {
        const cardPath = c.getAttribute("data-path");
        if (i >= start && i <= end && cardPath) {
          this.selectedNotes.add(cardPath);
          c.addClass("selected");
        }
      });
    } else {
      this.clearSelection();
      this.selectedNotes.add(path);
      card.addClass("selected");
    }
    this.lastSelectedNote = path;
  }
  clearSelection() {
    this.selectedNotes.clear();
    this.container.querySelectorAll(".note-card.selected").forEach((card) => {
      card.removeClass("selected");
    });
  }
  getSelectedFiles() {
    return Array.from(this.selectedNotes).map((path) => this.app.vault.getAbstractFileByPath(path)).filter((file) => file instanceof import_obsidian.TFile);
  }
  showContextMenu(event, files) {
    const menu = new import_obsidian.Menu();
    if (files.length > 0) {
      menu.addItem((item) => {
        item.setTitle(`\u5728\u65B0\u6807\u7B7E\u9875\u6253\u5F00`).setIcon("link").onClick(async () => {
          for (const file of files) {
            const leaf = this.app.workspace.getLeaf("tab");
            await leaf.openFile(file);
          }
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u5728\u4EF6\u7BA1\u7406\u5668\u4E2D\u663E\u793A`).setIcon("folder").onClick(() => {
          var _a;
          const file = files[0];
          this.revealFolderInExplorer(((_a = file.parent) == null ? void 0 : _a.path) || "/");
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u79FB\u52A8 ${files.length} \u4E2A\u6587\u4EF6`).setIcon("move").onClick(() => {
          const modal = new EnhancedFileSelectionModal(this.app, files, this.recentFolders, (folders) => {
            this.recentFolders = folders;
          });
          modal.open();
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u5220\u9664 ${files.length} \u4E2A\u6587\u4EF6`).setIcon("trash").onClick(async () => {
          const confirm = await new ConfirmModal(this.app, "\u786E\u8BA4\u5220\u9664", `\u662F\u5426\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ${files.length} \u4E2A\u6587\u4EF6\uFF1F`).show();
          if (confirm) {
            for (const file of files) {
              await this.app.vault.trash(file, true);
            }
            this.refreshView();
          }
        });
      });
    }
    menu.showAtMouseEvent(event);
  }
  adjustCardSize(delta) {
    const adjustment = delta > 0 ? -10 : 10;
    const newSize = Math.max(this.plugin.settings.minCardWidth, Math.min(this.plugin.settings.maxCardWidth, this.cardSize + adjustment));
    if (newSize !== this.cardSize) {
      this.cardSize = newSize;
      this.updateCardSize(newSize);
      this.plugin.saveCardWidth(newSize);
    }
  }
  updateCardSize(width) {
    this.cardSize = width;
    this.container.querySelectorAll(".note-card").forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${width}px`;
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${width}px)`;
  }
  createCalendarButton(leftTools) {
    const calendarBtn = leftTools.createEl("button", {
      cls: "calendar-toggle-button"
    });
    calendarBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            <span>\u65E5\u5386</span>
        `;
    calendarBtn.addEventListener("click", () => {
      this.toggleCalendar();
      calendarBtn.toggleClass("active", this.isCalendarVisible);
    });
  }
  toggleCalendar() {
    this.isCalendarVisible = !this.isCalendarVisible;
    if (this.isCalendarVisible) {
      this.showCalendar();
      this.filterNotesByMonth(this.currentDate);
    } else {
      this.hideCalendar();
      this.clearDateFilter();
    }
  }
  filterNotesByMonth(date) {
    const year = date.getFullYear();
    const month = date.getMonth();
    this.currentFilter = {
      type: "date",
      value: `${year}-${(month + 1).toString().padStart(2, "0")}`
    };
    this.refreshView();
  }
  showCalendar() {
    var _a;
    if (!this.calendarContainer) {
      const contentSection = this.containerEl.querySelector(".content-section");
      if (!contentSection)
        return;
      this.calendarContainer = createDiv("calendar-container");
      (_a = contentSection.parentElement) == null ? void 0 : _a.insertBefore(this.calendarContainer, contentSection);
    }
    this.calendarContainer.empty();
    this.renderCalendar();
    this.calendarContainer.style.display = "block";
    const mainLayout = this.containerEl.querySelector(".main-layout");
    if (mainLayout) {
      mainLayout.addClass("with-calendar");
    }
  }
  hideCalendar() {
    if (this.calendarContainer) {
      this.calendarContainer.style.display = "none";
      this.calendarContainer.empty();
      const mainLayout = this.containerEl.querySelector(".main-layout");
      if (mainLayout) {
        mainLayout.removeClass("with-calendar");
      }
    }
  }
  renderCalendar() {
    if (!this.calendarContainer) {
      return;
    }
    this.calendarContainer.empty();
    const year = this.currentDate.getFullYear();
    const month = this.currentDate.getMonth();
    const header = this.calendarContainer.createDiv("calendar-header");
    const prevBtn = header.createEl("button", { cls: "calendar-nav-btn" });
    prevBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>';
    prevBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      this.currentDate = new Date(year, month - 1, 1);
      this.renderCalendar();
      this.filterNotesByMonth(this.currentDate);
    });
    header.createDiv("calendar-title").setText(`${year}\u5E74${month + 1}\u6708`);
    const nextBtn = header.createEl("button", { cls: "calendar-nav-btn" });
    nextBtn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>';
    nextBtn.addEventListener("click", (e) => {
      e.stopPropagation();
      this.currentDate = new Date(year, month + 1, 1);
      this.renderCalendar();
      this.filterNotesByMonth(this.currentDate);
    });
    const weekdays = ["\u65E5", "\u4E00", "\u4E8C", "\u4E09", "\u56DB", "\u4E94", "\u516D"];
    const weekHeader = this.calendarContainer.createDiv("calendar-weekdays");
    weekdays.forEach((day) => {
      weekHeader.createDiv("weekday").setText(day);
    });
    const grid = this.calendarContainer.createDiv("calendar-grid");
    const firstDay = new Date(year, month, 1).getDay();
    const daysInMonth = new Date(year, month + 1, 0).getDate();
    const notesCount = this.getNotesCountByDate(year, month);
    for (let i = 0; i < firstDay; i++) {
      grid.createDiv("calendar-day empty");
    }
    for (let day = 1; day <= daysInMonth; day++) {
      const dayEl = grid.createDiv("calendar-day");
      const dateStr = `${year}-${(month + 1).toString().padStart(2, "0")}-${day.toString().padStart(2, "0")}`;
      dayEl.setText(day.toString());
      dayEl.setAttribute("data-date", dateStr);
      if (this.currentFilter.type === "date" && this.currentFilter.value === dateStr) {
        dayEl.addClass("selected");
      }
      const count = notesCount[dateStr] || 0;
      if (count > 0) {
        dayEl.createDiv("note-count").setText(count.toString());
      }
      dayEl.addEventListener("click", () => {
        this.filterNotesByDate(dateStr);
      });
    }
  }
  getNotesCountByDate(year, month) {
    const counts = {};
    const files = this.app.vault.getMarkdownFiles();
    files.forEach((file) => {
      const date = new Date(file.stat.mtime);
      if (date.getFullYear() === year && date.getMonth() === month) {
        const dateStr = date.toISOString().split("T")[0];
        counts[dateStr] = (counts[dateStr] || 0) + 1;
      }
    });
    return counts;
  }
  filterNotesByDate(dateStr) {
    if (this.currentFilter.type === "date" && this.currentFilter.value === dateStr) {
      this.clearDateFilter();
      return;
    }
    this.calendarContainer.querySelectorAll(".calendar-day").forEach((day) => {
      day.removeClass("selected");
    });
    this.currentFilter = { type: "date", value: dateStr };
    const selectedDay = this.calendarContainer.querySelector(`.calendar-day[data-date="${dateStr}"]`);
    if (selectedDay) {
      selectedDay.addClass("selected");
    }
    this.refreshView();
  }
  clearDateFilter() {
    this.currentFilter = { type: "none" };
    if (this.calendarContainer) {
      this.calendarContainer.querySelectorAll(".calendar-day").forEach((day) => {
        day.removeClass("selected");
      });
    }
    this.refreshView();
  }
  highlightSearchTerm(content, searchTerm) {
    if (!searchTerm)
      return content;
    const regex = new RegExp(searchTerm, "gi");
    return content.replace(regex, (match) => `<span class="search-highlight">${match}</span>`);
  }
  async openInAppropriateLeaf(file) {
    const leaves = this.app.workspace.getLeavesOfType("markdown");
    const currentRoot = this.leaf.getRoot();
    const otherLeaf = leaves.find((leaf) => {
      const root = leaf.getRoot();
      return root !== currentRoot;
    });
    if (otherLeaf) {
      await otherLeaf.openFile(file);
      this.app.workspace.setActiveLeaf(otherLeaf);
    } else {
      const leaf = this.app.workspace.getLeaf("tab");
      await leaf.openFile(file);
    }
  }
  renderFolderCard(folder) {
    const cardEl = createDiv("card folder-card");
    cardEl.addEventListener("click", () => {
      const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
      if (fileExplorer) {
        this.app.workspace.revealLeaf(fileExplorer);
        const fileExplorerView = fileExplorer.view;
        if (fileExplorerView && fileExplorerView.revealInFolder) {
          fileExplorerView.revealInFolder(folder);
        }
      }
    });
    return cardEl;
  }
};
var ConfirmModal = class extends import_obsidian.Modal {
  constructor(app, title, message) {
    super(app);
    this.result = false;
    this.title = title;
    this.message = message;
  }
  async show() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: this.title });
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv("button-container");
    const confirmButton = buttonContainer.createEl("button", { text: "\u786E\u8BA4" });
    confirmButton.addEventListener("click", () => {
      this.result = true;
      this.close();
    });
    const cancelButton = buttonContainer.createEl("button", { text: "\u53D6\u6D88" });
    cancelButton.addEventListener("click", () => {
      this.result = false;
      this.close();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.resolvePromise(this.result);
  }
};
var EnhancedFileSelectionModal = class extends import_obsidian.Modal {
  constructor(app, files, recentFolders, onFoldersUpdate) {
    super(app);
    this.selectedFolder = null;
    this.files = files;
    this.recentFolders = recentFolders;
    this.onFoldersUpdate = onFoldersUpdate;
  }
  async onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", {
      text: `\u79FB\u52A8 ${this.files.length} \u4E2A\u6587\u4EF6`
    });
    if (this.recentFolders.length > 0) {
      const recentSection = contentEl.createDiv("recent-folders-section");
      recentSection.createEl("h4", { text: "\u6700\u4F7F\u7528" });
      const recentList = recentSection.createDiv("recent-folders-list");
      this.recentFolders.forEach((folder) => {
        const item = recentList.createDiv("folder-item recent");
        item.setText(folder);
        item.addEventListener("click", () => this.selectFolder(item, folder));
      });
    }
    const folderList = contentEl.createDiv("folder-list");
    const folders = this.getFoldersWithHierarchy();
    this.createFolderTree(folderList, folders);
    const buttonContainer = contentEl.createDiv("modal-button-container");
    const confirmButton = buttonContainer.createEl("button", {
      text: "\u786E\u8BA4\u79FB\u52A8",
      cls: "mod-cta"
    });
    confirmButton.addEventListener("click", () => {
      if (this.selectedFolder) {
        this.moveFiles(this.selectedFolder);
      }
    });
    const cancelButton = buttonContainer.createEl("button", {
      text: "\u53D6\u6D88"
    });
    cancelButton.addEventListener("click", () => this.close());
  }
  getFoldersWithHierarchy() {
    const folders = [];
    const seen = new Set();
    this.app.vault.getAllLoadedFiles().forEach((file) => {
      if (file instanceof import_obsidian.TFolder) {
        const parts = file.path.split("/");
        let currentPath = "";
        let level = 0;
        parts.forEach((part) => {
          if (part) {
            currentPath += (currentPath ? "/" : "") + part;
            if (!seen.has(currentPath)) {
              seen.add(currentPath);
              folders.push({
                path: currentPath,
                name: part,
                level
              });
            }
            level++;
          }
        });
      }
    });
    return folders.sort((a, b) => a.path.localeCompare(b.path));
  }
  createFolderTree(container, folders) {
    folders.forEach((folder) => {
      const item = container.createDiv({
        cls: "folder-item"
      });
      item.style.paddingLeft = `${folder.level * 20 + 10}px`;
      const icon = item.createSpan({
        cls: "folder-icon"
      });
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>`;
      const name = item.createSpan({
        cls: "folder-name",
        text: folder.name
      });
      item.addEventListener("click", () => this.selectFolder(item, folder.path));
    });
  }
  selectFolder(element, path) {
    this.contentEl.querySelectorAll(".folder-item").forEach((item) => {
      item.removeClass("selected");
    });
    element.addClass("selected");
    this.selectedFolder = path;
  }
  async moveFiles(targetFolder) {
    const confirmModal = new ConfirmModal(this.app, "\u786E\u8BA4\u79FB\u52A8", `\u662F\u5426\u5C06\u9009\u4E2D\u7684 ${this.files.length} \u4E2A\u6587\u4EF6\u79FB\u52A8\u5230 "${targetFolder}"\uFF1F`);
    if (await confirmModal.show()) {
      for (const file of this.files) {
        const newPath = `${targetFolder}/${file.name}`;
        await this.app.fileManager.renameFile(file, newPath);
      }
      this.recentFolders = [targetFolder, ...this.recentFolders.filter((f) => f !== targetFolder)].slice(0, 5);
      this.onFoldersUpdate(this.recentFolders);
      this.close();
    }
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  defaultView: "card",
  cardWidth: 280,
  minCardWidth: 280,
  maxCardWidth: 600
};
var CardViewSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("\u9ED8\u8BA4\u89C6\u56FE").setDesc("\u9009\u62E9\u9ED8\u8BA4\u7684\u89C6\u56FE\u6A21\u5F0F").addDropdown((dropdown) => {
      dropdown.addOption("card", "\u5361\u7247 \u89C6\u56FE").addOption("list", "\u5217\u8868\u89C6\u56FE").addOption("timeline", "\u65F6\u95F4\u8F74\u89C6\u56FE").setValue(this.plugin.settings.defaultView);
      dropdown.onChange(async (value) => {
        if (value === "card" || value === "list" || value === "timeline") {
          this.plugin.settings.defaultView = value;
          await this.plugin.saveSettings();
        }
      });
    });
    new import_obsidian2.Setting(containerEl).setName("\u5361\u7247\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u5BBD\u5EA6\uFF08280-600\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("280").setValue(this.plugin.settings.cardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width >= 280 && width <= 600) {
        this.plugin.settings.cardWidth = width;
        await this.plugin.saveSettings();
        this.plugin.updateAllCardViews();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5C0F\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u6700\u5C0F\u5BBD\u5EA6\uFF08\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("280").setValue(this.plugin.settings.minCardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width >= 200) {
        this.plugin.settings.minCardWidth = width;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u6700\u5927\u5BBD\u5EA6\uFF08\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("600").setValue(this.plugin.settings.maxCardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width <= 800) {
        this.plugin.settings.maxCardWidth = width;
        await this.plugin.saveSettings();
      }
    }));
  }
};
var CardViewPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    await this.loadSettings();
    this.registerView(VIEW_TYPE_CARD, (leaf) => new CardView(leaf, this));
    this.addRibbonIcon("layout-grid", "\u5361\u7247\u89C6\u56FE", () => {
      this.activateView();
    });
    this.addSettingTab(new CardViewSettingTab(this.app, this));
    this.app.workspace.on("file-open", (file) => {
      if (file) {
        this.handleFileOpen(file);
      }
    });
  }
  handleFileOpen(file) {
    console.log(`\u6587\u4EF6 ${file.path} \u88AB\u6253\u5F00`);
  }
  handleFolderOpen(folder) {
    console.log(`\u6587\u4EF6\u5939 ${folder} \u88AB\u6253\u5F00`);
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_CARD)[0];
    if (!leaf) {
      leaf = workspace.getLeaf("tab");
      await leaf.setViewState({
        type: VIEW_TYPE_CARD,
        active: true
      });
    }
    workspace.revealLeaf(leaf);
  }
  updateAllCardViews() {
    this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD).forEach((leaf) => {
      const view = leaf.view;
      if (view) {
        view.updateCardSize(this.settings.cardWidth);
      }
    });
  }
  async saveCardWidth(width) {
    this.settings.cardWidth = width;
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJjYXJkVmlldy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBURm9sZGVyLFdvcmtzcGFjZUxlYWYgfSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCB7IENhcmRWaWV3LCBWSUVXX1RZUEVfQ0FSRCB9IGZyb20gJy4vY2FyZFZpZXcnO1xyXG5cclxuaW50ZXJmYWNlIENhcmRWaWV3UGx1Z2luU2V0dGluZ3Mge1xyXG4gICAgZGVmYXVsdFZpZXc6ICdjYXJkJyB8ICdsaXN0JyB8ICd0aW1lbGluZSc7XHJcbiAgICBjYXJkV2lkdGg6IG51bWJlcjtcclxuICAgIG1pbkNhcmRXaWR0aDogbnVtYmVyO1xyXG4gICAgbWF4Q2FyZFdpZHRoOiBudW1iZXI7XHJcbn1cclxuXHJcbmNvbnN0IERFRkFVTFRfU0VUVElOR1M6IENhcmRWaWV3UGx1Z2luU2V0dGluZ3MgPSB7XHJcbiAgICBkZWZhdWx0VmlldzogJ2NhcmQnLFxyXG4gICAgY2FyZFdpZHRoOiAyODAsXHJcbiAgICBtaW5DYXJkV2lkdGg6IDI4MCxcclxuICAgIG1heENhcmRXaWR0aDogNjAwXHJcbn1cclxuXHJcbmNsYXNzIENhcmRWaWV3U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xyXG4gICAgcGx1Z2luOiBDYXJkVmlld1BsdWdpbjtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBDYXJkVmlld1BsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgIH1cclxuXHJcbiAgICBkaXNwbGF5KCk6IHZvaWQge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTlFRDhcdThCQTRcdTg5QzZcdTU2RkUnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU5MDA5XHU2MkU5XHU5RUQ4XHU4QkE0XHU3Njg0XHU4OUM2XHU1NkZFXHU2QTIxXHU1RjBGJylcclxuICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IHtcclxuICAgICAgICAgICAgICAgIGRyb3Bkb3duXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbignY2FyZCcsICdcdTUzNjFcdTcyNDcgXHU4OUM2XHU1NkZFJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdsaXN0JywgJ1x1NTIxN1x1ODg2OFx1ODlDNlx1NTZGRScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbigndGltZWxpbmUnLCAnXHU2NUY2XHU5NUY0XHU4Rjc0XHU4OUM2XHU1NkZFJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFZpZXcpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICdjYXJkJyB8fCB2YWx1ZSA9PT0gJ2xpc3QnIHx8IHZhbHVlID09PSAndGltZWxpbmUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRWaWV3ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTUzNjFcdTcyNDdcdTVCQkRcdTVFQTYnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU4QkJFXHU3RjZFXHU1MzYxXHU3MjQ3XHU3Njg0XHU1QkJEXHU1RUE2XHVGRjA4MjgwLTYwMFx1NTBDRlx1N0QyMFx1RkYwOScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcyODAnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRXaWR0aC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSAmJiB3aWR0aCA+PSAyODAgJiYgd2lkdGggPD0gNjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRXaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQWxsQ2FyZFZpZXdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NjcwMFx1NUMwRlx1NUJCRFx1NUVBNicpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdThCQkVcdTdGNkVcdTUzNjFcdTcyNDdcdTc2ODRcdTY3MDBcdTVDMEZcdTVCQkRcdTVFQTZcdUZGMDhcdTUwQ0ZcdTdEMjBcdUZGMDknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMjgwJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5taW5DYXJkV2lkdGgudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB3aWR0aCA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTih3aWR0aCkgJiYgd2lkdGggPj0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1pbkNhcmRXaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU2NzAwXHU1OTI3XHU1QkJEXHU1RUE2JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1x1OEJCRVx1N0Y2RVx1NTM2MVx1NzI0N1x1NzY4NFx1NjcwMFx1NTkyN1x1NUJCRFx1NUVBNlx1RkYwOFx1NTBDRlx1N0QyMFx1RkYwOScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCc2MDAnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heENhcmRXaWR0aC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSAmJiB3aWR0aCA8PSA4MDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4Q2FyZFdpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZFZpZXdQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG4gICAgc2V0dGluZ3M6IENhcmRWaWV3UGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3KFxyXG4gICAgICAgICAgICBWSUVXX1RZUEVfQ0FSRCxcclxuICAgICAgICAgICAgKGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IG5ldyBDYXJkVmlldyhsZWFmLCB0aGlzKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkUmliYm9uSWNvbignbGF5b3V0LWdyaWQnLCAnXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlVmlldygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IENhcmRWaWV3U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xyXG5cclxuICAgICAgICAvLyBcdTc2RDFcdTU0MkNcdTY1ODdcdTRFRjZcdTUyMTdcdTg4NjhcdTc2ODRcdTcwQjlcdTUxRkJcdTRFOEJcdTRFRjZcclxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uub24oXCJmaWxlLW9wZW5cIiwgKGZpbGU6IFRGaWxlIHwgbnVsbCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZmlsZSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5oYW5kbGVGaWxlT3BlbihmaWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBoYW5kbGVGaWxlT3BlbihmaWxlOiBURmlsZSkge1xyXG4gICAgICAgIC8vIFx1NTkwNFx1NzQwNlx1NjU4N1x1NEVGNlx1NjI1M1x1NUYwMFx1NEU4Qlx1NEVGNlxyXG4gICAgICAgIGNvbnNvbGUubG9nKGBcdTY1ODdcdTRFRjYgJHtmaWxlLnBhdGh9IFx1ODhBQlx1NjI1M1x1NUYwMGApO1xyXG4gICAgICAgIC8vIFx1NTcyOFx1OEZEOVx1OTFDQ1x1NTNFRlx1NEVFNVx1NkRGQlx1NTJBMFx1NjBBOFx1NjBGM1x1ODk4MVx1NzY4NFx1OTAzQlx1OEY5MVx1RkYwQ1x1NEY4Qlx1NTk4Mlx1NjZGNFx1NjVCMFx1ODlDNlx1NTZGRVx1NjIxNlx1NjYzRVx1NzkzQVx1NzZGOFx1NTE3M1x1NEZFMVx1NjA2RlxyXG4gICAgfVxyXG5cclxuICAgIGhhbmRsZUZvbGRlck9wZW4oZm9sZGVyOiBzdHJpbmcpIHsgLy8gXHU2NUIwXHU1ODlFXHU1OTA0XHU3NDA2XHU2NTg3XHU0RUY2XHU1OTM5XHU2MjUzXHU1RjAwXHU3Njg0XHU1MUZEXHU2NTcwXHJcbiAgICAgICAgY29uc29sZS5sb2coYFx1NjU4N1x1NEVGNlx1NTkzOSAke2ZvbGRlcn0gXHU4OEFCXHU2MjUzXHU1RjAwYCk7XHJcbiAgICAgICAgLy8gXHU1NzI4XHU4RkQ5XHU5MUNDXHU1M0VGXHU0RUU1XHU2REZCXHU1MkEwXHU2MEE4XHU2MEYzXHU4OTgxXHU3Njg0XHU5MDNCXHU4RjkxXHVGRjBDXHU0RjhCXHU1OTgyXHU2NkY0XHU2NUIwXHU4OUM2XHU1NkZFXHU2MjE2XHU2NjNFXHU3OTNBXHU3NkY4XHU1MTczXHU0RkUxXHU2MDZGXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGFjdGl2YXRlVmlldygpIHtcclxuICAgICAgICBjb25zdCB7IHdvcmtzcGFjZSB9ID0gdGhpcy5hcHA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IGxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKFZJRVdfVFlQRV9DQVJEKVswXTtcclxuICAgICAgICBpZiAoIWxlYWYpIHtcclxuICAgICAgICAgICAgbGVhZiA9IHdvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgYXdhaXQgbGVhZi5zZXRWaWV3U3RhdGUoe1xyXG4gICAgICAgICAgICAgICAgdHlwZTogVklFV19UWVBFX0NBUkQsXHJcbiAgICAgICAgICAgICAgICBhY3RpdmU6IHRydWUsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB3b3Jrc3BhY2UucmV2ZWFsTGVhZihsZWFmKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVBbGxDYXJkVmlld3MoKSB7XHJcbiAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfQ0FSRCkuZm9yRWFjaChsZWFmID0+IHtcclxuICAgICAgICAgICAgY29uc3QgdmlldyA9IGxlYWYudmlldyBhcyBDYXJkVmlldztcclxuICAgICAgICAgICAgaWYgKHZpZXcpIHtcclxuICAgICAgICAgICAgICAgIHZpZXcudXBkYXRlQ2FyZFNpemUodGhpcy5zZXR0aW5ncy5jYXJkV2lkdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2F2ZUNhcmRXaWR0aCh3aWR0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5zZXR0aW5ncy5jYXJkV2lkdGggPSB3aWR0aDtcclxuICAgICAgICBhd2FpdCB0aGlzLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgfVxyXG59ICIsICJpbXBvcnQge1xyXG4gICAgSXRlbVZpZXcsXHJcbiAgICBXb3Jrc3BhY2VMZWFmLFxyXG4gICAgVEZpbGUsXHJcbiAgICBNYXJrZG93blJlbmRlcmVyLFxyXG4gICAgTWVudSxcclxuICAgIE1vZGFsLFxyXG4gICAgVEZvbGRlcixcclxuICAgIEFwcCxcclxuICAgIE5vdGljZVxyXG59IGZyb20gJ29ic2lkaWFuJztcclxuaW1wb3J0IENhcmRWaWV3UGx1Z2luIGZyb20gJy4vbWFpbic7XHJcblxyXG5leHBvcnQgY29uc3QgVklFV19UWVBFX0NBUkQgPSAnY2FyZC12aWV3JztcclxuXHJcbmV4cG9ydCBjbGFzcyBDYXJkVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcclxuICAgIHByaXZhdGUgcGx1Z2luOiBDYXJkVmlld1BsdWdpbjtcclxuICAgIHByaXZhdGUgY3VycmVudFZpZXc6ICdjYXJkJyB8ICdsaXN0JyB8ICd0aW1lbGluZSc7XHJcbiAgICBwcml2YXRlIGNvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHRhZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIGNvbnRlbnRDb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBwcmV2aWV3Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgcHJldmlld1Jlc2l6ZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBpc1ByZXZpZXdDb2xsYXBzZWQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgY3VycmVudEZvbGRlcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIHNlYXJjaElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50U2VhcmNoVGVybTogc3RyaW5nID0gJyc7XHJcbiAgICBwcml2YXRlIHNlbGVjdGVkVGFnczogU2V0PHN0cmluZz4gPSBuZXcgU2V0KCk7XHJcbiAgICBwcml2YXRlIHNlbGVjdGVkTm90ZXM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG4gICAgcHJpdmF0ZSBsYXN0U2VsZWN0ZWROb3RlOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgcmVjZW50Rm9sZGVyczogc3RyaW5nW10gPSBbXTtcclxuICAgIHByaXZhdGUgY2FyZFNpemU6IG51bWJlciA9IDI4MDsgIC8vIFx1OUVEOFx1OEJBNFx1NTM2MVx1NzI0N1x1NUJCRFx1NUVBNlxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBNSU5fQ0FSRF9TSVpFID0gMjgwOyAgLy8gXHU2NzAwXHU1QzBGXHU1MzYxXHU3MjQ3XHU1QkJEXHU1RUE2XHJcbiAgICBwcml2YXRlIHJlYWRvbmx5IE1BWF9DQVJEX1NJWkUgPSA2MDA7ICAvLyBcdTY3MDBcdTU5MjdcdTUzNjFcdTcyNDdcdTVCQkRcdTVFQTZcclxuICAgIHByaXZhdGUgY2FsZW5kYXJDb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBpc0NhbGVuZGFyVmlzaWJsZTogYm9vbGVhbiA9IGZhbHNlO1xyXG4gICAgcHJpdmF0ZSBjdXJyZW50RGF0ZTogRGF0ZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRGaWx0ZXI6IHsgdHlwZTogJ2RhdGUnIHwgJ25vbmUnLCB2YWx1ZT86IHN0cmluZyB9ID0geyB0eXBlOiAnbm9uZScgfTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1Njc4NFx1OTAyMFx1NTFGRFx1NjU3MFxyXG4gICAgICogQHBhcmFtIGxlYWYgLSBcdTVERTVcdTRGNUNcdTUzM0FcdTUzRjZcdTVCNTBcdTgyODJcdTcwQjlcclxuICAgICAqIEBwYXJhbSBwbHVnaW4gLSBcdTYzRDJcdTRFRjZcdTVCOUVcdTRGOEJcclxuICAgICAqL1xyXG4gICAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgcGx1Z2luOiBDYXJkVmlld1BsdWdpbikge1xyXG4gICAgICAgIHN1cGVyKGxlYWYpO1xyXG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xyXG4gICAgICAgIHRoaXMuY3VycmVudFZpZXcgPSBwbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFZpZXc7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTgzQjdcdTUzRDZcdTg5QzZcdTU2RkVcdTdDN0JcdTU3OEJcclxuICAgICAqIEByZXR1cm5zIFx1ODlDNlx1NTZGRVx1N0M3Qlx1NTc4Qlx1NjgwN1x1OEJDNlx1N0IyNlxyXG4gICAgICovXHJcbiAgICBnZXRWaWV3VHlwZSgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiBWSUVXX1RZUEVfQ0FSRDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODNCN1x1NTNENlx1ODlDNlx1NTZGRVx1NjYzRVx1NzkzQVx1NjU4N1x1NjcyQ1xyXG4gICAgICogQHJldHVybnMgXHU2NjNFXHU3OTNBXHU1NzI4XHU2ODA3XHU3QjdFXHU5ODc1XHU0RTBBXHU3Njg0XHU2NTg3XHU2NzJDXHJcbiAgICAgKi9cclxuICAgIGdldERpc3BsYXlUZXh0KCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuICdcdTUzNjFcdTcyNDdcdTg5QzZcdTU2RkUnO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU4OUM2XHU1NkZFXHU2MjUzXHU1RjAwXHU2NUY2XHU3Njg0XHU1MjFEXHU1OUNCXHU1MzE2XHU1MUZEXHU2NTcwXHJcbiAgICAgKiBcdTUyMUJcdTVFRkFcdTY4MDdcdTdCN0VcdThGQzdcdTZFRTRcdTU2NjhcdTMwMDFcdTg5QzZcdTU2RkVcdTUyMDdcdTYzNjJcdTYzMDlcdTk0QUVcdTU0OENcdTVCQjlcdTU2NjhcclxuICAgICAqL1xyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcclxuICAgICAgICBjb250YWluZXJFbC5hZGRDbGFzcygnY2FyZC12aWV3LWNvbnRhaW5lcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NEUzQlx1NUUwM1x1NUM0MFx1NUJCOVx1NTY2OFxyXG4gICAgICAgIGNvbnN0IG1haW5MYXlvdXQgPSBjb250YWluZXJFbC5jcmVhdGVEaXYoJ21haW4tbGF5b3V0Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1REU2XHU0RkE3XHU1MTg1XHU1QkI5XHU1MzNBXHU1N0RGXHJcbiAgICAgICAgY29uc3QgY29udGVudFNlY3Rpb24gPSBtYWluTGF5b3V0LmNyZWF0ZURpdignY29udGVudC1zZWN0aW9uJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1REU1XHU1MTc3XHU2ODBGXHJcbiAgICAgICAgY29uc3QgdG9vbGJhciA9IGNvbnRlbnRTZWN0aW9uLmNyZWF0ZURpdignY2FyZC12aWV3LXRvb2xiYXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTVERTZcdTRGQTdcdTVERTVcdTUxNzdcdTdFQzRcclxuICAgICAgICBjb25zdCBsZWZ0VG9vbHMgPSB0b29sYmFyLmNyZWF0ZURpdigndG9vbGJhci1sZWZ0Jyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU2NUIwXHU1RUZBXHU3QjE0XHU4QkIwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgY29uc3QgbmV3Tm90ZUJ0biA9IGxlZnRUb29scy5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgICAgICBjbHM6ICduZXctbm90ZS1idXR0b24nLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIG5ld05vdGVCdG4uaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCIgY2xhc3M9XCJsdWNpZGUgbHVjaWRlLXBsdXNcIj48bGluZSB4MT1cIjEyXCIgeTE9XCI1XCIgeDI9XCIxMlwiIHkyPVwiMTlcIj48L2xpbmU+PGxpbmUgeDE9XCI1XCIgeTE9XCIxMlwiIHgyPVwiMTlcIiB5Mj1cIjEyXCI+PC9saW5lPjwvc3ZnPlxyXG4gICAgICAgICAgICA8c3Bhbj5cdTY1QjBcdTVFRkFcdTdCMTRcdThCQjA8L3NwYW4+XHJcbiAgICAgICAgYDtcclxuICAgICAgICBuZXdOb3RlQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5jcmVhdGVOZXdOb3RlKCkpO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTY1RTVcdTUzODZcdTYzMDlcdTk0QUUgLSBcdTU3MjhcdTg5QzZcdTU2RkVcdTUyMDdcdTYzNjJcdTYzMDlcdTk0QUVcdTRFNEJcdTUyNERcdTZERkJcdTUyQTBcclxuICAgICAgICB0aGlzLmNyZWF0ZUNhbGVuZGFyQnV0dG9uKGxlZnRUb29scyk7XHJcblxyXG4gICAgICAgIC8vIFx1ODlDNlx1NTZGRVx1NTIwN1x1NjM2Mlx1NjMwOVx1OTRBRVx1N0VDNFxyXG4gICAgICAgIGNvbnN0IHZpZXdTd2l0Y2hlciA9IGxlZnRUb29scy5jcmVhdGVEaXYoJ3ZpZXctc3dpdGNoZXInKTtcclxuICAgICAgICB0aGlzLmNyZWF0ZVZpZXdTd2l0Y2hlcih2aWV3U3dpdGNoZXIpO1xyXG5cclxuICAgICAgICAvLyBcdTUzRjNcdTRGQTdcdTY0MUNcdTdEMjJcdTY4NDZcclxuICAgICAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSB0b29sYmFyLmNyZWF0ZURpdignc2VhcmNoLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQgPSBzZWFyY2hDb250YWluZXIuY3JlYXRlRWwoJ2lucHV0Jywge1xyXG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnXHU2NDFDXHU3RDIyXHU3QjE0XHU4QkIwLi4uJyxcclxuICAgICAgICAgICAgY2xzOiAnc2VhcmNoLWlucHV0J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlYXJjaFRlcm0gPSB0aGlzLnNlYXJjaElucHV0LnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NjgwN1x1N0I3RVx1NjgwRlxyXG4gICAgICAgIHRoaXMudGFnQ29udGFpbmVyID0gY29udGVudFNlY3Rpb24uY3JlYXRlRGl2KCd0YWctZmlsdGVyJyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkVGFncygpO1xyXG5cclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTRFM0JcdTUxODVcdTVCQjlcdTUzM0FcdTU3REZcclxuICAgICAgICBjb25zdCBjb250ZW50QXJlYSA9IGNvbnRlbnRTZWN0aW9uLmNyZWF0ZURpdignY2FyZC12aWV3LWNvbnRlbnQnKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRlbnRBcmVhLmNyZWF0ZURpdignY2FyZC1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTRGN0ZcdTc1MjhcdTRGRERcdTVCNThcdTc2ODRcdTVCQkRcdTVFQTZcdTUyMURcdTU5Q0JcdTUzMTZcdTUzNjFcdTcyNDdcdTVCQjlcdTU2NjhcclxuICAgICAgICB0aGlzLmNhcmRTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2FyZFdpZHRoO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KGF1dG8tZmlsbCwgJHt0aGlzLmNhcmRTaXplfXB4KWA7XHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1OTg4NFx1ODlDOFx1NTMzQVx1NTdERlxyXG4gICAgICAgIGNvbnN0IHByZXZpZXdXcmFwcGVyID0gbWFpbkxheW91dC5jcmVhdGVEaXYoJ3ByZXZpZXctd3JhcHBlcicpO1xyXG4gICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lciA9IHByZXZpZXdXcmFwcGVyLmNyZWF0ZURpdigncHJldmlldy1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTk4ODRcdTg5QzhcdTYzQTdcdTUyMzZcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBwcmV2aWV3Q29udHJvbHMgPSBwcmV2aWV3V3JhcHBlci5jcmVhdGVEaXYoJ3ByZXZpZXctY29udHJvbHMnKTtcclxuICAgICAgICBjb25zdCB0b2dnbGVCdXR0b24gPSBwcmV2aWV3Q29udHJvbHMuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgY2xzOiAncHJldmlldy10b2dnbGUnLFxyXG4gICAgICAgICAgICBhdHRyOiB7ICdhcmlhLWxhYmVsJzogJ1x1NjI5OFx1NTNFMFx1OTg4NFx1ODlDOCcgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRvZ2dsZUJ1dHRvbi5pbm5lckhUTUwgPSBgPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIyNFwiIGhlaWdodD1cIjI0XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiIGNsYXNzPVwiZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tcmlnaHRcIj48cG9seWxpbmUgcG9pbnRzPVwiOSAxOCAxNSAxMiA5IDZcIj48L3BvbHlsaW5lPjwvc3ZnPmA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdG9nZ2xlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy50b2dnbGVQcmV2aWV3KCkpO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdThDMDNcdTY1NzRcdTU5MjdcdTVDMEZcdTc2ODRcdTUyOUZcdTgwRkRcclxuICAgICAgICB0aGlzLnByZXZpZXdSZXNpemVyID0gcHJldmlld1dyYXBwZXIuY3JlYXRlRGl2KCdwcmV2aWV3LXJlc2l6ZXInKTtcclxuICAgICAgICB0aGlzLnNldHVwUmVzaXplcigpO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTUxNjhcdTVDNDBcdTZFREFcdThGNkVcdTRFOEJcdTRFRjZcdTc2RDFcdTU0MkNcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCd3aGVlbCcsIChlOiBXaGVlbEV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChlLmN0cmxLZXkpIHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuYWRqdXN0Q2FyZFNpemUoZS5kZWx0YVkpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSwgeyBwYXNzaXZlOiBmYWxzZSB9KTtcclxuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkTm90ZXMoKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTJBMFx1OEY3RFx1NjI0MFx1NjcwOVx1NjgwN1x1N0I3RVx1NUU3Nlx1NTIxQlx1NUVGQVx1NjgwN1x1N0I3RVx1OEZDN1x1NkVFNFx1NTY2OFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFzeW5jIGxvYWRUYWdzKCkge1xyXG4gICAgICAgIGNvbnN0IHRhZ3MgPSB0aGlzLmdldEFsbFRhZ3MoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTZERkJcdTUyQTAgXCJBbGxcIiBcdTY4MDdcdTdCN0VcclxuICAgICAgICBjb25zdCBhbGxUYWdCdG4gPSB0aGlzLnRhZ0NvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBcclxuICAgICAgICAgICAgdGV4dDogJ0FsbCcsXHJcbiAgICAgICAgICAgIGNsczogJ3RhZy1idG4gYWN0aXZlJyAgLy8gXHU5RUQ4XHU4QkE0XHU5MDA5XHU0RTJEXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgYWxsVGFnQnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyVGFnU2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgIGFsbFRhZ0J0bi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU1MTc2XHU0RUQ2XHU2ODA3XHU3QjdFXHJcbiAgICAgICAgdGFncy5mb3JFYWNoKHRhZyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRhZ0J0biA9IHRoaXMudGFnQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IFxyXG4gICAgICAgICAgICAgICAgdGV4dDogdGFnLFxyXG4gICAgICAgICAgICAgICAgY2xzOiAndGFnLWJ0bidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHRhZ0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy50b2dnbGVUYWcodGFnLCB0YWdCdG4pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODNCN1x1NTNENlx1NjI0MFx1NjcwOVx1N0IxNFx1OEJCMFx1NEUyRFx1NzY4NFx1NjgwN1x1N0I3RVxyXG4gICAgICogQHJldHVybnMgXHU1M0JCXHU5MUNEXHU1NDBFXHU3Njg0XHU2ODA3XHU3QjdFXHU2NTcwXHU3RUM0XHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgZ2V0QWxsVGFncygpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgdGFncyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgICAgICBpZiAoY2FjaGU/LnRhZ3MpIHtcclxuICAgICAgICAgICAgICAgIGNhY2hlLnRhZ3MuZm9yRWFjaCh0YWcgPT4gdGFncy5hZGQodGFnLnRhZykpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGFncyk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTUyMUJcdTVFRkFcdTg5QzZcdTU2RkVcdTUyMDdcdTYzNjJcdTYzMDlcdTk0QUVcclxuICAgICAqIEBwYXJhbSBjb250YWluZXIgLSBcdTYzMDlcdTk0QUVcdTVCQjlcdTU2NjhcdTUxNDNcdTdEMjBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBjcmVhdGVWaWV3U3dpdGNoZXIoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGNvbnN0IHZpZXdzID0gW1xyXG4gICAgICAgICAgICB7IGlkOiAnY2FyZCcsIGljb246ICdncmlkJywgdGV4dDogJ1x1NTM2MVx1NzI0N1x1ODlDNlx1NTZGRScgfSxcclxuICAgICAgICAgICAgeyBpZDogJ2xpc3QnLCBpY29uOiAnbGlzdCcsIHRleHQ6ICdcdTUyMTdcdTg4NjhcdTg5QzZcdTU2RkUnIH0sXHJcbiAgICAgICAgICAgIHsgaWQ6ICd0aW1lbGluZScsIGljb246ICdjbG9jaycsIHRleHQ6ICdcdTY1RjZcdTk1RjRcdThGNzRcdTg5QzZcdTU2RkUnIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZpZXdzLmZvckVhY2godmlldyA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJ0biA9IGNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgICAgICAgICAgY2xzOiBgdmlldy1zd2l0Y2gtYnRuICR7dmlldy5pZCA9PT0gdGhpcy5jdXJyZW50VmlldyA/ICdhY3RpdmUnIDogJyd9YCxcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTc2RjRcdTYzQTUgU1ZHIFx1NTZGRVx1NjgwN1xyXG4gICAgICAgICAgICBjb25zdCBpY29uSHRtbCA9IHtcclxuICAgICAgICAgICAgICAgICdncmlkJzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cmVjdCB4PVwiM1wiIHk9XCIzXCIgd2lkdGg9XCI3XCIgaGVpZ2h0PVwiN1wiPjwvcmVjdD48cmVjdCB4PVwiMTRcIiB5PVwiM1wiIHdpZHRoPVwiN1wiIGhlaWdodD1cIjdcIj48L3JlY3Q+PHJlY3QgeD1cIjE0XCIgeT1cIjE0XCIgd2lkdGg9XCI3XCIgaGVpZ2h0PVwiN1wiPjwvcmVjdD48cmVjdCB4PVwiM1wiIHk9XCIxNFwiIHdpZHRoPVwiN1wiIGhlaWdodD1cIjdcIj48L3JlY3Q+PC9zdmc+JyxcclxuICAgICAgICAgICAgICAgICdsaXN0JzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48bGluZSB4MT1cIjhcIiB5MT1cIjZcIiB4Mj1cIjIxXCIgeTI9XCI2XCI+PC9saW5lPjxsaW5lIHgxPVwiOFwiIHkxPVwiMTJcIiB4Mj1cIjIxXCIgeTI9XCIxMlwiPjwvbGluZT48bGluZSB4MT1cIjhcIiB5MT1cIjE4XCIgeDI9XCIyMVwiIHkyPVwiMThcIj48L2xpbmU+PGxpbmUgeDE9XCIzXCIgeTE9XCI2XCIgeDI9XCIzLjAxXCIgeTI9XCI2XCI+PC9saW5lPjxsaW5lIHgxPVwiM1wiIHkxPVwiMTJcIiB4Mj1cIjMuMDFcIiB5Mj1cIjEyXCI+PC9saW5lPjxsaW5lIHgxPVwiM1wiIHkxPVwiMThcIiB4Mj1cIjMuMDFcIiB5Mj1cIjE4XCI+PC9saW5lPjwvc3ZnPicsXHJcbiAgICAgICAgICAgICAgICAnY2xvY2snOiAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxOFwiIGhlaWdodD1cIjE4XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxjaXJjbGUgY3g9XCIxMlwiIGN5PVwiMTJcIiByPVwiMTBcIj48L2NpcmNsZT48cG9seWxpbmUgcG9pbnRzPVwiMTIgNiAxMiAxMiAxNiAxNFwiPjwvcG9seWxpbmU+PC9zdmc+J1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1NkZFXHJcbiAgICAgICAgICAgIGNvbnN0IGljb25TcGFuID0gYnRuLmNyZWF0ZVNwYW4oeyBjbHM6ICd2aWV3LXN3aXRjaC1pY29uJyB9KTtcclxuICAgICAgICAgICAgaWNvblNwYW4uaW5uZXJIVE1MID0gaWNvbkh0bWxbdmlldy5pY29uXTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NjU4N1x1NUI1N1xyXG4gICAgICAgICAgICBidG4uY3JlYXRlU3Bhbih7IHRleHQ6IHZpZXcudGV4dCwgY2xzOiAndmlldy1zd2l0Y2gtdGV4dCcgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBidG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnZpZXctc3dpdGNoLWJ0bicpLmZvckVhY2goYiA9PiBiLnJlbW92ZUNsYXNzKCdhY3RpdmUnKSk7XHJcbiAgICAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zd2l0Y2hWaWV3KHZpZXcuaWQgYXMgJ2NhcmQnIHwgJ2xpc3QnIHwgJ3RpbWVsaW5lJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NTJBMFx1OEY3RFx1NjI0MFx1NjcwOVx1N0IxNFx1OEJCMFx1NUU3Nlx1NTIxQlx1NUVGQVx1NTM2MVx1NzI0N1xyXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkTm90ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgLy8gXHU0RjdGXHU3NTI4IFByb21pc2UuYWxsIFx1N0I0OVx1NUY4NVx1NjI0MFx1NjcwOVx1NTM2MVx1NzI0N1x1NTIxQlx1NUVGQVx1NUI4Q1x1NjIxMFxyXG4gICAgICAgIGNvbnN0IGNhcmRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICAgIGZpbGVzLm1hcChmaWxlID0+IHRoaXMuY3JlYXRlTm90ZUNhcmQoZmlsZSkpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU1MjMwXHU1QkI5XHU1NjY4XHVGRjBDXHU1RTc2XHU4QkJFXHU3RjZFXHU2QjYzXHU3ODZFXHU3Njg0XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgaWYgKGNhcmQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgY2FyZC5zdHlsZS53aWR0aCA9IGAke3RoaXMuY2FyZFNpemV9cHhgO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY2FyZCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU3ODZFXHU0RkREXHU1QkI5XHU1NjY4XHU0RjdGXHU3NTI4XHU2QjYzXHU3ODZFXHU3Njg0XHU3RjUxXHU2ODNDXHU1MjE3XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoYXV0by1maWxsLCAke3RoaXMuY2FyZFNpemV9cHgpYDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTIxQlx1NUVGQVx1NTM1NVx1NEUyQVx1N0IxNFx1OEJCMFx1NTM2MVx1NzI0N1xyXG4gICAgICogQHBhcmFtIGZpbGUgLSBcdTdCMTRcdThCQjBcdTY1ODdcdTRFRjZcclxuICAgICAqIEByZXR1cm5zIFx1NTM2MVx1NzI0N0hUTUxcdTUxNDNcdTdEMjBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVOb3RlQ2FyZChmaWxlOiBURmlsZSk6IFByb21pc2U8SFRNTEVsZW1lbnQ+IHtcclxuICAgICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgICAgICAgY2FyZC5hZGRDbGFzcygnbm90ZS1jYXJkJyk7XHJcbiAgICAgICAgY2FyZC5zZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcsIGZpbGUucGF0aCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU1MzYxXHU3MjQ3XHU1OTM0XHU5MEU4XHJcbiAgICAgICAgY29uc3QgaGVhZGVyID0gY2FyZC5jcmVhdGVEaXYoJ25vdGUtY2FyZC1oZWFkZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTRGRUVcdTY1MzlcdTY1RjZcdTk1RjRcclxuICAgICAgICBjb25zdCBsYXN0TW9kaWZpZWQgPSBoZWFkZXIuY3JlYXRlRGl2KCdub3RlLWRhdGUnKTtcclxuICAgICAgICBsYXN0TW9kaWZpZWQuc2V0VGV4dChuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpLnRvTG9jYWxlRGF0ZVN0cmluZygpKTtcclxuXHJcbiAgICAgICAgLy8gXHU0RkVFXHU2NTM5XHU2NTg3XHU0RUY2XHU1OTM5XHU4REVGXHU1Rjg0XHU3Njg0XHU1MjFCXHU1RUZBXHU1NDhDXHU2ODM3XHU1RjBGXHJcbiAgICAgICAgY29uc3QgZm9sZGVyUGF0aCA9IGhlYWRlci5jcmVhdGVEaXYoJ25vdGUtZm9sZGVyJyk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVyID0gZmlsZS5wYXJlbnQgPyAoZmlsZS5wYXJlbnQucGF0aCA9PT0gJy8nID8gJ1x1NjgzOVx1NzZFRVx1NUY1NScgOiBmaWxlLnBhcmVudC5wYXRoKSA6ICdcdTY4MzlcdTc2RUVcdTVGNTUnO1xyXG4gICAgICAgIGZvbGRlclBhdGguc2V0VGV4dChmb2xkZXIpO1xyXG4gICAgICAgIGZvbGRlclBhdGguc2V0QXR0cmlidXRlKCd0aXRsZScsIGBcdTYyNTNcdTVGMDBcdTY1ODdcdTRFRjZcdTU5Mzk6ICR7Zm9sZGVyfWApO1xyXG4gICAgICAgIGZvbGRlclBhdGguYWRkQ2xhc3MoJ2NsaWNrYWJsZScpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlxyXG4gICAgICAgIGZvbGRlclBhdGguYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoZSkgPT4ge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnXHU3MEI5XHU1MUZCXHU0RTg2XHU2NTg3XHU0RUY2XHU1OTM5JyxlKTtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnXHU3MEI5XHU1MUZCXHU0RTg2XHU2NTg3XHU0RUY2XHU1OTM5JyxlKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NjI1M1x1NUYwMFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICBjb25zdCBmaWxlRXhwbG9yZXIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdmaWxlLWV4cGxvcmVyJylbMF07XHJcbiAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmaWxlRXhwbG9yZXInLGZpbGVFeHBsb3Jlcik7XHJcbiAgICAgICAgICAgICAgICAvLyBcdTZGQzBcdTZEM0JcdTY1ODdcdTRFRjZcdTZENEZcdTg5QzhcdTU2NjhcdTg5QzZcdTU2RkVcclxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5yZXZlYWxMZWFmKGZpbGVFeHBsb3Jlcik7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFx1ODlDNlx1NTZGRVx1NUI5RVx1NEY4QlxyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUV4cGxvcmVyVmlldyA9IGZpbGVFeHBsb3Jlci52aWV3IGFzIGFueTtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXJWaWV3LmV4cGFuZEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucmV2ZWFsRm9sZGVySW5FeHBsb3Jlcihmb2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1ODA1QVx1NzEyNlx1NTIzMFx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVFeHBsb3Jlci5zZXRFcGhlbWVyYWxTdGF0ZSh7IGZvY3VzOiB0cnVlIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1ODlDNlx1ODlDOVx1NTNDRFx1OTk4OFxyXG4gICAgICAgICAgICAgICAgICAgIGZvbGRlclBhdGguYWRkQ2xhc3MoJ2ZvbGRlci1jbGlja2VkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvbGRlclBhdGgucmVtb3ZlQ2xhc3MoJ2ZvbGRlci1jbGlja2VkJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSwgMjAwKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBvcGVuQnV0dG9uID0gaGVhZGVyLmNyZWF0ZURpdignbm90ZS1vcGVuLWJ1dHRvbicpO1xyXG4gICAgICAgIG9wZW5CdXR0b24uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBkPVwiTTE4IDEzdjZhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJWOGEyIDIgMCAwIDEgMi0yaDZcIj48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz1cIjE1IDMgMjEgMyAyMSA5XCI+PC9wb2x5bGluZT48bGluZSB4MT1cIjEwXCIgeTE9XCIxNFwiIHgyPVwiMjFcIiB5Mj1cIjNcIj48L2xpbmU+PC9zdmc+YDtcclxuICAgICAgICBvcGVuQnV0dG9uLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnXHU1NzI4XHU2NUIwXHU2ODA3XHU3QjdFXHU5ODc1XHU0RTJEXHU2MjUzXHU1RjAwJyk7XHJcbiAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzAnOyAgLy8gXHU5RUQ4XHU4QkE0XHU5NjkwXHU4NUNGXHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NTM2MVx1NzI0N1x1NTE4NVx1NUJCOVx1NUJCOVx1NTY2OFxyXG4gICAgICAgIGNvbnN0IGNhcmRDb250ZW50ID0gY2FyZC5jcmVhdGVEaXYoJ25vdGUtY2FyZC1jb250ZW50Jyk7XHJcblxyXG4gICAgICAgIC8vIFx1NTkwNFx1NzQwNlx1NjgwN1x1OTg5OFx1RkYwOFx1NzlGQlx1NTIzMFx1NTE4NVx1NUJCOVx1NTMzQVx1NTdERlx1OTg3Nlx1OTBFOFx1RkYwOVxyXG4gICAgICAgIGNvbnN0IHRpdGxlID0gY2FyZENvbnRlbnQuY3JlYXRlRGl2KCdub3RlLXRpdGxlJyk7XHJcbiAgICAgICAgbGV0IGRpc3BsYXlUaXRsZSA9IGZpbGUuYmFzZW5hbWU7XHJcbiAgICAgICAgLy8gXHU1OTA0XHU3NDA2XHU2NUU1XHU2NzFGXHU1RjAwXHU1OTM0XHU3Njg0XHU2ODA3XHU5ODk4XHJcbiAgICAgICAgY29uc3QgdGltZVBhdHRlcm4gPSAvXlxcZHs0fVstLi9dXFxkezJ9Wy0uL11cXGR7Mn0vO1xyXG4gICAgICAgIGlmICh0aW1lUGF0dGVybi50ZXN0KGRpc3BsYXlUaXRsZSkpIHtcclxuICAgICAgICAgICAgZGlzcGxheVRpdGxlID0gZGlzcGxheVRpdGxlLnJlcGxhY2UodGltZVBhdHRlcm4sICcnKS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRpdGxlLnNldFRleHQoZGlzcGxheVRpdGxlKTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gXHU4QkZCXHU1M0Q2XHU3QjE0XHU4QkIwXHU1MTg1XHU1QkI5XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU3QjE0XHU4QkIwXHU1MTg1XHU1QkI5XHU1QkI5XHU1NjY4XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdGVDb250ZW50ID0gY2FyZENvbnRlbnQuY3JlYXRlRGl2KCdub3RlLWNvbnRlbnQnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NkUzMlx1NjdEMyBNYXJrZG93biBcdTUxODVcdTVCQjlcclxuICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBub3RlQ29udGVudCxcclxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgIHRoaXMgXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTlGMjBcdTY4MDdcdTYwQUNcdTUwNUNcdTRFOEJcdTRFRjZcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzEnOyAgLy8gXHU2NjNFXHU3OTNBXHU2MjUzXHU1RjAwXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgICAgICAgICB0aXRsZS5zdHlsZS5vcGFjaXR5ID0gJzAnO1xyXG4gICAgICAgICAgICAgICAgdGl0bGUuc3R5bGUuZGlzcGxheSA9ICdub25lJzsgXHJcbiAgICAgICAgICAgICAgICBub3RlQ29udGVudC5zdHlsZS5vcGFjaXR5ID0gJzEnO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBcdTU3MjhcdTk4ODRcdTg5QzhcdTY4MEZcdTRFMkRcdTY2M0VcdTc5M0FcdTVCOENcdTY1NzRcdTUxODVcdTVCQjlcclxuICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlLnBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcdTk4ODRcdTg5QzhcdTUyQTBcdThGN0RcdTU5MzFcdThEMjU6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1OUYyMFx1NjgwN1x1NzlCQlx1NUYwMFx1NEU4Qlx1NEVGNlxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBvcGVuQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMCc7ICAvLyBcdTk2OTBcdTg1Q0ZcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICAgICAgICAgIHRpdGxlLnN0eWxlLm9wYWNpdHkgPSAnMSc7XHJcbiAgICAgICAgICAgICAgICB0aXRsZS5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJzsgXHJcbiAgICAgICAgICAgICAgICBub3RlQ29udGVudC5zdHlsZS5vcGFjaXR5ID0gJzAuMyc7XHJcbiAgICAgICAgICAgICAgICAvLyBub3RlQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NEZFRVx1NjUzOVx1NEU4Qlx1NEVGNlx1NzZEMVx1NTQyQ1xyXG4gICAgICAgICAgICBvcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9wZW5JbkFwcHJvcHJpYXRlTGVhZihmaWxlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTUzNTVcdTUxRkJcdTkwMDlcdTYyRTlcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhcmRTZWxlY3Rpb24oZmlsZS5wYXRoLCBlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTUzQ0NcdTUxRkJcdTYyNTNcdTVGMDBcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMub3BlbkluQXBwcm9wcmlhdGVMZWFmKGZpbGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NTNGM1x1OTUyRVx1ODNEQ1x1NTM1NVxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0NvbnRleHRNZW51KGUsIHRoaXMuZ2V0U2VsZWN0ZWRGaWxlcygpKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1N0IxNFx1OEJCMFx1NTJBMFx1OEY3RFx1NTkzMVx1OEQyNTonLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTUzNjFcdTcyNDdcdTYwQUNcdTUwNUNcdTRFOEJcdTRFRjZcclxuICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcxJzsgIC8vIFx1NjYzRVx1NzkzQVx1NjI1M1x1NUYwMFx1NjMwOVx1OTRBRVxyXG4gICAgICAgICAgICAvLyAuLi4gXHU1MTc2XHU0RUQ2XHU2MEFDXHU1MDVDXHU0RThCXHU0RUY2XHU3ODAxIC4uLlxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcwJzsgIC8vIFx1OTY5MFx1ODVDRlx1NjI1M1x1NUYwMFx1NjMwOVx1OTRBRVxyXG4gICAgICAgICAgICAvLyAuLi4gXHU1MTc2XHU0RUQ2XHU3OUJCXHU1RjAwXHU0RThCXHU0RUY2XHU0RUUzXHU3ODAxIC4uLlxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gY2FyZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTIwN1x1NjM2Mlx1ODlDNlx1NTZGRVx1NkEyMVx1NUYwRlxyXG4gICAgICogQHBhcmFtIHZpZXcgLSBcdTc2RUVcdTY4MDdcdTg5QzZcdTU2RkVcdTZBMjFcdTVGMEZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzd2l0Y2hWaWV3KHZpZXc6ICdjYXJkJyB8ICdsaXN0JyB8ICd0aW1lbGluZScpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRWaWV3ID0gdmlldztcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmlldycsIHZpZXcpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHZpZXcgPT09ICd0aW1lbGluZScpIHtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVUaW1lbGluZVZpZXcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWROb3RlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NjgzOVx1NjM2RVx1NjgwN1x1N0I3RVx1OEZDN1x1NkVFNFx1N0IxNFx1OEJCMFxyXG4gICAgICogQHBhcmFtIHRhZyAtIFx1NjgwN1x1N0I3RVx1NTQwRFx1NzlGMFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFzeW5jIGZpbHRlckJ5VGFnKHRhZzogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlPy50YWdzPy5zb21lKHQgPT4gdC50YWcgPT09IHRhZyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NEY3Rlx1NzUyOCBQcm9taXNlLmFsbCBcdTdCNDlcdTVGODVcdTYyNDBcdTY3MDlcdTUzNjFcdTcyNDdcdTUyMUJcdTVFRkFcdTVCOENcdTYyMTBcclxuICAgICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgICBmaWx0ZXJlZEZpbGVzLm1hcChmaWxlID0+IHRoaXMuY3JlYXRlTm90ZUNhcmQoZmlsZSkpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU1MjMwXHU1QkI5XHU1NjY4XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY2FyZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1OUFEOFx1NEVBRVx1OTAwOVx1NEUyRFx1NzY4NFx1NjgwN1x1N0I3RVxyXG4gICAgICAgIHRoaXMudGFnQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgaWYgKGJ0bi50ZXh0Q29udGVudCA9PT0gdGFnKSB7XHJcbiAgICAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZS10YWcnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJ0bi5yZW1vdmVDbGFzcygnYWN0aXZlLXRhZycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU1MjA3XHU2MzYyXHU5ODg0XHU4OUM4XHU2ODBGXHU3Njg0XHU2NjNFXHU3OTNBXHU3MkI2XHU2MDAxXHJcbiAgICBwcml2YXRlIHRvZ2dsZVByZXZpZXcoKSB7XHJcbiAgICAgICAgdGhpcy5pc1ByZXZpZXdDb2xsYXBzZWQgPSAhdGhpcy5pc1ByZXZpZXdDb2xsYXBzZWQ7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNQcmV2aWV3Q29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lci5hZGRDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU0RkVFXHU2NTM5XHU5ODg0XHU4OUM4XHU2ODBGXHU1OTI3XHU1QzBGXHU4QzAzXHU2NTc0XHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIHNldHVwUmVzaXplcigpIHtcclxuICAgICAgICBsZXQgc3RhcnRYOiBudW1iZXI7XHJcbiAgICAgICAgbGV0IHN0YXJ0V2lkdGg6IG51bWJlcjtcclxuXHJcbiAgICAgICAgY29uc3Qgc3RhcnRSZXNpemUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIHN0YXJ0WCA9IGUucGFnZVg7XHJcbiAgICAgICAgICAgIHN0YXJ0V2lkdGggPSBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKHRoaXMucHJldmlld0NvbnRhaW5lcikud2lkdGgsIDEwKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgcmVzaXplKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN0b3BSZXNpemUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICdjb2wtcmVzaXplJztcclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3UmVzaXplci5hZGRDbGFzcygncmVzaXppbmcnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCByZXNpemUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB3aWR0aCA9IHN0YXJ0V2lkdGggLSAoZS5wYWdlWCAtIHN0YXJ0WCk7XHJcbiAgICAgICAgICAgIGlmICh3aWR0aCA+PSA1MCAmJiB3aWR0aCA8PSA4MDApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lci5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcclxuICAgICAgICAgICAgICAgIC8vIFx1OEMwM1x1NjU3NFx1NTM2MVx1NzI0N1x1NUJCOVx1NTY2OFx1NzY4NFx1NUJCRFx1NUVBNlxyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGp1c3RDb250ZW50V2lkdGgoKTtcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzUHJldmlld0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaXNQcmV2aWV3Q29sbGFwc2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLnJlbW92ZUNsYXNzKCdjb2xsYXBzZWQnKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IHN0b3BSZXNpemUgPSAoKSA9PiB7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIHJlc2l6ZSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBzdG9wUmVzaXplKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zdHlsZS5jdXJzb3IgPSAnJztcclxuICAgICAgICAgICAgdGhpcy5wcmV2aWV3UmVzaXplci5yZW1vdmVDbGFzcygncmVzaXppbmcnKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLnByZXZpZXdSZXNpemVyLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHN0YXJ0UmVzaXplKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTUxODVcdTVCQjlcdTUzM0FcdTU3REZcdTVCQkRcdTVFQTZcdThDMDNcdTY1NzRcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgYWRqdXN0Q29udGVudFdpZHRoKCkge1xyXG4gICAgICAgIGNvbnN0IG1haW5MYXlvdXQgPSB0aGlzLmNvbnRhaW5lckVsLnF1ZXJ5U2VsZWN0b3IoJy5tYWluLWxheW91dCcpO1xyXG4gICAgICAgIGNvbnN0IHByZXZpZXdXaWR0aCA9IHRoaXMucHJldmlld0NvbnRhaW5lci5vZmZzZXRXaWR0aDtcclxuICAgICAgICBjb25zdCBjb250ZW50U2VjdGlvbiA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLmNvbnRlbnQtc2VjdGlvbicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmIChtYWluTGF5b3V0ICYmIGNvbnRlbnRTZWN0aW9uKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsV2lkdGggPSBtYWluTGF5b3V0Lm9mZnNldFdpZHRoO1xyXG4gICAgICAgICAgICBjb25zdCBuZXdDb250ZW50V2lkdGggPSB0b3RhbFdpZHRoIC0gcHJldmlld1dpZHRoIC0gNDsgLy8gNHB4IFx1NjYyRlx1NTIwNlx1OTY5NFx1N0VCRlx1NUJCRFx1NUVBNlxyXG4gICAgICAgICAgICBjb250ZW50U2VjdGlvbi5zdHlsZS53aWR0aCA9IGAke25ld0NvbnRlbnRXaWR0aH1weGA7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTkxQ0RcdTY1QjBcdThCQTFcdTdCOTdcdTUzNjFcdTcyNDdcdTUyMTdcdTY1NzBcclxuICAgICAgICAgICAgY29uc3QgYXZhaWxhYmxlV2lkdGggPSBuZXdDb250ZW50V2lkdGggLSAzMjsgLy8gXHU1MUNGXHU1M0JCXHU1MTg1XHU4RkI5XHU4REREXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbHVtbnMgPSBNYXRoLmZsb29yKGF2YWlsYWJsZVdpZHRoIC8gdGhpcy5jYXJkU2l6ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGdhcCA9IDE2OyAvLyBcdTUzNjFcdTcyNDdcdTk1RjRcdThERERcclxuICAgICAgICAgICAgY29uc3QgYWN0dWFsQ2FyZFdpZHRoID0gKGF2YWlsYWJsZVdpZHRoIC0gKGNvbHVtbnMgLSAxKSAqIGdhcCkgLyBjb2x1bW5zO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuc3R5bGUuZ3JpZFRlbXBsYXRlQ29sdW1ucyA9IGByZXBlYXQoJHtjb2x1bW5zfSwgJHthY3R1YWxDYXJkV2lkdGh9cHgpYDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU5QUQ4XHU0RUFFXHU2NTg3XHU0RUY2XHU1OTM5XHJcbiAgICBwcml2YXRlIGhpZ2hsaWdodEZvbGRlcihmb2xkZXI6IHN0cmluZykge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZvbGRlciA9IHRoaXMuY3VycmVudEZvbGRlciA9PT0gZm9sZGVyID8gbnVsbCA6IGZvbGRlcjtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubm90ZS1jYXJkJykuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZm9sZGVyRWxlbWVudCA9IGNhcmQucXVlcnlTZWxlY3RvcignLm5vdGUtZm9sZGVyJyk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNhcmRGb2xkZXIgPSBmb2xkZXJFbGVtZW50ID8gZm9sZGVyRWxlbWVudC50ZXh0Q29udGVudCA6IG51bGw7XHJcbiAgICAgICAgICAgIGlmIChjYXJkRm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnRvZ2dsZUNsYXNzKCdmb2xkZXItaGlnaGxpZ2h0JywgY2FyZEZvbGRlciA9PT0gZm9sZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgcmV2ZWFsRm9sZGVySW5FeHBsb3Jlcihmb2xkZXI6IHN0cmluZykge1xyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFx1ODlDNlx1NTZGRVxyXG4gICAgICAgIGNvbnN0IGZpbGVFeHBsb3JlciA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoJ2ZpbGUtZXhwbG9yZXInKVswXTtcclxuICAgICAgICBpZiAoZmlsZUV4cGxvcmVyKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGVFeHBsb3JlclZpZXcgPSBmaWxlRXhwbG9yZXIudmlldyBhcyBhbnk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTY2MkZcdTY4MzlcdTc2RUVcdTVGNTVcdUZGMENcdTc2RjRcdTYzQTVcdTVDNTVcdTVGMDBcdTY4MzlcdTc2RUVcdTVGNTVcclxuICAgICAgICAgICAgaWYgKGZvbGRlciA9PT0gJ1x1NjgzOVx1NzZFRVx1NUY1NScpIHtcclxuICAgICAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXJWaWV3LmV4cGFuZEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IGZpbGVFeHBsb3JlclZpZXcuZXhwYW5kRm9sZGVyKCcvJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFx1NUM1NVx1NUYwMFx1NUU3Nlx1OTAwOVx1NEUyRFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICBpZiAoZmlsZUV4cGxvcmVyVmlldy5leHBhbmRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIFx1NUM1NVx1NUYwMFx1NzIzNlx1NjU4N1x1NEVGNlx1NTkzOVx1OERFRlxyXG4gICAgICAgICAgICAgICAgY29uc3QgZm9sZGVyUGFydHMgPSBmb2xkZXIuc3BsaXQoJy8nKTtcclxuICAgICAgICAgICAgICAgIGxldCBjdXJyZW50UGF0aCA9ICcnO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAvLyBcdTkwMTBcdTdFQTdcdTVDNTVcdTVGMDBcdTY1ODdcdTRFRjZcdTU5MzlcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgcGFydCBvZiBmb2xkZXJQYXJ0cykge1xyXG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRQYXRoICs9IChjdXJyZW50UGF0aCA/ICcvJyA6ICcnKSArIHBhcnQ7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUV4cGxvcmVyVmlldy5leHBhbmRGb2xkZXIoY3VycmVudFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIC8vIFx1OTAwOVx1NEUyRFx1NzZFRVx1NjgwN1x1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHBsb3JlclZpZXcuc2V0U2VsZWN0aW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUV4cGxvcmVyVmlldy5zZXRTZWxlY3Rpb24oZm9sZGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTUyMUJcdTVFRkFcdTY1QjBcdTdCMTRcdThCQjBcclxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlTmV3Tm90ZSgpIHtcclxuICAgICAgICAvLyBcdTgzQjdcdTUzRDZcdTVGNTNcdTUyNERcdTY1RTVcdTY3MUZcdTRGNUNcdTRFM0FcdTlFRDhcdThCQTRcdTY1ODdcdTRFRjZcdTU0MERcclxuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGAgJHtkYXRlLnRvTG9jYWxlU3RyaW5nKCkucmVwbGFjZSgvWy86XS9nLCAnLScpfVx1NjcyQVx1NTQ3RFx1NTQwRFx1N0IxNFx1OEJCMGA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2NUIwXHU3QjE0XHU4QkIwXHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoXHJcbiAgICAgICAgICAgICAgICBgJHtmaWxlTmFtZX0ubWRgLFxyXG4gICAgICAgICAgICAgICAgJyMgJyArIGZpbGVOYW1lICsgJ1xcblxcbidcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTcyOFx1NjVCMFx1NjgwN1x1N0I3RVx1OTg3NVx1NEUyRFx1NjI1M1x1NUYwMFx1N0IxNFx1OEJCMFxyXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1MjM3XHU2NUIwXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFXHJcbiAgICAgICAgICAgIHRoaXMubG9hZE5vdGVzKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignXHU1MjFCXHU1RUZBXHU3QjE0XHU4QkIwXHU1OTMxXHU4RDI1OicsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU1MjFCXHU1RUZBXHU2NUY2XHU5NUY0XHU4Rjc0XHU4OUM2XHU1NkZFXHJcbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZVRpbWVsaW5lVmlldygpIHtcclxuICAgICAgICBjb25zdCB0aW1lbGluZUNvbnRhaW5lciA9IHRoaXMuY29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtY29udGFpbmVyJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU2MjQwXHU2NzA5XHU3QjE0XHU4QkIwXHU1RTc2XHU2MzA5XHU2NUU1XHU2NzFGXHU1MjA2XHU3RUM0XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgY29uc3Qgbm90ZXNCeURhdGUgPSBuZXcgTWFwPHN0cmluZywgVEZpbGVbXT4oKTtcclxuICAgICAgICBcclxuICAgICAgICBmaWxlcy5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZmlsZS5zdGF0Lm10aW1lKS50b0xvY2FsZURhdGVTdHJpbmcoKTtcclxuICAgICAgICAgICAgaWYgKCFub3Rlc0J5RGF0ZS5oYXMoZGF0ZSkpIHtcclxuICAgICAgICAgICAgICAgIG5vdGVzQnlEYXRlLnNldChkYXRlLCBbXSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3Qgbm90ZXMgPSBub3Rlc0J5RGF0ZS5nZXQoZGF0ZSk7XHJcbiAgICAgICAgICAgIGlmIChub3Rlcykge1xyXG4gICAgICAgICAgICAgICAgbm90ZXMucHVzaChmaWxlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTYzMDlcdTY1RTVcdTY3MUZcdTYzOTJcdTVFOEZcclxuICAgICAgICBjb25zdCBzb3J0ZWREYXRlcyA9IEFycmF5LmZyb20obm90ZXNCeURhdGUua2V5cygpKS5zb3J0KChhLCBiKSA9PiBcclxuICAgICAgICAgICAgbmV3IERhdGUoYikuZ2V0VGltZSgpIC0gbmV3IERhdGUoYSkuZ2V0VGltZSgpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2NUY2XHU5NUY0XHU4Rjc0XHJcbiAgICAgICAgZm9yIChjb25zdCBkYXRlIG9mIHNvcnRlZERhdGVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGVHcm91cCA9IHRpbWVsaW5lQ29udGFpbmVyLmNyZWF0ZURpdigndGltZWxpbmUtZGF0ZS1ncm91cCcpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2NUU1XHU2NzFGXHU4MjgyXHU3MEI5XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGVOb2RlID0gZGF0ZUdyb3VwLmNyZWF0ZURpdigndGltZWxpbmUtZGF0ZS1ub2RlJyk7XHJcbiAgICAgICAgICAgIGRhdGVOb2RlLmNyZWF0ZURpdigndGltZWxpbmUtbm9kZS1jaXJjbGUnKTtcclxuICAgICAgICAgICAgZGF0ZU5vZGUuY3JlYXRlRGl2KCd0aW1lbGluZS1kYXRlLWxhYmVsJykuc2V0VGV4dChkYXRlKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1N0IxNFx1OEJCMFx1NTIxN1x1ODg2OFxyXG4gICAgICAgICAgICBjb25zdCBub3Rlc0xpc3QgPSBkYXRlR3JvdXAuY3JlYXRlRGl2KCd0aW1lbGluZS1ub3Rlcy1saXN0Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdGVzID0gbm90ZXNCeURhdGUuZ2V0KGRhdGUpO1xyXG4gICAgICAgICAgICBpZiAobm90ZXMpIHtcclxuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBub3Rlcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVJdGVtID0gbm90ZXNMaXN0LmNyZWF0ZURpdigndGltZWxpbmUtbm90ZS1pdGVtJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2ODA3XHU4QkIwXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZUl0ZW0uY3JlYXRlRGl2KCd0aW1lbGluZS1ub3RlLW1hcmtlcicpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1N0IxNFx1OEJCMFx1NTE4NVx1NUJCOVxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5vdGVDb250ZW50ID0gbm90ZUl0ZW0uY3JlYXRlRGl2KCd0aW1lbGluZS1ub3RlLWNvbnRlbnQnKTtcclxuICAgICAgICAgICAgICAgICAgICBub3RlQ29udGVudC5jcmVhdGVEaXYoJ3RpbWVsaW5lLW5vdGUtdGl0bGUnKS5zZXRUZXh0KGZpbGUuYmFzZW5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NzBCOVx1NTFGQlx1NEU4Qlx1NEVGNlxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGVJdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTk4ODRcdTg5QzhcdTUyOUZcdTgwRkRcclxuICAgICAgICAgICAgICAgICAgICBub3RlSXRlbS5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWVudGVyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZChmaWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdcdTk4ODRcdTg5QzhcdTUyQTBcdThGN0RcdTU5MzFcdThEMjU6JywgZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU1MjM3XHU2NUIwXHU4OUM2XHU1NkZFXHVGRjA4XHU3NTI4XHU0RThFXHU2NDFDXHU3RDIyXHU1NDhDXHU4RkM3XHU2RUU0XHVGRjA5XHJcbiAgICBwcml2YXRlIGFzeW5jIHJlZnJlc2hWaWV3KCkge1xyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZpbHRlcmVkRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFx1NjQxQ1x1N0QyMlx1OEZDN1x1NkVFNFxyXG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzU2VhcmNoID0gIXRoaXMuY3VycmVudFNlYXJjaFRlcm0gfHwgXHJcbiAgICAgICAgICAgICAgICBmaWxlLmJhc2VuYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXModGhpcy5jdXJyZW50U2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NjgwN1x1N0I3RVx1OEZDN1x1NkVFNFxyXG4gICAgICAgICAgICBsZXQgbWF0Y2hlc1RhZ3MgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFRhZ3Muc2l6ZSA+IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICBtYXRjaGVzVGFncyA9IGNhY2hlPy50YWdzPy5zb21lKHQgPT4gdGhpcy5zZWxlY3RlZFRhZ3MuaGFzKHQudGFnKSkgPz8gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIC8vIFx1NjVFNVx1NjcxRlx1OEZDN1x1NkVFNFxyXG4gICAgICAgICAgICBsZXQgbWF0Y2hlc0RhdGUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5jdXJyZW50RmlsdGVyLnR5cGUgPT09ICdkYXRlJykge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZURhdGUgPSBuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZURhdGVTdHIgPSBmaWxlRGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF07XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWx0ZXIudmFsdWUubGVuZ3RoID09PSA3KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU2MzA5XHU2NzA4XHU0RUZEXHU4RkM3XHU2RUU0XHJcbiAgICAgICAgICAgICAgICAgICAgbWF0Y2hlc0RhdGUgPSBmaWxlRGF0ZVN0ci5zdGFydHNXaXRoKHRoaXMuY3VycmVudEZpbHRlci52YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NjMwOVx1NTE3N1x1NEY1M1x1NjVFNVx1NjcxRlx1OEZDN1x1NkVFNFxyXG4gICAgICAgICAgICAgICAgICAgIG1hdGNoZXNEYXRlID0gZmlsZURhdGVTdHIgPT09IHRoaXMuY3VycmVudEZpbHRlci52YWx1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIG1hdGNoZXNTZWFyY2ggJiYgbWF0Y2hlc1RhZ3MgJiYgbWF0Y2hlc0RhdGU7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NTM2MVx1NzI0N1x1NUU3Nlx1OUFEOFx1NEVBRVx1NjQxQ1x1N0QyMlx1OEJDRFxyXG4gICAgICAgIGNvbnN0IGNhcmRzID0gYXdhaXQgUHJvbWlzZS5hbGwoXHJcbiAgICAgICAgICAgIGZpbHRlcmVkRmlsZXMubWFwKGZpbGUgPT4gdGhpcy5jcmVhdGVOb3RlQ2FyZChmaWxlLCB0aGlzLmN1cnJlbnRTZWFyY2hUZXJtKSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBjYXJkcy5mb3JFYWNoKGNhcmQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2FyZCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnN0eWxlLndpZHRoID0gYCR7dGhpcy5jYXJkU2l6ZX1weGA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChjYXJkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdChhdXRvLWZpbGwsICR7dGhpcy5jYXJkU2l6ZX1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NkRGQlx1NTJBMFx1NjgwN1x1N0I3RVx1NTIwN1x1NjM2Mlx1NjVCOVx1NkNENVxyXG4gICAgcHJpdmF0ZSB0b2dnbGVUYWcodGFnOiBzdHJpbmcsIHRhZ0J0bjogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICBpZiAodGhpcy5zZWxlY3RlZFRhZ3MuaGFzKHRhZykpIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFRhZ3MuZGVsZXRlKHRhZyk7XHJcbiAgICAgICAgICAgIHRhZ0J0bi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFRhZ3MuYWRkKHRhZyk7XHJcbiAgICAgICAgICAgIHRhZ0J0bi5hZGRDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBcdTUzRDZcdTZEODggXCJBbGxcIiBcdTY4MDdcdTdCN0VcdTc2ODRcdTkwMDlcdTRFMkRcdTcyQjZcdTYwMDFcclxuICAgICAgICBjb25zdCBhbGxCdG4gPSB0aGlzLnRhZ0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdidXR0b24nKTtcclxuICAgICAgICBpZiAoYWxsQnRuKSB7XHJcbiAgICAgICAgICAgIGFsbEJ0bi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLnJlZnJlc2hWaWV3KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2REZCXHU1MkEwXHU2RTA1XHU5NjY0XHU2ODA3XHU3QjdFXHU5MDA5XHU2MkU5XHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIGNsZWFyVGFnU2VsZWN0aW9uKCkge1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRUYWdzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy50YWdDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnRhZy1idG4nKS5mb3JFYWNoKGJ0biA9PiB7XHJcbiAgICAgICAgICAgIGJ0bi5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU1OTA0XHU3NDA2XHU1MzYxXHU3MjQ3XHU5MDA5XHU2MkU5XHJcbiAgICBwcml2YXRlIGhhbmRsZUNhcmRTZWxlY3Rpb24ocGF0aDogc3RyaW5nLCBldmVudDogTW91c2VFdmVudCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKGBbZGF0YS1wYXRoPVwiJHtwYXRofVwiXWApO1xyXG4gICAgICAgIGlmICghY2FyZCkge1xyXG4gICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGV2ZW50LmN0cmxLZXkpIHtcclxuICAgICAgICAgICAgLy8gQ3RybCArIFx1NzBCOVx1NTFGQlx1RkYxQVx1NTIwN1x1NjM2Mlx1OTAwOVx1NjJFOVxyXG4gICAgICAgICAgICBpZiAodGhpcy5zZWxlY3RlZE5vdGVzLmhhcyhwYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vdGVzLmRlbGV0ZShwYXRoKTtcclxuICAgICAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZXMuYWRkKHBhdGgpO1xyXG4gICAgICAgICAgICAgICAgY2FyZC5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSBpZiAoZXZlbnQuc2hpZnRLZXkgJiYgdGhpcy5sYXN0U2VsZWN0ZWROb3RlKSB7XHJcbiAgICAgICAgICAgIC8vIFNoaWZ0ICsgXHU3MEI5XHU1MUZCXHVGRjFBXHU4RkRFXHU3RUVEXHU5MDA5XHU2MkU5XHJcbiAgICAgICAgICAgIGNvbnN0IGNhcmRzID0gQXJyYXkuZnJvbSh0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubm90ZS1jYXJkJykpO1xyXG4gICAgICAgICAgICBjb25zdCBsYXN0SW5kZXggPSBjYXJkcy5maW5kSW5kZXgoYyA9PiBjLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXRoJykgPT09IHRoaXMubGFzdFNlbGVjdGVkTm90ZSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRJbmRleCA9IGNhcmRzLmZpbmRJbmRleChjID0+IGMuZ2V0QXR0cmlidXRlKCdkYXRhLXBhdGgnKSA9PT0gcGF0aCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IE1hdGgubWluKGxhc3RJbmRleCwgY3VycmVudEluZGV4KTtcclxuICAgICAgICAgICAgY29uc3QgZW5kID0gTWF0aC5tYXgobGFzdEluZGV4LCBjdXJyZW50SW5kZXgpO1xyXG5cclxuICAgICAgICAgICAgY2FyZHMuZm9yRWFjaCgoYywgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgY2FyZFBhdGggPSBjLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXRoJyk7XHJcbiAgICAgICAgICAgICAgICBpZiAoaSA+PSBzdGFydCAmJiBpIDw9IGVuZCAmJiBjYXJkUGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb3Rlcy5hZGQoY2FyZFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGMuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFx1NjY2RVx1OTAxQVx1NzBCOVx1NTFGQlx1RkYxQVx1NkUwNVx1OTY2NFx1NTE3Nlx1NEVENlx1OTAwOVx1NjJFOVx1RkYwQ1x1OTAwOVx1NEUyRFx1NUY1M1x1NTI0RFxyXG4gICAgICAgICAgICB0aGlzLmNsZWFyU2VsZWN0aW9uKCk7XHJcbiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb3Rlcy5hZGQocGF0aCk7XHJcbiAgICAgICAgICAgIGNhcmQuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLmxhc3RTZWxlY3RlZE5vdGUgPSBwYXRoO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NkUwNVx1OTY2NFx1NjI0MFx1NjcwOVx1OTAwOVx1NjJFOVxyXG4gICAgcHJpdmF0ZSBjbGVhclNlbGVjdGlvbigpIHtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZXMuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcubm90ZS1jYXJkLnNlbGVjdGVkJykuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgY2FyZC5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTgzQjdcdTUzRDZcdTkwMDlcdTRFMkRcdTc2ODRcdTY1ODdcdTRFRjZcclxuICAgIHByaXZhdGUgZ2V0U2VsZWN0ZWRGaWxlcygpOiBURmlsZVtdIHtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbSh0aGlzLnNlbGVjdGVkTm90ZXMpXHJcbiAgICAgICAgICAgIC5tYXAocGF0aCA9PiB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocGF0aCkpXHJcbiAgICAgICAgICAgIC5maWx0ZXIoKGZpbGUpOiBmaWxlIGlzIFRGaWxlID0+IGZpbGUgaW5zdGFuY2VvZiBURmlsZSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2NjNFXHU3OTNBXHU1M0YzXHU5NTJFXHU4M0RDXHU1MzU1XHJcbiAgICBwcml2YXRlIHNob3dDb250ZXh0TWVudShldmVudDogTW91c2VFdmVudCwgZmlsZXM6IFRGaWxlW10pIHtcclxuICAgICAgICBjb25zdCBtZW51ID0gbmV3IE1lbnUoKTtcclxuXHJcbiAgICAgICAgaWYgKGZpbGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKGBcdTU3MjhcdTY1QjBcdTY4MDdcdTdCN0VcdTk4NzVcdTYyNTNcdTVGMDBgKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwibGlua1wiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgXHU1NzI4XHU0RUY2XHU3QkExXHU3NDA2XHU1NjY4XHU0RTJEXHU2NjNFXHU3OTNBYClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcImZvbGRlclwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZSA9IGZpbGVzWzBdOyAgLy8gXHU2NjNFXHU3OTNBXHU3QjJDXHU0RTAwXHU0RTJBXHU5MDA5XHU0RTJEXHU2NTg3XHU0RUY2XHU3Njg0XHU0RjREXHU3RjZFXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmV2ZWFsRm9sZGVySW5FeHBsb3JlcihmaWxlLnBhcmVudD8ucGF0aCB8fCAnLycpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgXHU3OUZCXHU1MkE4ICR7ZmlsZXMubGVuZ3RofSBcdTRFMkFcdTY1ODdcdTRFRjZgKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwibW92ZVwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRW5oYW5jZWRGaWxlU2VsZWN0aW9uTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNlbnRGb2xkZXJzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKGZvbGRlcnMpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY2VudEZvbGRlcnMgPSBmb2xkZXJzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKGBcdTUyMjBcdTk2NjQgJHtmaWxlcy5sZW5ndGh9IFx1NEUyQVx1NjU4N1x1NEVGNmApXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJ0cmFzaFwiKVxyXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29uZmlybSA9IGF3YWl0IG5ldyBDb25maXJtTW9kYWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiXHU3ODZFXHU4QkE0XHU1MjIwXHU5NjY0XCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBgXHU2NjJGXHU1NDI2XHU3ODZFXHU1QjlBXHU4OTgxXHU1MjIwXHU5NjY0XHU5MDA5XHU0RTJEXHU3Njg0ICR7ZmlsZXMubGVuZ3RofSBcdTRFMkFcdTY1ODdcdTRFRjZcdUZGMUZgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICkuc2hvdygpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbmZpcm0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LnRyYXNoKGZpbGUsIHRydWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoVmlldygpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbWVudS5zaG93QXRNb3VzZUV2ZW50KGV2ZW50KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTRGRUVcdTY1MzlcdThDMDNcdTY1NzRcdTUzNjFcdTcyNDdcdTU5MjdcdTVDMEZcdTc2ODRcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgYWRqdXN0Q2FyZFNpemUoZGVsdGE6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IGFkanVzdG1lbnQgPSBkZWx0YSA+IDAgPyAtMTAgOiAxMDtcclxuICAgICAgICBjb25zdCBuZXdTaXplID0gTWF0aC5tYXgoXHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1pbkNhcmRXaWR0aCxcclxuICAgICAgICAgICAgTWF0aC5taW4odGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4Q2FyZFdpZHRoLCB0aGlzLmNhcmRTaXplICsgYWRqdXN0bWVudClcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAobmV3U2l6ZSAhPT0gdGhpcy5jYXJkU2l6ZSkge1xyXG4gICAgICAgICAgICB0aGlzLmNhcmRTaXplID0gbmV3U2l6ZTtcclxuICAgICAgICAgICAgdGhpcy51cGRhdGVDYXJkU2l6ZShuZXdTaXplKTtcclxuICAgICAgICAgICAgLy8gXHU0RkREXHU1QjU4XHU2NUIwXHU3Njg0XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVDYXJkV2lkdGgobmV3U2l6ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NkRGQlx1NTJBMFx1NjZGNFx1NjVCMFx1NTM2MVx1NzI0N1x1NTkyN1x1NUMwRlx1NzY4NFx1NjVCOVx1NkNENVxyXG4gICAgcHVibGljIHVwZGF0ZUNhcmRTaXplKHdpZHRoOiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLmNhcmRTaXplID0gd2lkdGg7XHJcbiAgICAgICAgLy8gXHU2NkY0XHU2NUIwXHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU3Njg0XHU1QkJEXHU1RUE2XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm5vdGUtY2FyZCcpLmZvckVhY2goKGNhcmQ6IEVsZW1lbnQpID0+IHtcclxuICAgICAgICAgICAgaWYgKGNhcmQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgY2FyZC5zdHlsZS53aWR0aCA9IGAke3dpZHRofXB4YDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIC8vIFx1NjZGNFx1NjVCMFx1NUJCOVx1NTY2OFx1NzY4NFx1N0Y1MVx1NjgzQ1x1NTIxN1x1NUJCRFx1NUVBNlxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KGF1dG8tZmlsbCwgJHt3aWR0aH1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NTIxQlx1NUVGQVx1NjVFNVx1NTM4Nlx1NjMwOVx1OTRBRVxyXG4gICAgcHJpdmF0ZSBjcmVhdGVDYWxlbmRhckJ1dHRvbihsZWZ0VG9vbHM6IEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgY29uc3QgY2FsZW5kYXJCdG4gPSBsZWZ0VG9vbHMuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgY2xzOiAnY2FsZW5kYXItdG9nZ2xlLWJ1dHRvbicsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY2FsZW5kYXJCdG4uaW5uZXJIVE1MID0gYFxyXG4gICAgICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHJlY3QgeD1cIjNcIiB5PVwiNFwiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHJ4PVwiMlwiIHJ5PVwiMlwiPjwvcmVjdD48bGluZSB4MT1cIjE2XCIgeTE9XCIyXCIgeDI9XCIxNlwiIHkyPVwiNlwiPjwvbGluZT48bGluZSB4MT1cIjhcIiB5MT1cIjJcIiB4Mj1cIjhcIiB5Mj1cIjZcIj48L2xpbmU+PGxpbmUgeDE9XCIzXCIgeTE9XCIxMFwiIHgyPVwiMjFcIiB5Mj1cIjEwXCI+PC9saW5lPjwvc3ZnPlxyXG4gICAgICAgICAgICA8c3Bhbj5cdTY1RTVcdTUzODY8L3NwYW4+XHJcbiAgICAgICAgYDtcclxuICAgICAgICBjYWxlbmRhckJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy50b2dnbGVDYWxlbmRhcigpO1xyXG4gICAgICAgICAgICAvLyBcdTUyMDdcdTYzNjJcdTYzMDlcdTk0QUVcdTlBRDhcdTRFQUVcdTcyQjZcdTYwMDFcclxuICAgICAgICAgICAgY2FsZW5kYXJCdG4udG9nZ2xlQ2xhc3MoJ2FjdGl2ZScsIHRoaXMuaXNDYWxlbmRhclZpc2libGUpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NTIwN1x1NjM2Mlx1NjVFNVx1NTM4Nlx1NzY4NFx1NjYzRVx1NzkzQVx1NzJCNlx1NjAwMVxyXG4gICAgcHJpdmF0ZSB0b2dnbGVDYWxlbmRhcigpIHtcclxuICAgICAgICB0aGlzLmlzQ2FsZW5kYXJWaXNpYmxlID0gIXRoaXMuaXNDYWxlbmRhclZpc2libGU7XHJcbiAgICAgICAgaWYgKHRoaXMuaXNDYWxlbmRhclZpc2libGUpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93Q2FsZW5kYXIoKTtcclxuICAgICAgICAgICAgLy8gXHU2NjNFXHU3OTNBXHU1RjUzXHU1MjREXHU2NzA4XHU0RUZEXHU3Njg0XHU2MjQwXHU2NzA5XHU3QjE0XHU4QkIwXHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyTm90ZXNCeU1vbnRoKHRoaXMuY3VycmVudERhdGUpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuaGlkZUNhbGVuZGFyKCk7XHJcbiAgICAgICAgICAgIC8vIFx1NkUwNVx1OTY2NFx1NjVFNVx1NjcxRlx1OEZDN1x1NkVFNFxyXG4gICAgICAgICAgICB0aGlzLmNsZWFyRGF0ZUZpbHRlcigpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTYzMDlcdTY3MDhcdTRFRkRcdThGQzdcdTZFRTRcdTc2ODRcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgZmlsdGVyTm90ZXNCeU1vbnRoKGRhdGU6IERhdGUpIHtcclxuICAgICAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgIGNvbnN0IG1vbnRoID0gZGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbHRlciA9IHsgXHJcbiAgICAgICAgICAgIHR5cGU6ICdkYXRlJywgXHJcbiAgICAgICAgICAgIHZhbHVlOiBgJHt5ZWFyfS0keyhtb250aCArIDEpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gIFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5yZWZyZXNoVmlldygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NjYzRVx1NzkzQVx1NjVFNVx1NTM4NlxyXG4gICAgcHJpdmF0ZSBzaG93Q2FsZW5kYXIoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmNhbGVuZGFyQ29udGFpbmVyKSB7XHJcbiAgICAgICAgICAgIC8vIFx1NEZFRVx1NjUzOVx1RkYxQVx1NUMwNlx1NjVFNVx1NTM4Nlx1NUJCOVx1NTY2OFx1NkRGQlx1NTJBMFx1NTIzMCBjb250ZW50LXNlY3Rpb24gXHU0RTRCXHU1MjREXHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRTZWN0aW9uID0gdGhpcy5jb250YWluZXJFbC5xdWVyeVNlbGVjdG9yKCcuY29udGVudC1zZWN0aW9uJyk7XHJcbiAgICAgICAgICAgIGlmICghY29udGVudFNlY3Rpb24pIHJldHVybjtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTcyOCBjb250ZW50LXNlY3Rpb24gXHU0RTRCXHU1MjREXHU2M0QyXHU1MTY1XHU2NUU1XHU1Mzg2XHU1QkI5XHU1NjY4XHJcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJDb250YWluZXIgPSBjcmVhdGVEaXYoJ2NhbGVuZGFyLWNvbnRhaW5lcicpO1xyXG4gICAgICAgICAgICBjb250ZW50U2VjdGlvbi5wYXJlbnRFbGVtZW50Py5pbnNlcnRCZWZvcmUodGhpcy5jYWxlbmRhckNvbnRhaW5lciwgY29udGVudFNlY3Rpb24pO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgdGhpcy5yZW5kZXJDYWxlbmRhcigpO1xyXG4gICAgICAgIHRoaXMuY2FsZW5kYXJDb250YWluZXIuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU0RkVFXHU2NTM5XHVGRjFBXHU1QzA2IHdpdGgtY2FsZW5kYXIgXHU3QzdCXHU2REZCXHU1MkEwXHU1MjMwIG1haW4tbGF5b3V0XHJcbiAgICAgICAgY29uc3QgbWFpbkxheW91dCA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm1haW4tbGF5b3V0Jyk7XHJcbiAgICAgICAgaWYgKG1haW5MYXlvdXQpIHtcclxuICAgICAgICAgICAgbWFpbkxheW91dC5hZGRDbGFzcygnd2l0aC1jYWxlbmRhcicpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTk2OTBcdTg1Q0ZcdTY1RTVcdTUzODYgXHJcbiAgICBwcml2YXRlIGhpZGVDYWxlbmRhcigpIHtcclxuICAgICAgICBpZiAodGhpcy5jYWxlbmRhckNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XHJcbiAgICAgICAgICAgIHRoaXMuY2FsZW5kYXJDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NEZFRVx1NjUzOVx1RkYxQVx1NEVDRSBtYWluLWxheW91dCBcdTc5RkJcdTk2NjQgd2l0aC1jYWxlbmRhciBcdTdDN0JcclxuICAgICAgICAgICAgY29uc3QgbWFpbkxheW91dCA9IHRoaXMuY29udGFpbmVyRWwucXVlcnlTZWxlY3RvcignLm1haW4tbGF5b3V0Jyk7XHJcbiAgICAgICAgICAgIGlmIChtYWluTGF5b3V0KSB7XHJcbiAgICAgICAgICAgICAgICBtYWluTGF5b3V0LnJlbW92ZUNsYXNzKCd3aXRoLWNhbGVuZGFyJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2RTMyXHU2N0QzXHU2NUU1XHU1Mzg2XHJcbiAgICBwcml2YXRlIHJlbmRlckNhbGVuZGFyKCkge1xyXG4gICAgICAgIGlmICghdGhpcy5jYWxlbmRhckNvbnRhaW5lcikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuY2FsZW5kYXJDb250YWluZXIuZW1wdHkoKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCB5ZWFyID0gdGhpcy5jdXJyZW50RGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgIGNvbnN0IG1vbnRoID0gdGhpcy5jdXJyZW50RGF0ZS5nZXRNb250aCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjVFNVx1NTM4Nlx1NTkzNFx1OTBFOFxyXG4gICAgICAgIGNvbnN0IGhlYWRlciA9IHRoaXMuY2FsZW5kYXJDb250YWluZXIuY3JlYXRlRGl2KCdjYWxlbmRhci1oZWFkZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTRFMEFcdTRFMkFcdTY3MDhcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBwcmV2QnRuID0gaGVhZGVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IGNsczogJ2NhbGVuZGFyLW5hdi1idG4nIH0pO1xyXG4gICAgICAgIHByZXZCdG4uaW5uZXJIVE1MID0gJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cG9seWxpbmUgcG9pbnRzPVwiMTUgMTggOSAxMiAxNSA2XCI+PC9wb2x5bGluZT48L3N2Zz4nO1xyXG4gICAgICAgIHByZXZCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnREYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGggLSAxLCAxKTtcclxuICAgICAgICAgICAgdGhpcy5yZW5kZXJDYWxlbmRhcigpO1xyXG4gICAgICAgICAgICAvLyBcdTY2M0VcdTc5M0FcdTY1QjBcdTY3MDhcdTRFRkRcdTc2ODRcdTdCMTRcdThCQjBcclxuICAgICAgICAgICAgdGhpcy5maWx0ZXJOb3Rlc0J5TW9udGgodGhpcy5jdXJyZW50RGF0ZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU2NjNFXHU3OTNBXHU1RTc0XHU2NzA4XHJcbiAgICAgICAgaGVhZGVyLmNyZWF0ZURpdignY2FsZW5kYXItdGl0bGUnKS5zZXRUZXh0KFxyXG4gICAgICAgICAgICBgJHt5ZWFyfVx1NUU3NCR7bW9udGggKyAxfVx1NjcwOGBcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NEUwQlx1NEUyQVx1NjcwOFx1NjMwOVx1OTRBRVxyXG4gICAgICAgIGNvbnN0IG5leHRCdG4gPSBoZWFkZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgY2xzOiAnY2FsZW5kYXItbmF2LWJ0bicgfSk7XHJcbiAgICAgICAgbmV4dEJ0bi5pbm5lckhUTUwgPSAnPHN2ZyB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgd2lkdGg9XCIxNlwiIGhlaWdodD1cIjE2XCIgdmlld0JveD1cIjAgMCAyNCAyNFwiIGZpbGw9XCJub25lXCIgc3Ryb2tlPVwiY3VycmVudENvbG9yXCIgc3Ryb2tlLXdpZHRoPVwiMlwiIHN0cm9rZS1saW5lY2FwPVwicm91bmRcIiBzdHJva2UtbGluZWpvaW49XCJyb3VuZFwiPjxwb2x5bGluZSBwb2ludHM9XCI5IDE4IDE1IDEyIDkgNlwiPjwvcG9seWxpbmU+PC9zdmc+JztcclxuICAgICAgICBuZXh0QnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50RGF0ZSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoICsgMSwgMSk7XHJcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQ2FsZW5kYXIoKTtcclxuICAgICAgICAgICAgLy8gXHU2NjNFXHU3OTNBXHU2NUIwXHU2NzA4XHU0RUZEXHU3Njg0XHU3QjE0XHU4QkIwXHJcbiAgICAgICAgICAgIHRoaXMuZmlsdGVyTm90ZXNCeU1vbnRoKHRoaXMuY3VycmVudERhdGUpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTY2MUZcdTU5MzRcdTkwRThcclxuICAgICAgICBjb25zdCB3ZWVrZGF5cyA9IFsnXHU2NUU1JywgJ1x1NEUwMCcsICdcdTRFOEMnLCAnXHU0RTA5JywgJ1x1NTZEQicsICdcdTRFOTQnLCAnXHU1MTZEJ107XHJcbiAgICAgICAgY29uc3Qgd2Vla0hlYWRlciA9IHRoaXMuY2FsZW5kYXJDb250YWluZXIuY3JlYXRlRGl2KCdjYWxlbmRhci13ZWVrZGF5cycpO1xyXG4gICAgICAgIHdlZWtkYXlzLmZvckVhY2goZGF5ID0+IHtcclxuICAgICAgICAgICAgd2Vla0hlYWRlci5jcmVhdGVEaXYoJ3dlZWtkYXknKS5zZXRUZXh0KGRheSk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjVFNVx1NjcxRlx1N0Y1MVx1NjgzQ1xyXG4gICAgICAgIGNvbnN0IGdyaWQgPSB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLmNyZWF0ZURpdignY2FsZW5kYXItZ3JpZCcpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NUY1M1x1NjcwOFx1N0IyQ1x1NEUwMFx1NTkyOVx1NjYyRlx1NjYxRlx1NjcxRlx1NTFFMFxyXG4gICAgICAgIGNvbnN0IGZpcnN0RGF5ID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDEpLmdldERheSgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NUY1M1x1NjcwOFx1NTkyOVx1NjU3MFxyXG4gICAgICAgIGNvbnN0IGRheXNJbk1vbnRoID0gbmV3IERhdGUoeWVhciwgbW9udGggKyAxLCAwKS5nZXREYXRlKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU2QkNGXHU1OTI5XHU3Njg0XHU3QjE0XHU4QkIwXHU2NTcwXHU5MUNGXHJcbiAgICAgICAgY29uc3Qgbm90ZXNDb3VudCA9IHRoaXMuZ2V0Tm90ZXNDb3VudEJ5RGF0ZSh5ZWFyLCBtb250aCk7XHJcblxyXG4gICAgICAgIC8vIFx1NTg2Qlx1NTE0NVx1NjVFNVx1NjcxRlx1NjgzQ1x1NUI1MFxyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmlyc3REYXk7IGkrKykge1xyXG4gICAgICAgICAgICBncmlkLmNyZWF0ZURpdignY2FsZW5kYXItZGF5IGVtcHR5Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKGxldCBkYXkgPSAxOyBkYXkgPD0gZGF5c0luTW9udGg7IGRheSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRheUVsID0gZ3JpZC5jcmVhdGVEaXYoJ2NhbGVuZGFyLWRheScpO1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlU3RyID0gYCR7eWVhcn0tJHsobW9udGggKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyl9LSR7ZGF5LnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgZGF5RWwuc2V0VGV4dChkYXkudG9TdHJpbmcoKSk7XHJcbiAgICAgICAgICAgIGRheUVsLnNldEF0dHJpYnV0ZSgnZGF0YS1kYXRlJywgZGF0ZVN0cik7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTY2MkZcdTVGNTNcdTUyNERcdThGQzdcdTZFRTRcdTc2ODRcdTY1RTVcdTY3MUZcdUZGMENcdTZERkJcdTUyQTBcdTkwMDlcdTRFMkRcdTY4MzdcdTVGMEZcclxuICAgICAgICAgICAgaWYgKHRoaXMuY3VycmVudEZpbHRlci50eXBlID09PSAnZGF0ZScgJiYgdGhpcy5jdXJyZW50RmlsdGVyLnZhbHVlID09PSBkYXRlU3RyKSB7XHJcbiAgICAgICAgICAgICAgICBkYXlFbC5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU3QjE0XHU4QkIwXHU2NTcwXHU5MUNGXHU2ODA3XHU4QkIwXHJcbiAgICAgICAgICAgIGNvbnN0IGNvdW50ID0gbm90ZXNDb3VudFtkYXRlU3RyXSB8fCAwO1xyXG4gICAgICAgICAgICBpZiAoY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBkYXlFbC5jcmVhdGVEaXYoJ25vdGUtY291bnQnKS5zZXRUZXh0KGNvdW50LnRvU3RyaW5nKCkpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTcwQjlcdTUxRkJcdTRFOEJcdTRFRjZcclxuICAgICAgICAgICAgZGF5RWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmZpbHRlck5vdGVzQnlEYXRlKGRhdGVTdHIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU4M0I3XHU1M0Q2XHU2QkNGXHU1OTI5XHU3Njg0XHU3QjE0XHU4QkIwXHU2NTcwXHU5MUNGXHJcbiAgICBwcml2YXRlIGdldE5vdGVzQ291bnRCeURhdGUoeWVhcjogbnVtYmVyLCBtb250aDogbnVtYmVyKTogUmVjb3JkPHN0cmluZywgbnVtYmVyPiB7XHJcbiAgICAgICAgY29uc3QgY291bnRzOiBSZWNvcmQ8c3RyaW5nLCBudW1iZXI+ID0ge307XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcblxyXG4gICAgICAgIGZpbGVzLmZvckVhY2goZmlsZSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShmaWxlLnN0YXQubXRpbWUpO1xyXG4gICAgICAgICAgICBpZiAoZGF0ZS5nZXRGdWxsWWVhcigpID09PSB5ZWFyICYmIGRhdGUuZ2V0TW9udGgoKSA9PT0gbW9udGgpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGRhdGVTdHIgPSBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXTtcclxuICAgICAgICAgICAgICAgIGNvdW50c1tkYXRlU3RyXSA9IChjb3VudHNbZGF0ZVN0cl0gfHwgMCkgKyAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHJldHVybiBjb3VudHM7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2ODM5XHU2MzZFXHU2NUU1XHU2NzFGXHU4RkM3XHU2RUU0XHU3QjE0XHU4QkIwXHJcbiAgICBwcml2YXRlIGZpbHRlck5vdGVzQnlEYXRlKGRhdGVTdHI6IHN0cmluZykge1xyXG4gICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NURGMlx1N0VDRlx1OTAwOVx1NEUyRFx1NEU4Nlx1OEZEOVx1NEUyQVx1NjVFNVx1NjcxRlx1RkYwQ1x1NTIxOVx1NkUwNVx1OTY2NFx1OEZDN1x1NkVFNFxyXG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRGaWx0ZXIudHlwZSA9PT0gJ2RhdGUnICYmIHRoaXMuY3VycmVudEZpbHRlci52YWx1ZSA9PT0gZGF0ZVN0cikge1xyXG4gICAgICAgICAgICB0aGlzLmNsZWFyRGF0ZUZpbHRlcigpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBcdTZFMDVcdTk2NjRcdTUxNzZcdTRFRDZcdTY1RTVcdTY3MUZcdTc2ODRcdTkwMDlcdTRFMkRcdTcyQjZcdTYwMDFcclxuICAgICAgICB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jYWxlbmRhci1kYXknKS5mb3JFYWNoKGRheSA9PiB7XHJcbiAgICAgICAgICAgIGRheS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU4QkJFXHU3RjZFXHU2NUIwXHU3Njg0XHU4RkM3XHU2RUU0XHU2NzYxXHU0RUY2XHJcbiAgICAgICAgdGhpcy5jdXJyZW50RmlsdGVyID0geyB0eXBlOiAnZGF0ZScsIHZhbHVlOiBkYXRlU3RyIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU5QUQ4XHU0RUFFXHU5MDA5XHU0RTJEXHU3Njg0XHU2NUU1XHU2NzFGXHJcbiAgICAgICAgY29uc3Qgc2VsZWN0ZWREYXkgPSB0aGlzLmNhbGVuZGFyQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYC5jYWxlbmRhci1kYXlbZGF0YS1kYXRlPVwiJHtkYXRlU3RyfVwiXWApO1xyXG4gICAgICAgIGlmIChzZWxlY3RlZERheSkge1xyXG4gICAgICAgICAgICBzZWxlY3RlZERheS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTZFMDVcdTk2NjRcdTY1RTVcdTY3MUZcdThGQzdcdTZFRTRcdTc2ODRcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgY2xlYXJEYXRlRmlsdGVyKCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudEZpbHRlciA9IHsgdHlwZTogJ25vbmUnIH07XHJcbiAgICAgICAgLy8gXHU2RTA1XHU5NjY0XHU2MjQwXHU2NzA5XHU2NUU1XHU2NzFGXHU3Njg0XHU5MDA5XHU0RTJEXHU3MkI2XHU2MDAxXHJcbiAgICAgICAgaWYgKHRoaXMuY2FsZW5kYXJDb250YWluZXIpIHtcclxuICAgICAgICAgICAgdGhpcy5jYWxlbmRhckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuY2FsZW5kYXItZGF5JykuZm9yRWFjaChkYXkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZGF5LnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLy8gXHU1MjM3XHU2NUIwXHU4OUM2XHU1NkZFXHU0RUU1XHU2NjNFXHU3OTNBXHU2MjQwXHU2NzA5XHU3QjE0XHU4QkIwXHJcbiAgICAgICAgdGhpcy5yZWZyZXNoVmlldygpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1OUFEOFx1NEVBRVx1NjQxQ1x1N0QyMlx1OEJDRFxyXG4gICAgcHJpdmF0ZSBoaWdobGlnaHRTZWFyY2hUZXJtKGNvbnRlbnQ6IHN0cmluZywgc2VhcmNoVGVybTogc3RyaW5nKTogc3RyaW5nIHtcclxuICAgICAgICBpZiAoIXNlYXJjaFRlcm0pIHJldHVybiBjb250ZW50O1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChzZWFyY2hUZXJtLCAnZ2knKTtcclxuICAgICAgICByZXR1cm4gY29udGVudC5yZXBsYWNlKHJlZ2V4LCBtYXRjaCA9PiBgPHNwYW4gY2xhc3M9XCJzZWFyY2gtaGlnaGxpZ2h0XCI+JHttYXRjaH08L3NwYW4+YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU0RkVFXHU2NTM5XHU2NUI5XHU2Q0Q1XHU1NDBEXHU0RUU1XHU2NkY0XHU1OTdEXHU1NzMwXHU1M0NEXHU2NjIwXHU1MTc2XHU1MjlGXHU4MEZEXHJcbiAgICBwcml2YXRlIGFzeW5jIG9wZW5JbkFwcHJvcHJpYXRlTGVhZihmaWxlOiBURmlsZSkge1xyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjI0MFx1NjcwOVx1NTNFRlx1ODlDMVx1NzY4NCBtYXJrZG93biBcdTdDN0JcdTU3OEJcdTc2ODRcdTUzRjZcdTVCNTBcclxuICAgICAgICBjb25zdCBsZWF2ZXMgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdtYXJrZG93bicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NUY1M1x1NTI0RFx1NTM2MVx1NzI0N1x1ODlDNlx1NTZGRVx1NjI0MFx1NTcyOFx1NzY4NFx1NjgzOVx1NTIwNlx1NUM0RlxyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRSb290ID0gdGhpcy5sZWFmLmdldFJvb3QoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTYyN0VcdTUyMzBcdTRFMERcdTU3MjhcdTVGNTNcdTUyNERcdTY4MzlcdTUyMDZcdTVDNEZcdTRFMEJcdTc2ODRcdTUzRjZcdTVCNTBcclxuICAgICAgICBjb25zdCBvdGhlckxlYWYgPSBsZWF2ZXMuZmluZChsZWFmID0+IHtcclxuICAgICAgICAgICAgY29uc3Qgcm9vdCA9IGxlYWYuZ2V0Um9vdCgpO1xyXG4gICAgICAgICAgICByZXR1cm4gcm9vdCAhPT0gY3VycmVudFJvb3Q7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKG90aGVyTGVhZikge1xyXG4gICAgICAgICAgICAvLyBcdTU5ODJcdTY3OUNcdTYyN0VcdTUyMzBcdTUxNzZcdTRFRDZcdTUyMDZcdTVDNEZcdTc2ODRcdTUzRjZcdTVCNTBcdUZGMENcdTU3MjhcdTkwQTNcdTkxQ0NcdTYyNTNcdTVGMDBcdTY1ODdcdTRFRjZcclxuICAgICAgICAgICAgYXdhaXQgb3RoZXJMZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2Uuc2V0QWN0aXZlTGVhZihvdGhlckxlYWYpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NkNBMVx1NjcwOVx1NjI3RVx1NTIzMFx1NTE3Nlx1NEVENlx1NTIwNlx1NUM0Rlx1NzY4NFx1NTNGNlx1NUI1MFx1RkYwQ1x1NTcyOFx1NUY1M1x1NTI0RFx1NTIwNlx1NUM0Rlx1NTIxQlx1NUVGQVx1NjVCMFx1NjgwN1x1N0I3RVx1OTg3NVxyXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZFMzJcdTY3RDNcdTY1ODdcdTRFRjZcdTU5MzlcdTUzNjFcdTcyNDdcclxuICAgIHByaXZhdGUgcmVuZGVyRm9sZGVyQ2FyZChmb2xkZXI6IFRGb2xkZXIpOiBIVE1MRWxlbWVudCB7XHJcbiAgICAgICAgY29uc3QgY2FyZEVsID0gY3JlYXRlRGl2KCdjYXJkIGZvbGRlci1jYXJkJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gLi4uIFx1NzNCMFx1NjcwOVx1NzY4NFx1NjU4N1x1NEVGNlx1NTkzOVx1NTM2MVx1NzI0N1x1NkUzMlx1NjdEM1x1NEVFM1x1NzgwMSAuLi5cclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTcwQjlcdTUxRkJcdTRFOEJcdTRFRjZcdTU5MDRcdTc0MDZcclxuICAgICAgICBjYXJkRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFx1ODlDNlx1NTZGRVxyXG4gICAgICAgICAgICBjb25zdCBmaWxlRXhwbG9yZXIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdmaWxlLWV4cGxvcmVyJylbMF07XHJcbiAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIFx1NkZDMFx1NkQzQlx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFx1ODlDNlx1NTZGRVxyXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAud29ya3NwYWNlLnJldmVhbExlYWYoZmlsZUV4cGxvcmVyKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU2NTg3XHU0RUY2XHU2RDRGXHU4OUM4XHU1NjY4XHU4OUM2XHU1NkZFXHU1QjlFXHU0RjhCXHJcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlRXhwbG9yZXJWaWV3ID0gZmlsZUV4cGxvcmVyLnZpZXcgYXMgYW55O1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHBsb3JlclZpZXcgJiYgZmlsZUV4cGxvcmVyVmlldy5yZXZlYWxJbkZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NTcyOFx1NjU4N1x1NEVGNlx1NkQ0Rlx1ODlDOFx1NTY2OFx1NEUyRFx1NUI5QVx1NEY0RFx1NUU3Nlx1OUFEOFx1NEVBRVx1NjYzRVx1NzkzQVx1OEJFNVx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVFeHBsb3JlclZpZXcucmV2ZWFsSW5Gb2xkZXIoZm9sZGVyKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBjYXJkRWw7XHJcbiAgICB9XHJcbn1cclxuXHJcbi8vIFx1NkRGQlx1NTJBMFx1NjU4N1x1NEVGNlx1OTAwOVx1NjJFOVx1NkEyMVx1NjAwMVx1Njg0NlxyXG5jbGFzcyBGaWxlU2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWxlOiBURmlsZSkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1x1OTAwOVx1NjJFOVx1NzZFRVx1NjgwN1x1NjU4N1x1NEVGNlx1NTkzOScgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGZvbGRlckxpc3QgPSBjb250ZW50RWwuY3JlYXRlRGl2KCdmb2xkZXItbGlzdCcpO1xyXG4gICAgICAgIGNvbnN0IGZvbGRlcnMgPSB0aGlzLmdldEZvbGRlcnMoKTtcclxuXHJcbiAgICAgICAgZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBmb2xkZXJMaXN0LmNyZWF0ZURpdignZm9sZGVyLWl0ZW0nKTtcclxuICAgICAgICAgICAgaXRlbS5zZXRUZXh0KGZvbGRlcik7XHJcbiAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm1vdmVGaWxlKGZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Rm9sZGVycygpOiBzdHJpbmdbXSB7XHJcbiAgICAgICAgY29uc3QgZm9sZGVycyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCkuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBmb2xkZXJzLmFkZChmaWxlLnBhdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oZm9sZGVycyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBtb3ZlRmlsZSh0YXJnZXRGb2xkZXI6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IG5ld1BhdGggPSBgJHt0YXJnZXRGb2xkZXJ9LyR7dGhpcy5maWxlLm5hbWV9YDtcclxuICAgICAgICBhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKHRoaXMuZmlsZSwgbmV3UGF0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gXHU2REZCXHU1MkEwXHU3ODZFXHU4QkE0XHU1QkY5XHU4QkREXHU2ODQ2XHJcbmNsYXNzIENvbmZpcm1Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgcmVzdWx0OiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIHJlc29sdmVQcm9taXNlOiAodmFsdWU6IGJvb2xlYW4pID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIHRpdGxlOiBzdHJpbmc7XHJcbiAgICBwcml2YXRlIG1lc3NhZ2U6IHN0cmluZztcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgdGl0bGU6IHN0cmluZywgbWVzc2FnZTogc3RyaW5nKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLnRpdGxlID0gdGl0bGU7XHJcbiAgICAgICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzaG93KCk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcclxuICAgICAgICAgICAgdGhpcy5vcGVuKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDMnLCB7IHRleHQ6IHRoaXMudGl0bGUgfSk7XHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdwJywgeyB0ZXh0OiB0aGlzLm1lc3NhZ2UgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ2J1dHRvbi1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjb25maXJtQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7IHRleHQ6ICdcdTc4NkVcdThCQTQnIH0pO1xyXG4gICAgICAgIGNvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ1x1NTNENlx1NkQ4OCcgfSk7XHJcbiAgICAgICAgY2FuY2VsQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnJlc3VsdCA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25DbG9zZSgpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuZW1wdHkoKTtcclxuICAgICAgICB0aGlzLnJlc29sdmVQcm9taXNlKHRoaXMucmVzdWx0KTtcclxuICAgIH1cclxufVxyXG5cclxuLy8gXHU0RkVFXHU2NTM5XHU1ODlFXHU1RjNBXHU3Njg0XHU2NTg3XHU0RUY2XHU5MDA5XHU2MkU5XHU2QTIxXHU2MDAxXHU2ODQ2XHJcbmNsYXNzIEVuaGFuY2VkRmlsZVNlbGVjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcHJpdmF0ZSBmaWxlczogVEZpbGVbXTtcclxuICAgIHByaXZhdGUgcmVjZW50Rm9sZGVyczogc3RyaW5nW107XHJcbiAgICBwcml2YXRlIG9uRm9sZGVyc1VwZGF0ZTogKGZvbGRlcnM6IHN0cmluZ1tdKSA9PiB2b2lkO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RlZEZvbGRlcjogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgYXBwOiBBcHAsXHJcbiAgICAgICAgZmlsZXM6IFRGaWxlW10sXHJcbiAgICAgICAgcmVjZW50Rm9sZGVyczogc3RyaW5nW10sXHJcbiAgICAgICAgb25Gb2xkZXJzVXBkYXRlOiAoZm9sZGVyczogc3RyaW5nW10pID0+IHZvaWRcclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKGFwcCk7XHJcbiAgICAgICAgdGhpcy5maWxlcyA9IGZpbGVzO1xyXG4gICAgICAgIHRoaXMucmVjZW50Rm9sZGVycyA9IHJlY2VudEZvbGRlcnM7XHJcbiAgICAgICAgdGhpcy5vbkZvbGRlcnNVcGRhdGUgPSBvbkZvbGRlcnNVcGRhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgb25PcGVuKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG5cclxuICAgICAgICAvLyBcdTY4MDdcdTk4OThcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyBcclxuICAgICAgICAgICAgdGV4dDogYFx1NzlGQlx1NTJBOCAke3RoaXMuZmlsZXMubGVuZ3RofSBcdTRFMkFcdTY1ODdcdTRFRjZgIFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTY3MDBcdThGRDFcdTRGN0ZcdTc1MjhcdTc2ODRcdTY1ODdcdTRFRjZcdTU5MzlcclxuICAgICAgICBpZiAodGhpcy5yZWNlbnRGb2xkZXJzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcmVjZW50U2VjdGlvbiA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ3JlY2VudC1mb2xkZXJzLXNlY3Rpb24nKTtcclxuICAgICAgICAgICAgcmVjZW50U2VjdGlvbi5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdcdTY3MDBcdTRGN0ZcdTc1MjgnIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3QgcmVjZW50TGlzdCA9IHJlY2VudFNlY3Rpb24uY3JlYXRlRGl2KCdyZWNlbnQtZm9sZGVycy1saXN0Jyk7XHJcbiAgICAgICAgICAgIHRoaXMucmVjZW50Rm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gcmVjZW50TGlzdC5jcmVhdGVEaXYoJ2ZvbGRlci1pdGVtIHJlY2VudCcpO1xyXG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUZXh0KGZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5zZWxlY3RGb2xkZXIoaXRlbSwgZm9sZGVyKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gXHU2MjQwXHU2NzA5XHU2NTg3XHU0RUY2XHU1OTM5XHU1MjE3XHU4ODY4XHJcbiAgICAgICAgY29uc3QgZm9sZGVyTGlzdCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ2ZvbGRlci1saXN0Jyk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVycyA9IHRoaXMuZ2V0Rm9sZGVyc1dpdGhIaWVyYXJjaHkoKTtcclxuICAgICAgICB0aGlzLmNyZWF0ZUZvbGRlclRyZWUoZm9sZGVyTGlzdCwgZm9sZGVycyk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NjRDRFx1NEY1Q1x1NjMwOVx1OTRBRVxyXG4gICAgICAgIGNvbnN0IGJ1dHRvbkNvbnRhaW5lciA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ21vZGFsLWJ1dHRvbi1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICBjb25zdCBjb25maXJtQnV0dG9uID0gYnV0dG9uQ29udGFpbmVyLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIHRleHQ6ICdcdTc4NkVcdThCQTRcdTc5RkJcdTUyQTgnLFxyXG4gICAgICAgICAgICBjbHM6ICdtb2QtY3RhJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnNlbGVjdGVkRm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVGaWxlcyh0aGlzLnNlbGVjdGVkRm9sZGVyKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ1x1NTNENlx1NkQ4OCdcclxuICAgICAgICB9KTtcclxuICAgICAgICBjYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZ2V0Rm9sZGVyc1dpdGhIaWVyYXJjaHkoKTogRm9sZGVySXRlbVtdIHtcclxuICAgICAgICBjb25zdCBmb2xkZXJzOiBGb2xkZXJJdGVtW10gPSBbXTtcclxuICAgICAgICBjb25zdCBzZWVuID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcblxyXG4gICAgICAgIHRoaXMuYXBwLnZhdWx0LmdldEFsbExvYWRlZEZpbGVzKCkuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBwYXJ0cyA9IGZpbGUucGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXRoID0gJyc7XHJcbiAgICAgICAgICAgICAgICBsZXQgbGV2ZWwgPSAwO1xyXG5cclxuICAgICAgICAgICAgICAgIHBhcnRzLmZvckVhY2gocGFydCA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhdGggKz0gKGN1cnJlbnRQYXRoID8gJy8nIDogJycpICsgcGFydDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFzZWVuLmhhcyhjdXJyZW50UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlZW4uYWRkKGN1cnJlbnRQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvbGRlcnMucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcGF0aDogY3VycmVudFBhdGgsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogcGFydCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXZlbDogbGV2ZWxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsKys7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZvbGRlcnMuc29ydCgoYSwgYikgPT4gYS5wYXRoLmxvY2FsZUNvbXBhcmUoYi5wYXRoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBjcmVhdGVGb2xkZXJUcmVlKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGZvbGRlcnM6IEZvbGRlckl0ZW1bXSkge1xyXG4gICAgICAgIGZvbGRlcnMuZm9yRWFjaChmb2xkZXIgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpdGVtID0gY29udGFpbmVyLmNyZWF0ZURpdih7XHJcbiAgICAgICAgICAgICAgICBjbHM6ICdmb2xkZXItaXRlbSdcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTdGMjlcdThGREJcclxuICAgICAgICAgICAgaXRlbS5zdHlsZS5wYWRkaW5nTGVmdCA9IGAke2ZvbGRlci5sZXZlbCAqIDIwICsgMTB9cHhgO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2NTg3XHU0RUY2XHU1OTM5XHU1NkZFXHU2ODA3XHJcbiAgICAgICAgICAgIGNvbnN0IGljb24gPSBpdGVtLmNyZWF0ZVNwYW4oe1xyXG4gICAgICAgICAgICAgICAgY2xzOiAnZm9sZGVyLWljb24nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpY29uLmlubmVySFRNTCA9IGA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE2XCIgaGVpZ2h0PVwiMTZcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHBhdGggZD1cIk0yMiAxOWEyIDIgMCAwIDEtMiAySDRhMiAyIDAgMCAxLTItMlY1YTIgMiAwIDAgMSAyLTJoNWwyIDNoOWEyIDIgMCAwIDEgMiAyelwiPjwvcGF0aD48L3N2Zz5gO1xyXG5cclxuICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2NTg3XHU0RUY2XHU1OTM5XHU1NDBEXHU3OUYwXHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBpdGVtLmNyZWF0ZVNwYW4oe1xyXG4gICAgICAgICAgICAgICAgY2xzOiAnZm9sZGVyLW5hbWUnLFxyXG4gICAgICAgICAgICAgICAgdGV4dDogZm9sZGVyLm5hbWVcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5zZWxlY3RGb2xkZXIoaXRlbSwgZm9sZGVyLnBhdGgpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIHNlbGVjdEZvbGRlcihlbGVtZW50OiBIVE1MRWxlbWVudCwgcGF0aDogc3RyaW5nKSB7XHJcbiAgICAgICAgLy8gXHU3OUZCXHU5NjY0XHU1MTc2XHU0RUQ2XHU5MDA5XHU0RTJEXHU3MkI2XHU2MDAxXHJcbiAgICAgICAgdGhpcy5jb250ZW50RWwucXVlcnlTZWxlY3RvckFsbCgnLmZvbGRlci1pdGVtJykuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgaXRlbS5yZW1vdmVDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU5MDA5XHU0RTJEXHU3MkI2XHU2MDAxXHJcbiAgICAgICAgZWxlbWVudC5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcclxuICAgICAgICB0aGlzLnNlbGVjdGVkRm9sZGVyID0gcGF0aDtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIG1vdmVGaWxlcyh0YXJnZXRGb2xkZXI6IHN0cmluZykge1xyXG4gICAgICAgIGNvbnN0IGNvbmZpcm1Nb2RhbCA9IG5ldyBDb25maXJtTW9kYWwoXHJcbiAgICAgICAgICAgIHRoaXMuYXBwLFxyXG4gICAgICAgICAgICBcIlx1Nzg2RVx1OEJBNFx1NzlGQlx1NTJBOFwiLFxyXG4gICAgICAgICAgICBgXHU2NjJGXHU1NDI2XHU1QzA2XHU5MDA5XHU0RTJEXHU3Njg0ICR7dGhpcy5maWxlcy5sZW5ndGh9IFx1NEUyQVx1NjU4N1x1NEVGNlx1NzlGQlx1NTJBOFx1NTIzMCBcIiR7dGFyZ2V0Rm9sZGVyfVwiXHVGRjFGYFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmIChhd2FpdCBjb25maXJtTW9kYWwuc2hvdygpKSB7XHJcbiAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiB0aGlzLmZpbGVzKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdQYXRoID0gYCR7dGFyZ2V0Rm9sZGVyfS8ke2ZpbGUubmFtZX1gO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZShmaWxlLCBuZXdQYXRoKTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gXHU2NkY0XHU2NUIwXHU2NzAwXHU4RkQxXHU0RjdGXHU3NTI4XHU3Njg0XHU2NTg3XHU0RUY2XHU1OTM5XHJcbiAgICAgICAgICAgIHRoaXMucmVjZW50Rm9sZGVycyA9IFt0YXJnZXRGb2xkZXIsIC4uLnRoaXMucmVjZW50Rm9sZGVycy5maWx0ZXIoZiA9PiBmICE9PSB0YXJnZXRGb2xkZXIpXVxyXG4gICAgICAgICAgICAgICAgLnNsaWNlKDAsIDUpO1xyXG4gICAgICAgICAgICB0aGlzLm9uRm9sZGVyc1VwZGF0ZSh0aGlzLnJlY2VudEZvbGRlcnMpO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufVxyXG5cclxuLy8gXHU2REZCXHU1MkEwXHU2NTg3XHU0RUY2XHU1OTM5XHU5ODc5XHU2M0E1XHU1M0UzXHJcbmludGVyZmFjZSBGb2xkZXJJdGVtIHtcclxuICAgIHBhdGg6IHN0cmluZztcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIGxldmVsOiBudW1iZXI7XHJcbn0gIl0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUEsdUJBQXFGOzs7QUNBckYsc0JBVU87QUFHQSxJQUFNLGlCQUFpQjtBQUV2Qiw2QkFBdUIseUJBQVM7QUFBQSxFQTZCbkMsWUFBWSxNQUFxQixRQUF3QjtBQUNyRCxVQUFNO0FBdEJGLDhCQUE4QjtBQUM5Qix5QkFBK0I7QUFFL0IsNkJBQTRCO0FBQzVCLHdCQUE0QixJQUFJO0FBQ2hDLHlCQUE2QixJQUFJO0FBQ2pDLDRCQUFrQztBQUNsQyx5QkFBMEI7QUFDMUIsb0JBQW1CO0FBQ1YseUJBQWdCO0FBQ2hCLHlCQUFnQjtBQUV6Qiw2QkFBNkI7QUFDN0IsdUJBQW9CLElBQUk7QUFDeEIseUJBQTJELEVBQUUsTUFBTTtBQVN2RSxTQUFLLFNBQVM7QUFDZCxTQUFLLGNBQWMsT0FBTyxTQUFTO0FBQUE7QUFBQSxFQU92QyxjQUFzQjtBQUNsQixXQUFPO0FBQUE7QUFBQSxFQU9YLGlCQUF5QjtBQUNyQixXQUFPO0FBQUE7QUFBQSxRQU9MLFNBQVM7QUFDWCxVQUFNLEVBQUUsZ0JBQWdCO0FBQ3hCLGdCQUFZO0FBQ1osZ0JBQVksU0FBUztBQUdyQixVQUFNLGFBQWEsWUFBWSxVQUFVO0FBR3pDLFVBQU0saUJBQWlCLFdBQVcsVUFBVTtBQUc1QyxVQUFNLFVBQVUsZUFBZSxVQUFVO0FBR3pDLFVBQU0sWUFBWSxRQUFRLFVBQVU7QUFHcEMsVUFBTSxhQUFhLFVBQVUsU0FBUyxVQUFVO0FBQUEsTUFDNUMsS0FBSztBQUFBO0FBRVQsZUFBVyxZQUFZO0FBQUE7QUFBQTtBQUFBO0FBSXZCLGVBQVcsaUJBQWlCLFNBQVMsTUFBTSxLQUFLO0FBR2hELFNBQUsscUJBQXFCO0FBRzFC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
