/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};

// main.ts
__export(exports, {
  default: () => CardViewPlugin
});
var import_obsidian2 = __toModule(require("obsidian"));

// cardView.ts
var import_obsidian = __toModule(require("obsidian"));
var VIEW_TYPE_CARD = "card-view";
var CardView = class extends import_obsidian.ItemView {
  constructor(leaf, plugin) {
    super(leaf);
    this.isPreviewCollapsed = false;
    this.currentFolder = null;
    this.currentSearchTerm = "";
    this.selectedTags = new Set();
    this.selectedNotes = new Set();
    this.lastSelectedNote = null;
    this.recentFolders = [];
    this.cardSize = 280;
    this.MIN_CARD_SIZE = 280;
    this.MAX_CARD_SIZE = 600;
    this.plugin = plugin;
    this.currentView = plugin.settings.defaultView;
  }
  getViewType() {
    return VIEW_TYPE_CARD;
  }
  getDisplayText() {
    return "\u5361\u7247\u89C6\u56FE";
  }
  async onOpen() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.addClass("card-view-container");
    const toolbar = containerEl.createDiv("card-view-toolbar");
    const leftTools = toolbar.createDiv("toolbar-left");
    const newNoteBtn = leftTools.createEl("button", {
      cls: "new-note-button"
    });
    newNoteBtn.innerHTML = `
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
            <span>\u65B0\u5EFA\u7B14\u8BB0</span>
        `;
    newNoteBtn.addEventListener("click", () => this.createNewNote());
    const viewSwitcher = leftTools.createDiv("view-switcher");
    this.createViewSwitcher(viewSwitcher);
    const searchContainer = toolbar.createDiv("search-container");
    this.searchInput = searchContainer.createEl("input", {
      type: "text",
      placeholder: "\u641C\u7D22\u7B14\u8BB0...",
      cls: "search-input"
    });
    this.searchInput.addEventListener("input", () => {
      this.currentSearchTerm = this.searchInput.value;
      this.refreshView();
    });
    this.tagContainer = containerEl.createDiv("tag-filter");
    await this.loadTags();
    const contentArea = containerEl.createDiv("card-view-content");
    this.container = contentArea.createDiv("card-container");
    this.cardSize = this.plugin.settings.cardWidth;
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
    const previewWrapper = containerEl.createDiv("preview-wrapper");
    this.previewContainer = previewWrapper.createDiv("preview-container");
    const previewControls = previewWrapper.createDiv("preview-controls");
    const toggleButton = previewControls.createEl("button", {
      cls: "preview-toggle",
      attr: { "aria-label": "\u6298\u53E0\u9884\u89C8" }
    });
    toggleButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>`;
    toggleButton.addEventListener("click", () => this.togglePreview());
    this.previewResizer = previewWrapper.createDiv("preview-resizer");
    this.setupResizer();
    document.addEventListener("wheel", (e) => {
      if (e.ctrlKey) {
        e.preventDefault();
        this.adjustCardSize(e.deltaY);
      }
    }, { passive: false });
    await this.loadNotes();
  }
  async loadTags() {
    const tags = this.getAllTags();
    const allTagBtn = this.tagContainer.createEl("button", {
      text: "All",
      cls: "tag-btn active"
    });
    allTagBtn.addEventListener("click", () => {
      this.clearTagSelection();
      allTagBtn.addClass("active");
      this.refreshView();
    });
    tags.forEach((tag) => {
      const tagBtn = this.tagContainer.createEl("button", {
        text: tag,
        cls: "tag-btn"
      });
      tagBtn.addEventListener("click", (e) => {
        e.stopPropagation();
        this.toggleTag(tag, tagBtn);
      });
    });
  }
  getAllTags() {
    const tags = new Set();
    this.app.vault.getMarkdownFiles().forEach((file) => {
      const cache = this.app.metadataCache.getFileCache(file);
      if (cache == null ? void 0 : cache.tags) {
        cache.tags.forEach((tag) => tags.add(tag.tag));
      }
    });
    return Array.from(tags);
  }
  createViewSwitcher(container) {
    const views = [
      { id: "card", icon: "grid", text: "\u5361\u7247\u89C6\u56FE" },
      { id: "list", icon: "list", text: "\u5217\u8868\u89C6\u56FE" },
      { id: "timeline", icon: "clock", text: "\u65F6\u95F4\u8F74\u89C6\u56FE" }
    ];
    views.forEach((view) => {
      const btn = container.createEl("button", {
        cls: `view-switch-btn ${view.id === this.currentView ? "active" : ""}`
      });
      const iconHtml = {
        "grid": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect></svg>',
        "list": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="8" y1="6" x2="21" y2="6"></line><line x1="8" y1="12" x2="21" y2="12"></line><line x1="8" y1="18" x2="21" y2="18"></line><line x1="3" y1="6" x2="3.01" y2="6"></line><line x1="3" y1="12" x2="3.01" y2="12"></line><line x1="3" y1="18" x2="3.01" y2="18"></line></svg>',
        "clock": '<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>'
      };
      const iconSpan = btn.createSpan({ cls: "view-switch-icon" });
      iconSpan.innerHTML = iconHtml[view.icon];
      btn.createSpan({ text: view.text, cls: "view-switch-text" });
      btn.addEventListener("click", () => {
        container.querySelectorAll(".view-switch-btn").forEach((b) => b.removeClass("active"));
        btn.addClass("active");
        this.switchView(view.id);
      });
    });
  }
  async loadNotes() {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const cards = await Promise.all(files.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${this.cardSize}px`;
        this.container.appendChild(card);
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
  }
  async createNoteCard(file) {
    const card = document.createElement("div");
    card.addClass("note-card");
    card.setAttribute("data-path", file.path);
    const header = card.createDiv("note-card-header");
    const lastModified = header.createDiv("note-date");
    lastModified.setText(new Date(file.stat.mtime).toLocaleDateString());
    const folderPath = header.createDiv("note-folder");
    const folder = file.parent ? file.parent.path === "/" ? "\u6839\u76EE\u5F55" : file.parent.path : "\u6839\u76EE\u5F55";
    folderPath.setText(folder);
    folderPath.setAttribute("title", `\u6253\u5F00\u6587\u4EF6\u5939: ${folder}`);
    folderPath.addEventListener("click", async (e) => {
      e.stopPropagation();
      const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
      if (fileExplorer) {
        const fileExplorerView = fileExplorer.view;
        if (fileExplorerView.expandFolder) {
          await this.revealFolderInExplorer(folder);
          fileExplorer.setEphemeralState({ focus: true });
        }
      }
    });
    const openButton = header.createDiv("note-open-button");
    openButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>`;
    openButton.setAttribute("title", "\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00");
    openButton.style.opacity = "0";
    const cardContent = card.createDiv("note-card-content");
    const title = cardContent.createDiv("note-title");
    let displayTitle = file.basename;
    const timePattern = /^\d{4}[-./]\d{2}[-./]\d{2}/;
    if (timePattern.test(displayTitle)) {
      displayTitle = displayTitle.replace(timePattern, "").trim();
    }
    title.setText(displayTitle);
    try {
      const content = await this.app.vault.read(file);
      const noteContent = cardContent.createDiv("note-content");
      await import_obsidian.MarkdownRenderer.renderMarkdown(content, noteContent, file.path, this);
      card.addEventListener("mouseenter", async () => {
        openButton.style.opacity = "1";
        title.style.opacity = "0";
        noteContent.style.display = "block";
        try {
          this.previewContainer.empty();
          await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
        } catch (error) {
          console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
        }
      });
      card.addEventListener("mouseleave", () => {
        openButton.style.opacity = "0";
        title.style.opacity = "1";
        noteContent.style.display = "none";
      });
      openButton.addEventListener("click", async (e) => {
        e.stopPropagation();
        const leaf = this.app.workspace.getLeaf("tab");
        await leaf.openFile(file);
      });
      card.addEventListener("click", (e) => {
        this.handleCardSelection(file.path, e);
      });
      card.addEventListener("dblclick", async () => {
        const leaf = this.app.workspace.getLeaf("tab");
        await leaf.openFile(file);
      });
      card.addEventListener("contextmenu", (e) => {
        e.preventDefault();
        this.showContextMenu(e, this.getSelectedFiles());
      });
    } catch (error) {
      console.error("\u7B14\u8BB0\u52A0\u8F7D\u5931\u8D25:", error);
    }
    card.addEventListener("mouseenter", async () => {
      openButton.style.opacity = "1";
    });
    card.addEventListener("mouseleave", () => {
      openButton.style.opacity = "0";
    });
    return card;
  }
  switchView(view) {
    this.currentView = view;
    this.container.setAttribute("data-view", view);
    this.container.empty();
    if (view === "timeline") {
      this.createTimelineView();
    } else {
      this.loadNotes();
    }
  }
  async filterByTag(tag) {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const filteredFiles = files.filter((file) => {
      var _a;
      const cache = this.app.metadataCache.getFileCache(file);
      return (_a = cache == null ? void 0 : cache.tags) == null ? void 0 : _a.some((t) => t.tag === tag);
    });
    const cards = await Promise.all(filteredFiles.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      this.container.appendChild(card);
    });
    this.tagContainer.querySelectorAll("button").forEach((btn) => {
      if (btn.textContent === tag) {
        btn.addClass("active-tag");
      } else {
        btn.removeClass("active-tag");
      }
    });
  }
  togglePreview() {
    this.isPreviewCollapsed = !this.isPreviewCollapsed;
    if (this.isPreviewCollapsed) {
      this.previewContainer.addClass("collapsed");
    } else {
      this.previewContainer.removeClass("collapsed");
    }
  }
  setupResizer() {
    let startX;
    let startWidth;
    const startResize = (e) => {
      e.preventDefault();
      startX = e.pageX;
      startWidth = parseInt(getComputedStyle(this.previewContainer).width, 10);
      document.addEventListener("mousemove", resize);
      document.addEventListener("mouseup", stopResize);
      document.body.style.cursor = "col-resize";
      this.previewResizer.addClass("resizing");
    };
    const resize = (e) => {
      const width = startWidth - (e.pageX - startX);
      if (width >= 50 && width <= 800) {
        this.previewContainer.style.width = `${width}px`;
        if (this.isPreviewCollapsed) {
          this.isPreviewCollapsed = false;
          this.previewContainer.removeClass("collapsed");
        }
      }
    };
    const stopResize = () => {
      document.removeEventListener("mousemove", resize);
      document.removeEventListener("mouseup", stopResize);
      document.body.style.cursor = "";
      this.previewResizer.removeClass("resizing");
    };
    this.previewResizer.addEventListener("mousedown", startResize);
  }
  highlightFolder(folder) {
    this.currentFolder = this.currentFolder === folder ? null : folder;
    this.container.querySelectorAll(".note-card").forEach((card) => {
      const folderElement = card.querySelector(".note-folder");
      const cardFolder = folderElement ? folderElement.textContent : null;
      if (cardFolder) {
        card.toggleClass("folder-highlight", cardFolder === folder);
      }
    });
  }
  async revealFolderInExplorer(folder) {
    const fileExplorer = this.app.workspace.getLeavesOfType("file-explorer")[0];
    if (fileExplorer) {
      const fileExplorerView = fileExplorer.view;
      if (folder === "\u6839\u76EE\u5F55") {
        if (fileExplorerView.expandFolder) {
          await fileExplorerView.expandFolder("/");
        }
        return;
      }
      if (fileExplorerView.expandFolder) {
        const folderParts = folder.split("/");
        let currentPath = "";
        for (const part of folderParts) {
          currentPath += (currentPath ? "/" : "") + part;
          await fileExplorerView.expandFolder(currentPath);
        }
        if (fileExplorerView.setSelection) {
          await fileExplorerView.setSelection(folder);
        }
      }
    }
  }
  async createNewNote() {
    const date = new Date();
    const fileName = `\u672A\u547D\u540D\u7B14\u8BB0 ${date.toLocaleString().replace(/[/:]/g, "-")}`;
    try {
      const file = await this.app.vault.create(`${fileName}.md`, "# " + fileName + "\n\n");
      const leaf = this.app.workspace.getLeaf("tab");
      await leaf.openFile(file);
      this.loadNotes();
    } catch (error) {
      console.error("\u521B\u5EFA\u7B14\u8BB0\u5931\u8D25:", error);
    }
  }
  async createTimelineView() {
    const timelineContainer = this.container.createDiv("timeline-container");
    const files = this.app.vault.getMarkdownFiles();
    const notesByDate = new Map();
    files.forEach((file) => {
      const date = new Date(file.stat.mtime).toLocaleDateString();
      if (!notesByDate.has(date)) {
        notesByDate.set(date, []);
      }
      const notes = notesByDate.get(date);
      if (notes) {
        notes.push(file);
      }
    });
    const sortedDates = Array.from(notesByDate.keys()).sort((a, b) => new Date(b).getTime() - new Date(a).getTime());
    for (const date of sortedDates) {
      const dateGroup = timelineContainer.createDiv("timeline-date-group");
      const dateNode = dateGroup.createDiv("timeline-date-node");
      dateNode.createDiv("timeline-node-circle");
      dateNode.createDiv("timeline-date-label").setText(date);
      const notesList = dateGroup.createDiv("timeline-notes-list");
      const notes = notesByDate.get(date);
      if (notes) {
        for (const file of notes) {
          const noteItem = notesList.createDiv("timeline-note-item");
          noteItem.createDiv("timeline-note-marker");
          const noteContent = noteItem.createDiv("timeline-note-content");
          noteContent.createDiv("timeline-note-title").setText(file.basename);
          noteItem.addEventListener("click", async () => {
            const leaf = this.app.workspace.getLeaf("tab");
            await leaf.openFile(file);
          });
          noteItem.addEventListener("mouseenter", async () => {
            try {
              this.previewContainer.empty();
              const content = await this.app.vault.read(file);
              await import_obsidian.MarkdownRenderer.renderMarkdown(content, this.previewContainer, file.path, this);
            } catch (error) {
              console.error("\u9884\u89C8\u52A0\u8F7D\u5931\u8D25:", error);
            }
          });
        }
      }
    }
  }
  addContextMenu(card, file) {
    card.addEventListener("contextmenu", (event) => {
      event.preventDefault();
      event.stopPropagation();
      const path = card.getAttribute("data-path");
      if (path && !this.selectedNotes.has(path) && !event.ctrlKey) {
        this.clearSelection();
        this.selectedNotes.add(path);
        card.addClass("selected");
      }
      const selectedFiles = this.getSelectedFiles();
      this.showContextMenu(event, selectedFiles);
    });
  }
  async refreshView() {
    const files = this.app.vault.getMarkdownFiles();
    this.container.empty();
    const filteredFiles = files.filter((file) => {
      var _a, _b;
      const matchesSearch = !this.currentSearchTerm || file.basename.toLowerCase().includes(this.currentSearchTerm.toLowerCase());
      let matchesTags = true;
      if (this.selectedTags.size > 0) {
        const cache = this.app.metadataCache.getFileCache(file);
        matchesTags = (_b = (_a = cache == null ? void 0 : cache.tags) == null ? void 0 : _a.some((t) => this.selectedTags.has(t.tag))) != null ? _b : false;
      }
      return matchesSearch && matchesTags;
    });
    const cards = await Promise.all(filteredFiles.map((file) => this.createNoteCard(file)));
    cards.forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${this.cardSize}px`;
        this.container.appendChild(card);
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${this.cardSize}px)`;
  }
  toggleTag(tag, tagBtn) {
    if (this.selectedTags.has(tag)) {
      this.selectedTags.delete(tag);
      tagBtn.removeClass("active");
    } else {
      this.selectedTags.add(tag);
      tagBtn.addClass("active");
    }
    const allBtn = this.tagContainer.querySelector("button");
    if (allBtn) {
      allBtn.removeClass("active");
    }
    this.refreshView();
  }
  clearTagSelection() {
    this.selectedTags.clear();
    this.tagContainer.querySelectorAll(".tag-btn").forEach((btn) => {
      btn.removeClass("active");
    });
  }
  handleCardSelection(path, event) {
    const card = this.container.querySelector(`[data-path="${path}"]`);
    if (!card)
      return;
    if (event.ctrlKey) {
      if (this.selectedNotes.has(path)) {
        this.selectedNotes.delete(path);
        card.removeClass("selected");
      } else {
        this.selectedNotes.add(path);
        card.addClass("selected");
      }
    } else if (event.shiftKey && this.lastSelectedNote) {
      const cards = Array.from(this.container.querySelectorAll(".note-card"));
      const lastIndex = cards.findIndex((c) => c.getAttribute("data-path") === this.lastSelectedNote);
      const currentIndex = cards.findIndex((c) => c.getAttribute("data-path") === path);
      const start = Math.min(lastIndex, currentIndex);
      const end = Math.max(lastIndex, currentIndex);
      cards.forEach((c, i) => {
        const cardPath = c.getAttribute("data-path");
        if (i >= start && i <= end && cardPath) {
          this.selectedNotes.add(cardPath);
          c.addClass("selected");
        }
      });
    } else {
      this.clearSelection();
      this.selectedNotes.add(path);
      card.addClass("selected");
    }
    this.lastSelectedNote = path;
  }
  clearSelection() {
    this.selectedNotes.clear();
    this.container.querySelectorAll(".note-card.selected").forEach((card) => {
      card.removeClass("selected");
    });
  }
  getSelectedFiles() {
    return Array.from(this.selectedNotes).map((path) => this.app.vault.getAbstractFileByPath(path)).filter((file) => file instanceof import_obsidian.TFile);
  }
  showContextMenu(event, files) {
    const menu = new import_obsidian.Menu();
    if (files.length > 0) {
      menu.addItem((item) => {
        item.setTitle(`\u5728\u65B0\u6807\u7B7E\u9875\u6253\u5F00`).setIcon("link").onClick(async () => {
          for (const file of files) {
            const leaf = this.app.workspace.getLeaf("tab");
            await leaf.openFile(file);
          }
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u5728\u6587\u4EF6\u7BA1\u7406\u5668\u4E2D\u663E\u793A`).setIcon("folder").onClick(() => {
          var _a;
          const file = files[0];
          this.revealFolderInExplorer(((_a = file.parent) == null ? void 0 : _a.path) || "/");
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u79FB\u52A8 ${files.length} \u4E2A\u6587\u4EF6`).setIcon("move").onClick(() => {
          const modal = new EnhancedFileSelectionModal(this.app, files, this.recentFolders, (folders) => {
            this.recentFolders = folders;
          });
          modal.open();
        });
      });
      menu.addItem((item) => {
        item.setTitle(`\u5220\u9664 ${files.length} \u4E2A\u6587\u4EF6`).setIcon("trash").onClick(async () => {
          const confirm = await new ConfirmModal(this.app, "\u786E\u8BA4\u5220\u9664", `\u662F\u5426\u786E\u5B9A\u8981\u5220\u9664\u9009\u4E2D\u7684 ${files.length} \u4E2A\u6587\u4EF6\uFF1F`).show();
          if (confirm) {
            for (const file of files) {
              await this.app.vault.trash(file, true);
            }
            this.refreshView();
          }
        });
      });
    }
    menu.showAtMouseEvent(event);
  }
  adjustCardSize(delta) {
    const adjustment = delta > 0 ? -10 : 10;
    const newSize = Math.max(this.plugin.settings.minCardWidth, Math.min(this.plugin.settings.maxCardWidth, this.cardSize + adjustment));
    if (newSize !== this.cardSize) {
      this.cardSize = newSize;
      this.updateCardSize(newSize);
      this.plugin.saveCardWidth(newSize);
    }
  }
  updateCardSize(width) {
    this.cardSize = width;
    this.container.querySelectorAll(".note-card").forEach((card) => {
      if (card instanceof HTMLElement) {
        card.style.width = `${width}px`;
      }
    });
    this.container.style.gridTemplateColumns = `repeat(auto-fill, ${width}px)`;
  }
};
var ConfirmModal = class extends import_obsidian.Modal {
  constructor(app, title, message) {
    super(app);
    this.result = false;
    this.title = title;
    this.message = message;
  }
  async show() {
    return new Promise((resolve) => {
      this.resolvePromise = resolve;
      this.open();
    });
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h3", { text: this.title });
    contentEl.createEl("p", { text: this.message });
    const buttonContainer = contentEl.createDiv("button-container");
    const confirmButton = buttonContainer.createEl("button", { text: "\u786E\u8BA4" });
    confirmButton.addEventListener("click", () => {
      this.result = true;
      this.close();
    });
    const cancelButton = buttonContainer.createEl("button", { text: "\u53D6\u6D88" });
    cancelButton.addEventListener("click", () => {
      this.result = false;
      this.close();
    });
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
    this.resolvePromise(this.result);
  }
};
var EnhancedFileSelectionModal = class extends import_obsidian.Modal {
  constructor(app, files, recentFolders, onFoldersUpdate) {
    super(app);
    this.selectedFolder = null;
    this.files = files;
    this.recentFolders = recentFolders;
    this.onFoldersUpdate = onFoldersUpdate;
  }
  async onOpen() {
    const { contentEl } = this;
    contentEl.empty();
    contentEl.createEl("h3", {
      text: `\u79FB\u52A8 ${this.files.length} \u4E2A\u6587\u4EF6`
    });
    if (this.recentFolders.length > 0) {
      const recentSection = contentEl.createDiv("recent-folders-section");
      recentSection.createEl("h4", { text: "\u6700\u8FD1\u4F7F\u7528" });
      const recentList = recentSection.createDiv("recent-folders-list");
      this.recentFolders.forEach((folder) => {
        const item = recentList.createDiv("folder-item recent");
        item.setText(folder);
        item.addEventListener("click", () => this.selectFolder(item, folder));
      });
    }
    const folderList = contentEl.createDiv("folder-list");
    const folders = this.getFoldersWithHierarchy();
    this.createFolderTree(folderList, folders);
    const buttonContainer = contentEl.createDiv("modal-button-container");
    const confirmButton = buttonContainer.createEl("button", {
      text: "\u786E\u8BA4\u79FB\u52A8",
      cls: "mod-cta"
    });
    confirmButton.addEventListener("click", () => {
      if (this.selectedFolder) {
        this.moveFiles(this.selectedFolder);
      }
    });
    const cancelButton = buttonContainer.createEl("button", {
      text: "\u53D6\u6D88"
    });
    cancelButton.addEventListener("click", () => this.close());
  }
  getFoldersWithHierarchy() {
    const folders = [];
    const seen = new Set();
    this.app.vault.getAllLoadedFiles().forEach((file) => {
      if (file instanceof import_obsidian.TFolder) {
        const parts = file.path.split("/");
        let currentPath = "";
        let level = 0;
        parts.forEach((part) => {
          if (part) {
            currentPath += (currentPath ? "/" : "") + part;
            if (!seen.has(currentPath)) {
              seen.add(currentPath);
              folders.push({
                path: currentPath,
                name: part,
                level
              });
            }
            level++;
          }
        });
      }
    });
    return folders.sort((a, b) => a.path.localeCompare(b.path));
  }
  createFolderTree(container, folders) {
    folders.forEach((folder) => {
      const item = container.createDiv({
        cls: "folder-item"
      });
      item.style.paddingLeft = `${folder.level * 20 + 10}px`;
      const icon = item.createSpan({
        cls: "folder-icon"
      });
      icon.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>`;
      const name = item.createSpan({
        cls: "folder-name",
        text: folder.name
      });
      item.addEventListener("click", () => this.selectFolder(item, folder.path));
    });
  }
  selectFolder(element, path) {
    this.contentEl.querySelectorAll(".folder-item").forEach((item) => {
      item.removeClass("selected");
    });
    element.addClass("selected");
    this.selectedFolder = path;
  }
  async moveFiles(targetFolder) {
    const confirmModal = new ConfirmModal(this.app, "\u786E\u8BA4\u79FB\u52A8", `\u662F\u5426\u5C06\u9009\u4E2D\u7684 ${this.files.length} \u4E2A\u6587\u4EF6\u79FB\u52A8\u5230 "${targetFolder}"\uFF1F`);
    if (await confirmModal.show()) {
      for (const file of this.files) {
        const newPath = `${targetFolder}/${file.name}`;
        await this.app.fileManager.renameFile(file, newPath);
      }
      this.recentFolders = [targetFolder, ...this.recentFolders.filter((f) => f !== targetFolder)].slice(0, 5);
      this.onFoldersUpdate(this.recentFolders);
      this.close();
    }
  }
};

// main.ts
var DEFAULT_SETTINGS = {
  defaultView: "card",
  cardWidth: 280,
  minCardWidth: 280,
  maxCardWidth: 600
};
var CardViewSettingTab = class extends import_obsidian2.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian2.Setting(containerEl).setName("\u9ED8\u8BA4\u89C6\u56FE").setDesc("\u9009\u62E9\u9ED8\u8BA4\u7684\u89C6\u56FE\u6A21\u5F0F").addDropdown((dropdown) => {
      dropdown.addOption("card", "\u5361\u7247\u89C6\u56FE").addOption("list", "\u5217\u8868\u89C6\u56FE").addOption("timeline", "\u65F6\u95F4\u8F74\u89C6\u56FE").setValue(this.plugin.settings.defaultView);
      dropdown.onChange(async (value) => {
        if (value === "card" || value === "list" || value === "timeline") {
          this.plugin.settings.defaultView = value;
          await this.plugin.saveSettings();
        }
      });
    });
    new import_obsidian2.Setting(containerEl).setName("\u5361\u7247\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u5BBD\u5EA6\uFF08280-600\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("280").setValue(this.plugin.settings.cardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width >= 280 && width <= 600) {
        this.plugin.settings.cardWidth = width;
        await this.plugin.saveSettings();
        this.plugin.updateAllCardViews();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5C0F\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u6700\u5C0F\u5BBD\u5EA6\uFF08\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("280").setValue(this.plugin.settings.minCardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width >= 200) {
        this.plugin.settings.minCardWidth = width;
        await this.plugin.saveSettings();
      }
    }));
    new import_obsidian2.Setting(containerEl).setName("\u6700\u5927\u5BBD\u5EA6").setDesc("\u8BBE\u7F6E\u5361\u7247\u7684\u6700\u5927\u5BBD\u5EA6\uFF08\u50CF\u7D20\uFF09").addText((text) => text.setPlaceholder("600").setValue(this.plugin.settings.maxCardWidth.toString()).onChange(async (value) => {
      const width = Number(value);
      if (!isNaN(width) && width <= 800) {
        this.plugin.settings.maxCardWidth = width;
        await this.plugin.saveSettings();
      }
    }));
  }
};
var CardViewPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    await this.loadSettings();
    this.registerView(VIEW_TYPE_CARD, (leaf) => new CardView(leaf, this));
    this.addRibbonIcon("layout-grid", "\u5361\u7247\u89C6\u56FE", () => {
      this.activateView();
    });
    this.addSettingTab(new CardViewSettingTab(this.app, this));
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  async activateView() {
    const { workspace } = this.app;
    let leaf = workspace.getLeavesOfType(VIEW_TYPE_CARD)[0];
    if (!leaf) {
      leaf = workspace.getLeaf("tab");
      await leaf.setViewState({
        type: VIEW_TYPE_CARD,
        active: true
      });
    }
    workspace.revealLeaf(leaf);
  }
  updateAllCardViews() {
    this.app.workspace.getLeavesOfType(VIEW_TYPE_CARD).forEach((leaf) => {
      const view = leaf.view;
      if (view) {
        view.updateCardSize(this.settings.cardWidth);
      }
    });
  }
  async saveCardWidth(width) {
    this.settings.cardWidth = width;
    await this.saveSettings();
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJjYXJkVmlldy50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIFRGaWxlLCBXb3Jrc3BhY2VMZWFmIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgeyBDYXJkVmlldywgVklFV19UWVBFX0NBUkQgfSBmcm9tICcuL2NhcmRWaWV3JztcclxuXHJcbmludGVyZmFjZSBDYXJkVmlld1BsdWdpblNldHRpbmdzIHtcclxuICAgIGRlZmF1bHRWaWV3OiAnY2FyZCcgfCAnbGlzdCcgfCAndGltZWxpbmUnO1xyXG4gICAgY2FyZFdpZHRoOiBudW1iZXI7XHJcbiAgICBtaW5DYXJkV2lkdGg6IG51bWJlcjtcclxuICAgIG1heENhcmRXaWR0aDogbnVtYmVyO1xyXG59XHJcblxyXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBDYXJkVmlld1BsdWdpblNldHRpbmdzID0ge1xyXG4gICAgZGVmYXVsdFZpZXc6ICdjYXJkJyxcclxuICAgIGNhcmRXaWR0aDogMjgwLFxyXG4gICAgbWluQ2FyZFdpZHRoOiAyODAsXHJcbiAgICBtYXhDYXJkV2lkdGg6IDYwMFxyXG59XHJcblxyXG5jbGFzcyBDYXJkVmlld1NldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcclxuICAgIHBsdWdpbjogQ2FyZFZpZXdQbHVnaW47XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogQ2FyZFZpZXdQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihhcHAsIHBsdWdpbik7XHJcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XHJcbiAgICB9XHJcblxyXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU5RUQ4XHU4QkE0XHU4OUM2XHU1NkZFJylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1x1OTAwOVx1NjJFOVx1OUVEOFx1OEJBNFx1NzY4NFx1ODlDNlx1NTZGRVx1NkEyMVx1NUYwRicpXHJcbiAgICAgICAgICAgIC5hZGREcm9wZG93bihkcm9wZG93biA9PiB7XHJcbiAgICAgICAgICAgICAgICBkcm9wZG93blxyXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2NhcmQnLCAnXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFJylcclxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdsaXN0JywgJ1x1NTIxN1x1ODg2OFx1ODlDNlx1NTZGRScpXHJcbiAgICAgICAgICAgICAgICAgICAgLmFkZE9wdGlvbigndGltZWxpbmUnLCAnXHU2NUY2XHU5NUY0XHU4Rjc0XHU4OUM2XHU1NkZFJylcclxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuZGVmYXVsdFZpZXcpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBkcm9wZG93bi5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWUgPT09ICdjYXJkJyB8fCB2YWx1ZSA9PT0gJ2xpc3QnIHx8IHZhbHVlID09PSAndGltZWxpbmUnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmRlZmF1bHRWaWV3ID0gdmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXHJcbiAgICAgICAgICAgIC5zZXROYW1lKCdcdTUzNjFcdTcyNDdcdTVCQkRcdTVFQTYnKVxyXG4gICAgICAgICAgICAuc2V0RGVzYygnXHU4QkJFXHU3RjZFXHU1MzYxXHU3MjQ3XHU3Njg0XHU1QkJEXHU1RUE2XHVGRjA4MjgwLTYwMFx1NTBDRlx1N0QyMFx1RkYwOScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCcyODAnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRXaWR0aC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSAmJiB3aWR0aCA+PSAyODAgJiYgd2lkdGggPD0gNjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmNhcmRXaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4udXBkYXRlQWxsQ2FyZFZpZXdzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG5cclxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcclxuICAgICAgICAgICAgLnNldE5hbWUoJ1x1NjcwMFx1NUMwRlx1NUJCRFx1NUVBNicpXHJcbiAgICAgICAgICAgIC5zZXREZXNjKCdcdThCQkVcdTdGNkVcdTUzNjFcdTcyNDdcdTc2ODRcdTY3MDBcdTVDMEZcdTVCQkRcdTVFQTZcdUZGMDhcdTUwQ0ZcdTdEMjBcdUZGMDknKVxyXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcclxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignMjgwJylcclxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5taW5DYXJkV2lkdGgudG9TdHJpbmcoKSlcclxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB3aWR0aCA9IE51bWJlcih2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFpc05hTih3aWR0aCkgJiYgd2lkdGggPj0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm1pbkNhcmRXaWR0aCA9IHdpZHRoO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KSk7XHJcblxyXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxyXG4gICAgICAgICAgICAuc2V0TmFtZSgnXHU2NzAwXHU1OTI3XHU1QkJEXHU1RUE2JylcclxuICAgICAgICAgICAgLnNldERlc2MoJ1x1OEJCRVx1N0Y2RVx1NTM2MVx1NzI0N1x1NzY4NFx1NjcwMFx1NTkyN1x1NUJCRFx1NUVBNlx1RkYwOFx1NTBDRlx1N0QyMFx1RkYwOScpXHJcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxyXG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCc2MDAnKVxyXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heENhcmRXaWR0aC50b1N0cmluZygpKVxyXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gTnVtYmVyKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSAmJiB3aWR0aCA8PSA4MDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubWF4Q2FyZFdpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pKTtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZFZpZXdQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xyXG4gICAgc2V0dGluZ3M6IENhcmRWaWV3UGx1Z2luU2V0dGluZ3M7XHJcblxyXG4gICAgYXN5bmMgb25sb2FkKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XHJcblxyXG4gICAgICAgIHRoaXMucmVnaXN0ZXJWaWV3KFxyXG4gICAgICAgICAgICBWSUVXX1RZUEVfQ0FSRCxcclxuICAgICAgICAgICAgKGxlYWY6IFdvcmtzcGFjZUxlYWYpID0+IG5ldyBDYXJkVmlldyhsZWFmLCB0aGlzKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHRoaXMuYWRkUmliYm9uSWNvbignbGF5b3V0LWdyaWQnLCAnXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFJywgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFjdGl2YXRlVmlldygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IENhcmRWaWV3U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcclxuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzYXZlU2V0dGluZ3MoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XHJcbiAgICAgICAgY29uc3QgeyB3b3Jrc3BhY2UgfSA9IHRoaXMuYXBwO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGxldCBsZWFmID0gd29ya3NwYWNlLmdldExlYXZlc09mVHlwZShWSUVXX1RZUEVfQ0FSRClbMF07XHJcbiAgICAgICAgaWYgKCFsZWFmKSB7XHJcbiAgICAgICAgICAgIGxlYWYgPSB3b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XHJcbiAgICAgICAgICAgIGF3YWl0IGxlYWYuc2V0Vmlld1N0YXRlKHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IFZJRVdfVFlQRV9DQVJELFxyXG4gICAgICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd29ya3NwYWNlLnJldmVhbExlYWYobGVhZik7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlQWxsQ2FyZFZpZXdzKCkge1xyXG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0NBUkQpLmZvckVhY2gobGVhZiA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHZpZXcgPSBsZWFmLnZpZXcgYXMgQ2FyZFZpZXc7XHJcbiAgICAgICAgICAgIGlmICh2aWV3KSB7XHJcbiAgICAgICAgICAgICAgICB2aWV3LnVwZGF0ZUNhcmRTaXplKHRoaXMuc2V0dGluZ3MuY2FyZFdpZHRoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHNhdmVDYXJkV2lkdGgod2lkdGg6IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuc2V0dGluZ3MuY2FyZFdpZHRoID0gd2lkdGg7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlU2V0dGluZ3MoKTtcclxuICAgIH1cclxufSAiLCAiaW1wb3J0IHtcclxuICAgIEl0ZW1WaWV3LFxyXG4gICAgV29ya3NwYWNlTGVhZixcclxuICAgIFRGaWxlLFxyXG4gICAgTWFya2Rvd25SZW5kZXJlcixcclxuICAgIE1lbnUsXHJcbiAgICBNb2RhbCxcclxuICAgIFRGb2xkZXIsXHJcbiAgICBBcHAsXHJcbiAgICBOb3RpY2VcclxufSBmcm9tICdvYnNpZGlhbic7XHJcbmltcG9ydCBDYXJkVmlld1BsdWdpbiBmcm9tICcuL21haW4nO1xyXG5cclxuZXhwb3J0IGNvbnN0IFZJRVdfVFlQRV9DQVJEID0gJ2NhcmQtdmlldyc7XHJcblxyXG5leHBvcnQgY2xhc3MgQ2FyZFZpZXcgZXh0ZW5kcyBJdGVtVmlldyB7XHJcbiAgICBwcml2YXRlIHBsdWdpbjogQ2FyZFZpZXdQbHVnaW47XHJcbiAgICBwcml2YXRlIGN1cnJlbnRWaWV3OiAnY2FyZCcgfCAnbGlzdCcgfCAndGltZWxpbmUnO1xyXG4gICAgcHJpdmF0ZSBjb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSB0YWdDb250YWluZXI6IEhUTUxFbGVtZW50O1xyXG4gICAgcHJpdmF0ZSBjb250ZW50Q29udGFpbmVyOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgcHJldmlld0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XHJcbiAgICBwcml2YXRlIHByZXZpZXdSZXNpemVyOiBIVE1MRWxlbWVudDtcclxuICAgIHByaXZhdGUgaXNQcmV2aWV3Q29sbGFwc2VkOiBib29sZWFuID0gZmFsc2U7XHJcbiAgICBwcml2YXRlIGN1cnJlbnRGb2xkZXI6IHN0cmluZyB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBzZWFyY2hJbnB1dDogSFRNTElucHV0RWxlbWVudDtcclxuICAgIHByaXZhdGUgY3VycmVudFNlYXJjaFRlcm06IHN0cmluZyA9ICcnO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RlZFRhZ3M6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG4gICAgcHJpdmF0ZSBzZWxlY3RlZE5vdGVzOiBTZXQ8c3RyaW5nPiA9IG5ldyBTZXQoKTtcclxuICAgIHByaXZhdGUgbGFzdFNlbGVjdGVkTm90ZTogc3RyaW5nIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcml2YXRlIHJlY2VudEZvbGRlcnM6IHN0cmluZ1tdID0gW107XHJcbiAgICBwcml2YXRlIGNhcmRTaXplOiBudW1iZXIgPSAyODA7ICAvLyBcdTlFRDhcdThCQTRcdTUzNjFcdTcyNDdcdTVCQkRcdTVFQTZcclxuICAgIHByaXZhdGUgcmVhZG9ubHkgTUlOX0NBUkRfU0laRSA9IDI4MDsgIC8vIFx1NjcwMFx1NUMwRlx1NTM2MVx1NzI0N1x1NUJCRFx1NUVBNlxyXG4gICAgcHJpdmF0ZSByZWFkb25seSBNQVhfQ0FSRF9TSVpFID0gNjAwOyAgLy8gXHU2NzAwXHU1OTI3XHU1MzYxXHU3MjQ3XHU1QkJEXHU1RUE2XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTY3ODRcdTkwMjBcdTUxRkRcdTY1NzBcclxuICAgICAqIEBwYXJhbSBsZWFmIC0gXHU1REU1XHU0RjVDXHU1MzNBXHU1M0Y2XHU1QjUwXHU4MjgyXHU3MEI5XHJcbiAgICAgKiBAcGFyYW0gcGx1Z2luIC0gXHU2M0QyXHU0RUY2XHU1QjlFXHU0RjhCXHJcbiAgICAgKi9cclxuICAgIGNvbnN0cnVjdG9yKGxlYWY6IFdvcmtzcGFjZUxlYWYsIHBsdWdpbjogQ2FyZFZpZXdQbHVnaW4pIHtcclxuICAgICAgICBzdXBlcihsZWFmKTtcclxuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcclxuICAgICAgICB0aGlzLmN1cnJlbnRWaWV3ID0gcGx1Z2luLnNldHRpbmdzLmRlZmF1bHRWaWV3O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU4M0I3XHU1M0Q2XHU4OUM2XHU1NkZFXHU3QzdCXHU1NzhCXHJcbiAgICAgKiBAcmV0dXJucyBcdTg5QzZcdTU2RkVcdTdDN0JcdTU3OEJcdTY4MDdcdThCQzZcdTdCMjZcclxuICAgICAqL1xyXG4gICAgZ2V0Vmlld1R5cGUoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gVklFV19UWVBFX0NBUkQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTgzQjdcdTUzRDZcdTg5QzZcdTU2RkVcdTY2M0VcdTc5M0FcdTY1ODdcdTY3MkNcclxuICAgICAqIEByZXR1cm5zIFx1NjYzRVx1NzkzQVx1NTcyOFx1NjgwN1x1N0I3RVx1OTg3NVx1NEUwQVx1NzY4NFx1NjU4N1x1NjcyQ1xyXG4gICAgICovXHJcbiAgICBnZXREaXNwbGF5VGV4dCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiAnXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFJztcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1ODlDNlx1NTZGRVx1NjI1M1x1NUYwMFx1NjVGNlx1NzY4NFx1NTIxRFx1NTlDQlx1NTMxNlx1NTFGRFx1NjU3MFxyXG4gICAgICogXHU1MjFCXHU1RUZBXHU2ODA3XHU3QjdFXHU4RkM3XHU2RUU0XHU1NjY4XHUzMDAxXHU4OUM2XHU1NkZFXHU1MjA3XHU2MzYyXHU2MzA5XHU5NEFFXHU1NDhDXHU1QkI5XHU1NjY4XHJcbiAgICAgKi9cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XHJcbiAgICAgICAgY29udGFpbmVyRWwuYWRkQ2xhc3MoJ2NhcmQtdmlldy1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTVERTVcdTUxNzdcdTY4MEZcclxuICAgICAgICBjb25zdCB0b29sYmFyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdjYXJkLXZpZXctdG9vbGJhcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NURFNlx1NEZBN1x1NURFNVx1NTE3N1x1N0VDNFxyXG4gICAgICAgIGNvbnN0IGxlZnRUb29scyA9IHRvb2xiYXIuY3JlYXRlRGl2KCd0b29sYmFyLWxlZnQnKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTY1QjBcdTVFRkFcdTdCMTRcdThCQjBcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBuZXdOb3RlQnRuID0gbGVmdFRvb2xzLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIGNsczogJ25ldy1ub3RlLWJ1dHRvbicsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgbmV3Tm90ZUJ0bi5pbm5lckhUTUwgPSBgXHJcbiAgICAgICAgICAgIDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImx1Y2lkZSBsdWNpZGUtcGx1c1wiPjxsaW5lIHgxPVwiMTJcIiB5MT1cIjVcIiB4Mj1cIjEyXCIgeTI9XCIxOVwiPjwvbGluZT48bGluZSB4MT1cIjVcIiB5MT1cIjEyXCIgeDI9XCIxOVwiIHkyPVwiMTJcIj48L2xpbmU+PC9zdmc+XHJcbiAgICAgICAgICAgIDxzcGFuPlx1NjVCMFx1NUVGQVx1N0IxNFx1OEJCMDwvc3Bhbj5cclxuICAgICAgICBgO1xyXG4gICAgICAgIG5ld05vdGVCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmNyZWF0ZU5ld05vdGUoKSk7XHJcblxyXG4gICAgICAgIC8vIFx1ODlDNlx1NTZGRVx1NTIwN1x1NjM2Mlx1NjMwOVx1OTRBRVx1N0VDNFxyXG4gICAgICAgIGNvbnN0IHZpZXdTd2l0Y2hlciA9IGxlZnRUb29scy5jcmVhdGVEaXYoJ3ZpZXctc3dpdGNoZXInKTtcclxuICAgICAgICB0aGlzLmNyZWF0ZVZpZXdTd2l0Y2hlcih2aWV3U3dpdGNoZXIpO1xyXG5cclxuICAgICAgICAvLyBcdTUzRjNcdTRGQTdcdTY0MUNcdTdEMjJcdTY4NDZcclxuICAgICAgICBjb25zdCBzZWFyY2hDb250YWluZXIgPSB0b29sYmFyLmNyZWF0ZURpdignc2VhcmNoLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQgPSBzZWFyY2hDb250YWluZXIuY3JlYXRlRWwoJ2lucHV0Jywge1xyXG4gICAgICAgICAgICB0eXBlOiAndGV4dCcsXHJcbiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnXHU2NDFDXHU3RDIyXHU3QjE0XHU4QkIwLi4uJyxcclxuICAgICAgICAgICAgY2xzOiAnc2VhcmNoLWlucHV0J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRoaXMuc2VhcmNoSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuY3VycmVudFNlYXJjaFRlcm0gPSB0aGlzLnNlYXJjaElucHV0LnZhbHVlO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NjgwN1x1N0I3RVx1NjgwRlxyXG4gICAgICAgIHRoaXMudGFnQ29udGFpbmVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCd0YWctZmlsdGVyJyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkVGFncygpO1xyXG5cclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTRFM0JcdTUxODVcdTVCQjlcdTUzM0FcdTU3REZcclxuICAgICAgICBjb25zdCBjb250ZW50QXJlYSA9IGNvbnRhaW5lckVsLmNyZWF0ZURpdignY2FyZC12aWV3LWNvbnRlbnQnKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGNvbnRlbnRBcmVhLmNyZWF0ZURpdignY2FyZC1jb250YWluZXInKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTRGN0ZcdTc1MjhcdTRGRERcdTVCNThcdTc2ODRcdTVCQkRcdTVFQTZcdTUyMURcdTU5Q0JcdTUzMTZcdTUzNjFcdTcyNDdcdTVCQjlcdTU2NjhcclxuICAgICAgICB0aGlzLmNhcmRTaXplID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2FyZFdpZHRoO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KGF1dG8tZmlsbCwgJHt0aGlzLmNhcmRTaXplfXB4KWA7XHJcblxyXG4gICAgICAgIC8vIFx1OTg4NFx1ODlDOFx1NTMzQVx1NTdERlxyXG4gICAgICAgIGNvbnN0IHByZXZpZXdXcmFwcGVyID0gY29udGFpbmVyRWwuY3JlYXRlRGl2KCdwcmV2aWV3LXdyYXBwZXInKTtcclxuICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIgPSBwcmV2aWV3V3JhcHBlci5jcmVhdGVEaXYoJ3ByZXZpZXctY29udGFpbmVyJyk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU5ODg0XHU4OUM4XHU2M0E3XHU1MjM2XHU2MzA5XHU5NEFFXHJcbiAgICAgICAgY29uc3QgcHJldmlld0NvbnRyb2xzID0gcHJldmlld1dyYXBwZXIuY3JlYXRlRGl2KCdwcmV2aWV3LWNvbnRyb2xzJyk7XHJcbiAgICAgICAgY29uc3QgdG9nZ2xlQnV0dG9uID0gcHJldmlld0NvbnRyb2xzLmNyZWF0ZUVsKCdidXR0b24nLCB7XHJcbiAgICAgICAgICAgIGNsczogJ3ByZXZpZXctdG9nZ2xlJyxcclxuICAgICAgICAgICAgYXR0cjogeyAnYXJpYS1sYWJlbCc6ICdcdTYyOThcdTUzRTBcdTk4ODRcdTg5QzgnIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0b2dnbGVCdXR0b24uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMjRcIiBoZWlnaHQ9XCIyNFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIiBjbGFzcz1cImZlYXRoZXIgZmVhdGhlci1jaGV2cm9uLXJpZ2h0XCI+PHBvbHlsaW5lIHBvaW50cz1cIjkgMTggMTUgMTIgOSA2XCI+PC9wb2x5bGluZT48L3N2Zz5gO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRvZ2dsZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMudG9nZ2xlUHJldmlldygpKTtcclxuXHJcbiAgICAgICAgdGhpcy5wcmV2aWV3UmVzaXplciA9IHByZXZpZXdXcmFwcGVyLmNyZWF0ZURpdigncHJldmlldy1yZXNpemVyJyk7XHJcbiAgICAgICAgdGhpcy5zZXR1cFJlc2l6ZXIoKTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU1MTY4XHU1QzQwXHU2RURBXHU4RjZFXHU0RThCXHU0RUY2XHU3NkQxXHU1NDJDXHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignd2hlZWwnLCAoZTogV2hlZWxFdmVudCkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZS5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmFkanVzdENhcmRTaXplKGUuZGVsdGFZKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sIHsgcGFzc2l2ZTogZmFsc2UgfSk7XHJcblxyXG4gICAgICAgIGF3YWl0IHRoaXMubG9hZE5vdGVzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTUyQTBcdThGN0RcdTYyNDBcdTY3MDlcdTY4MDdcdTdCN0VcdTVFNzZcdTUyMUJcdTVFRkFcdTY4MDdcdTdCN0VcdThGQzdcdTZFRTRcdTU2NjhcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBhc3luYyBsb2FkVGFncygpIHtcclxuICAgICAgICBjb25zdCB0YWdzID0gdGhpcy5nZXRBbGxUYWdzKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwIFwiQWxsXCIgXHU2ODA3XHU3QjdFXHJcbiAgICAgICAgY29uc3QgYWxsVGFnQnRuID0gdGhpcy50YWdDb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgXHJcbiAgICAgICAgICAgIHRleHQ6ICdBbGwnLFxyXG4gICAgICAgICAgICBjbHM6ICd0YWctYnRuIGFjdGl2ZScgIC8vIFx1OUVEOFx1OEJBNFx1OTAwOVx1NEUyRFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGFsbFRhZ0J0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jbGVhclRhZ1NlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICBhbGxUYWdCdG4uYWRkQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgICAgICB0aGlzLnJlZnJlc2hWaWV3KCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NTE3Nlx1NEVENlx1NjgwN1x1N0I3RVxyXG4gICAgICAgIHRhZ3MuZm9yRWFjaCh0YWcgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0YWdCdG4gPSB0aGlzLnRhZ0NvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyBcclxuICAgICAgICAgICAgICAgIHRleHQ6IHRhZyxcclxuICAgICAgICAgICAgICAgIGNsczogJ3RhZy1idG4nXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB0YWdCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlVGFnKHRhZywgdGFnQnRuKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBcdTgzQjdcdTUzRDZcdTYyNDBcdTY3MDlcdTdCMTRcdThCQjBcdTRFMkRcdTc2ODRcdTY4MDdcdTdCN0VcclxuICAgICAqIEByZXR1cm5zIFx1NTNCQlx1OTFDRFx1NTQwRVx1NzY4NFx1NjgwN1x1N0I3RVx1NjU3MFx1N0VDNFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGdldEFsbFRhZ3MoKTogc3RyaW5nW10ge1xyXG4gICAgICAgIGNvbnN0IHRhZ3MgPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuICAgICAgICB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgaWYgKGNhY2hlPy50YWdzKSB7XHJcbiAgICAgICAgICAgICAgICBjYWNoZS50YWdzLmZvckVhY2godGFnID0+IHRhZ3MuYWRkKHRhZy50YWcpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiBBcnJheS5mcm9tKHRhZ3MpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU1MjFCXHU1RUZBXHU4OUM2XHU1NkZFXHU1MjA3XHU2MzYyXHU2MzA5XHU5NEFFXHJcbiAgICAgKiBAcGFyYW0gY29udGFpbmVyIC0gXHU2MzA5XHU5NEFFXHU1QkI5XHU1NjY4XHU1MTQzXHU3RDIwXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgY3JlYXRlVmlld1N3aXRjaGVyKGNvbnRhaW5lcjogSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICBjb25zdCB2aWV3cyA9IFtcclxuICAgICAgICAgICAgeyBpZDogJ2NhcmQnLCBpY29uOiAnZ3JpZCcsIHRleHQ6ICdcdTUzNjFcdTcyNDdcdTg5QzZcdTU2RkUnIH0sXHJcbiAgICAgICAgICAgIHsgaWQ6ICdsaXN0JywgaWNvbjogJ2xpc3QnLCB0ZXh0OiAnXHU1MjE3XHU4ODY4XHU4OUM2XHU1NkZFJyB9LFxyXG4gICAgICAgICAgICB7IGlkOiAndGltZWxpbmUnLCBpY29uOiAnY2xvY2snLCB0ZXh0OiAnXHU2NUY2XHU5NUY0XHU4Rjc0XHU4OUM2XHU1NkZFJyB9XHJcbiAgICAgICAgXTtcclxuICAgICAgICBcclxuICAgICAgICB2aWV3cy5mb3JFYWNoKHZpZXcgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBidG4gPSBjb250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgICAgIGNsczogYHZpZXctc3dpdGNoLWJ0biAke3ZpZXcuaWQgPT09IHRoaXMuY3VycmVudFZpZXcgPyAnYWN0aXZlJyA6ICcnfWAsXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU3NkY0XHU2M0E1XHU0RjdGXHU3NTI4IFNWRyBcdTU2RkVcdTY4MDdcclxuICAgICAgICAgICAgY29uc3QgaWNvbkh0bWwgPSB7XHJcbiAgICAgICAgICAgICAgICAnZ3JpZCc6ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PHJlY3QgeD1cIjNcIiB5PVwiM1wiIHdpZHRoPVwiN1wiIGhlaWdodD1cIjdcIj48L3JlY3Q+PHJlY3QgeD1cIjE0XCIgeT1cIjNcIiB3aWR0aD1cIjdcIiBoZWlnaHQ9XCI3XCI+PC9yZWN0PjxyZWN0IHg9XCIxNFwiIHk9XCIxNFwiIHdpZHRoPVwiN1wiIGhlaWdodD1cIjdcIj48L3JlY3Q+PHJlY3QgeD1cIjNcIiB5PVwiMTRcIiB3aWR0aD1cIjdcIiBoZWlnaHQ9XCI3XCI+PC9yZWN0Pjwvc3ZnPicsXHJcbiAgICAgICAgICAgICAgICAnbGlzdCc6ICc8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiB3aWR0aD1cIjE4XCIgaGVpZ2h0PVwiMThcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIm5vbmVcIiBzdHJva2U9XCJjdXJyZW50Q29sb3JcIiBzdHJva2Utd2lkdGg9XCIyXCIgc3Ryb2tlLWxpbmVjYXA9XCJyb3VuZFwiIHN0cm9rZS1saW5lam9pbj1cInJvdW5kXCI+PGxpbmUgeDE9XCI4XCIgeTE9XCI2XCIgeDI9XCIyMVwiIHkyPVwiNlwiPjwvbGluZT48bGluZSB4MT1cIjhcIiB5MT1cIjEyXCIgeDI9XCIyMVwiIHkyPVwiMTJcIj48L2xpbmU+PGxpbmUgeDE9XCI4XCIgeTE9XCIxOFwiIHgyPVwiMjFcIiB5Mj1cIjE4XCI+PC9saW5lPjxsaW5lIHgxPVwiM1wiIHkxPVwiNlwiIHgyPVwiMy4wMVwiIHkyPVwiNlwiPjwvbGluZT48bGluZSB4MT1cIjNcIiB5MT1cIjEyXCIgeDI9XCIzLjAxXCIgeTI9XCIxMlwiPjwvbGluZT48bGluZSB4MT1cIjNcIiB5MT1cIjE4XCIgeDI9XCIzLjAxXCIgeTI9XCIxOFwiPjwvbGluZT48L3N2Zz4nLFxyXG4gICAgICAgICAgICAgICAgJ2Nsb2NrJzogJzxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMThcIiBoZWlnaHQ9XCIxOFwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48Y2lyY2xlIGN4PVwiMTJcIiBjeT1cIjEyXCIgcj1cIjEwXCI+PC9jaXJjbGU+PHBvbHlsaW5lIHBvaW50cz1cIjEyIDYgMTIgMTIgMTYgMTRcIj48L3BvbHlsaW5lPjwvc3ZnPidcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NTZGRVxyXG4gICAgICAgICAgICBjb25zdCBpY29uU3BhbiA9IGJ0bi5jcmVhdGVTcGFuKHsgY2xzOiAndmlldy1zd2l0Y2gtaWNvbicgfSk7XHJcbiAgICAgICAgICAgIGljb25TcGFuLmlubmVySFRNTCA9IGljb25IdG1sW3ZpZXcuaWNvbl07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTY1ODdcdTVCNTdcclxuICAgICAgICAgICAgYnRuLmNyZWF0ZVNwYW4oeyB0ZXh0OiB2aWV3LnRleHQsIGNsczogJ3ZpZXctc3dpdGNoLXRleHQnIH0pO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgYnRuLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy52aWV3LXN3aXRjaC1idG4nKS5mb3JFYWNoKGIgPT4gYi5yZW1vdmVDbGFzcygnYWN0aXZlJykpO1xyXG4gICAgICAgICAgICAgICAgYnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc3dpdGNoVmlldyh2aWV3LmlkIGFzICdjYXJkJyB8ICdsaXN0JyB8ICd0aW1lbGluZScpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTJBMFx1OEY3RFx1NjI0MFx1NjcwOVx1N0IxNFx1OEJCMFx1NUU3Nlx1NTIxQlx1NUVGQVx1NTM2MVx1NzI0N1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFzeW5jIGxvYWROb3RlcygpIHtcclxuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5lbXB0eSgpO1xyXG5cclxuICAgICAgICAvLyBcdTRGN0ZcdTc1MjggUHJvbWlzZS5hbGwgXHU3QjQ5XHU1Rjg1XHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU1MjFCXHU1RUZBXHU1QjhDXHU2MjEwXHJcbiAgICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuICAgICAgICAgICAgZmlsZXMubWFwKGZpbGUgPT4gdGhpcy5jcmVhdGVOb3RlQ2FyZChmaWxlKSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTYyNDBcdTY3MDlcdTUzNjFcdTcyNDdcdTUyMzBcdTVCQjlcdTU2NjhcdUZGMENcdTVFNzZcdThCQkVcdTdGNkVcdTZCNjNcdTc4NkVcdTc2ODRcdTVCQkRcdTVFQTZcclxuICAgICAgICBjYXJkcy5mb3JFYWNoKGNhcmQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoY2FyZCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50KSB7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnN0eWxlLndpZHRoID0gYCR7dGhpcy5jYXJkU2l6ZX1weGA7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChjYXJkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTc4NkVcdTRGRERcdTVCQjlcdTU2NjhcdTRGN0ZcdTc1MjhcdTZCNjNcdTc4NkVcdTc2ODRcdTdGNTFcdTY4M0NcdTUyMTdcdTVCQkRcdTVFQTZcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdChhdXRvLWZpbGwsICR7dGhpcy5jYXJkU2l6ZX1weClgO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHU1MjFCXHU1RUZBXHU1MzU1XHU0RTJBXHU3QjE0XHU4QkIwXHU1MzYxXHU3MjQ3XHJcbiAgICAgKiBAcGFyYW0gZmlsZSAtIFx1N0IxNFx1OEJCMFx1NjU4N1x1NEVGNlxyXG4gICAgICogQHJldHVybnMgXHU1MzYxXHU3MjQ3SFRNTFx1NTE0M1x1N0QyMFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZU5vdGVDYXJkKGZpbGU6IFRGaWxlKTogUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuICAgICAgICBjYXJkLmFkZENsYXNzKCdub3RlLWNhcmQnKTtcclxuICAgICAgICBjYXJkLnNldEF0dHJpYnV0ZSgnZGF0YS1wYXRoJywgZmlsZS5wYXRoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTUzNjFcdTcyNDdcdTU5MzRcdTkwRThcclxuICAgICAgICBjb25zdCBoZWFkZXIgPSBjYXJkLmNyZWF0ZURpdignbm90ZS1jYXJkLWhlYWRlcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1NEZFRVx1NjUzOVx1NjVGNlx1OTVGNFxyXG4gICAgICAgIGNvbnN0IGxhc3RNb2RpZmllZCA9IGhlYWRlci5jcmVhdGVEaXYoJ25vdGUtZGF0ZScpO1xyXG4gICAgICAgIGxhc3RNb2RpZmllZC5zZXRUZXh0KG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCkpO1xyXG5cclxuICAgICAgICAvLyBcdTRGRUVcdTY1MzlcdTY1ODdcdTRFRjZcdTU5MzlcdThERUZcdTVGODRcdTc2ODRcdTUyMUJcdTVFRkFcdTU0OENcdTY4MzdcdTVGMEZcclxuICAgICAgICBjb25zdCBmb2xkZXJQYXRoID0gaGVhZGVyLmNyZWF0ZURpdignbm90ZS1mb2xkZXInKTtcclxuICAgICAgICBjb25zdCBmb2xkZXIgPSBmaWxlLnBhcmVudCA/IChmaWxlLnBhcmVudC5wYXRoID09PSAnLycgPyAnXHU2ODM5XHU3NkVFXHU1RjU1JyA6IGZpbGUucGFyZW50LnBhdGgpIDogJ1x1NjgzOVx1NzZFRVx1NUY1NSc7XHJcbiAgICAgICAgZm9sZGVyUGF0aC5zZXRUZXh0KGZvbGRlcik7XHJcbiAgICAgICAgZm9sZGVyUGF0aC5zZXRBdHRyaWJ1dGUoJ3RpdGxlJywgYFx1NjI1M1x1NUYwMFx1NjU4N1x1NEVGNlx1NTkzOTogJHtmb2xkZXJ9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU3MEI5XHU1MUZCXHU0RThCXHU0RUY2XHJcbiAgICAgICAgZm9sZGVyUGF0aC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jIChlKSA9PiB7XHJcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgIC8vIFx1NjI1M1x1NUYwMFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICBjb25zdCBmaWxlRXhwbG9yZXIgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhdmVzT2ZUeXBlKCdmaWxlLWV4cGxvcmVyJylbMF07XHJcbiAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVFeHBsb3JlclZpZXcgPSBmaWxlRXhwbG9yZXIudmlldyBhcyBhbnk7XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUV4cGxvcmVyVmlldy5leHBhbmRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnJldmVhbEZvbGRlckluRXhwbG9yZXIoZm9sZGVyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBcdTgwNUFcdTcxMjZcdTUyMzBcdTY1ODdcdTRFRjZcdTZENEZcdTg5QzhcdTU2NjhcclxuICAgICAgICAgICAgICAgICAgICBmaWxlRXhwbG9yZXIuc2V0RXBoZW1lcmFsU3RhdGUoeyBmb2N1czogdHJ1ZSB9KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICBjb25zdCBvcGVuQnV0dG9uID0gaGVhZGVyLmNyZWF0ZURpdignbm90ZS1vcGVuLWJ1dHRvbicpO1xyXG4gICAgICAgIG9wZW5CdXR0b24uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBkPVwiTTE4IDEzdjZhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJWOGEyIDIgMCAwIDEgMi0yaDZcIj48L3BhdGg+PHBvbHlsaW5lIHBvaW50cz1cIjE1IDMgMjEgMyAyMSA5XCI+PC9wb2x5bGluZT48bGluZSB4MT1cIjEwXCIgeTE9XCIxNFwiIHgyPVwiMjFcIiB5Mj1cIjNcIj48L2xpbmU+PC9zdmc+YDtcclxuICAgICAgICBvcGVuQnV0dG9uLnNldEF0dHJpYnV0ZSgndGl0bGUnLCAnXHU1NzI4XHU2NUIwXHU2ODA3XHU3QjdFXHU5ODc1XHU0RTJEXHU2MjUzXHU1RjAwJyk7XHJcbiAgICAgICAgb3BlbkJ1dHRvbi5zdHlsZS5vcGFjaXR5ID0gJzAnOyAgLy8gXHU5RUQ4XHU4QkE0XHU5NjkwXHU4NUNGXHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NTM2MVx1NzI0N1x1NTE4NVx1NUJCOVx1NUJCOVx1NTY2OFxyXG4gICAgICAgIGNvbnN0IGNhcmRDb250ZW50ID0gY2FyZC5jcmVhdGVEaXYoJ25vdGUtY2FyZC1jb250ZW50Jyk7XHJcblxyXG4gICAgICAgIC8vIFx1NTkwNFx1NzQwNlx1NjgwN1x1OTg5OFx1RkYwOFx1NzlGQlx1NTIzMFx1NTE4NVx1NUJCOVx1NTMzQVx1NTdERlx1OTg3Nlx1OTBFOFx1RkYwOVxyXG4gICAgICAgIGNvbnN0IHRpdGxlID0gY2FyZENvbnRlbnQuY3JlYXRlRGl2KCdub3RlLXRpdGxlJyk7XHJcbiAgICAgICAgbGV0IGRpc3BsYXlUaXRsZSA9IGZpbGUuYmFzZW5hbWU7XHJcbiAgICAgICAgLy8gXHU1OTA0XHU3NDA2XHU2NUU1XHU2NzFGXHU1RjAwXHU1OTM0XHU3Njg0XHU2ODA3XHU5ODk4XHJcbiAgICAgICAgY29uc3QgdGltZVBhdHRlcm4gPSAvXlxcZHs0fVstLi9dXFxkezJ9Wy0uL11cXGR7Mn0vO1xyXG4gICAgICAgIGlmICh0aW1lUGF0dGVybi50ZXN0KGRpc3BsYXlUaXRsZSkpIHtcclxuICAgICAgICAgICAgZGlzcGxheVRpdGxlID0gZGlzcGxheVRpdGxlLnJlcGxhY2UodGltZVBhdHRlcm4sICcnKS50cmltKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRpdGxlLnNldFRleHQoZGlzcGxheVRpdGxlKTtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gXHU4QkZCXHU1M0Q2XHU3QjE0XHU4QkIwXHU1MTg1XHU1QkI5XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU3QjE0XHU4QkIwXHU1MTg1XHU1QkI5XHU1QkI5XHU1NjY4XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdGVDb250ZW50ID0gY2FyZENvbnRlbnQuY3JlYXRlRGl2KCdub3RlLWNvbnRlbnQnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NkUzMlx1NjdEMyBNYXJrZG93biBcdTUxODVcdTVCQjlcclxuICAgICAgICAgICAgYXdhaXQgTWFya2Rvd25SZW5kZXJlci5yZW5kZXJNYXJrZG93bihcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICBub3RlQ29udGVudCxcclxuICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgIHRoaXNcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1OUYyMFx1NjgwN1x1NjBBQ1x1NTA1Q1x1NEU4Qlx1NEVGNlxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBvcGVuQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMSc7ICAvLyBcdTY2M0VcdTc5M0FcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICAgICAgICAgIHRpdGxlLnN0eWxlLm9wYWNpdHkgPSAnMCc7XHJcbiAgICAgICAgICAgICAgICBub3RlQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgLy8gXHU1NzI4XHU5ODg0XHU4OUM4XHU2ODBGXHU0RTJEXHU2NjNFXHU3OTNBXHU1QjhDXHU2NTc0XHU1MTg1XHU1QkI5XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IE1hcmtkb3duUmVuZGVyZXIucmVuZGVyTWFya2Rvd24oXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignXHU5ODg0XHU4OUM4XHU1MkEwXHU4RjdEXHU1OTMxXHU4RDI1OicsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBvcGVuQnV0dG9uLnN0eWxlLm9wYWNpdHkgPSAnMCc7ICAvLyBcdTk2OTBcdTg1Q0ZcdTYyNTNcdTVGMDBcdTYzMDlcdTk0QUVcclxuICAgICAgICAgICAgICAgIHRpdGxlLnN0eWxlLm9wYWNpdHkgPSAnMSc7XHJcbiAgICAgICAgICAgICAgICBub3RlQ29udGVudC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NEZFRVx1NjUzOVx1NEU4Qlx1NEVGNlx1NzZEMVx1NTQyQ1xyXG4gICAgICAgICAgICBvcGVuQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgYXN5bmMgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTUzNTVcdTUxRkJcdTkwMDlcdTYyRTlcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLmhhbmRsZUNhcmRTZWxlY3Rpb24oZmlsZS5wYXRoLCBlKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTUzQ0NcdTUxRkJcdTYyNTNcdTVGMDBcclxuICAgICAgICAgICAgY2FyZC5hZGRFdmVudExpc3RlbmVyKCdkYmxjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZigndGFiJyk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NTNGM1x1OTUyRVx1ODNEQ1x1NTM1NVxyXG4gICAgICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgKGUpID0+IHtcclxuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2hvd0NvbnRleHRNZW51KGUsIHRoaXMuZ2V0U2VsZWN0ZWRGaWxlcygpKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1x1N0IxNFx1OEJCMFx1NTJBMFx1OEY3RFx1NTkzMVx1OEQyNTonLCBlcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTUzNjFcdTcyNDdcdTYwQUNcdTUwNUNcdTRFOEJcdTRFRjZcclxuICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlZW50ZXInLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcxJzsgIC8vIFx1NjYzRVx1NzkzQVx1NjI1M1x1NUYwMFx1NjMwOVx1OTRBRVxyXG4gICAgICAgICAgICAvLyAuLi4gXHU1MTc2XHU0RUQ2XHU2MEFDXHU1MDVDXHU0RThCXHU0RUY2XHU0RUUzXHU3ODAxIC4uLlxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbGVhdmUnLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIG9wZW5CdXR0b24uc3R5bGUub3BhY2l0eSA9ICcwJzsgIC8vIFx1OTY5MFx1ODVDRlx1NjI1M1x1NUYwMFx1NjMwOVx1OTRBRVxyXG4gICAgICAgICAgICAvLyAuLi4gXHU1MTc2XHU0RUQ2XHU3OUJCXHU1RjAwXHU0RThCXHU0RUY2XHU0RUUzXHU3ODAxIC4uLlxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gY2FyZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NTIwN1x1NjM2Mlx1ODlDNlx1NTZGRVx1NkEyMVx1NUYwRlxyXG4gICAgICogQHBhcmFtIHZpZXcgLSBcdTc2RUVcdTY4MDdcdTg5QzZcdTU2RkVcdTZBMjFcdTVGMEZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzd2l0Y2hWaWV3KHZpZXc6ICdjYXJkJyB8ICdsaXN0JyB8ICd0aW1lbGluZScpIHtcclxuICAgICAgICB0aGlzLmN1cnJlbnRWaWV3ID0gdmlldztcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zZXRBdHRyaWJ1dGUoJ2RhdGEtdmlldycsIHZpZXcpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmVtcHR5KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKHZpZXcgPT09ICd0aW1lbGluZScpIHtcclxuICAgICAgICAgICAgdGhpcy5jcmVhdGVUaW1lbGluZVZpZXcoKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmxvYWROb3RlcygpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFx1NjgzOVx1NjM2RVx1NjgwN1x1N0I3RVx1OEZDN1x1NkVFNFx1N0IxNFx1OEJCMFxyXG4gICAgICogQHBhcmFtIHRhZyAtIFx1NjgwN1x1N0I3RVx1NTQwRFx1NzlGMFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIGFzeW5jIGZpbHRlckJ5VGFnKHRhZzogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIuZW1wdHkoKTtcclxuXHJcbiAgICAgICAgY29uc3QgZmlsdGVyZWRGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IHtcclxuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlPy50YWdzPy5zb21lKHQgPT4gdC50YWcgPT09IHRhZyk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NEY3Rlx1NzUyOCBQcm9taXNlLmFsbCBcdTdCNDlcdTVGODVcdTYyNDBcdTY3MDlcdTUzNjFcdTcyNDdcdTUyMUJcdTVFRkFcdTVCOENcdTYyMTBcclxuICAgICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IFByb21pc2UuYWxsKFxyXG4gICAgICAgICAgICBmaWx0ZXJlZEZpbGVzLm1hcChmaWxlID0+IHRoaXMuY3JlYXRlTm90ZUNhcmQoZmlsZSkpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2MjQwXHU2NzA5XHU1MzYxXHU3MjQ3XHU1MjMwXHU1QkI5XHU1NjY4XHJcbiAgICAgICAgY2FyZHMuZm9yRWFjaChjYXJkID0+IHtcclxuICAgICAgICAgICAgdGhpcy5jb250YWluZXIuYXBwZW5kQ2hpbGQoY2FyZCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1OUFEOFx1NEVBRVx1OTAwOVx1NEUyRFx1NzY4NFx1NjgwN1x1N0I3RVxyXG4gICAgICAgIHRoaXMudGFnQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJ2J1dHRvbicpLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgaWYgKGJ0bi50ZXh0Q29udGVudCA9PT0gdGFnKSB7XHJcbiAgICAgICAgICAgICAgICBidG4uYWRkQ2xhc3MoJ2FjdGl2ZS10YWcnKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIGJ0bi5yZW1vdmVDbGFzcygnYWN0aXZlLXRhZycpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSB0b2dnbGVQcmV2aWV3KCkge1xyXG4gICAgICAgIHRoaXMuaXNQcmV2aWV3Q29sbGFwc2VkID0gIXRoaXMuaXNQcmV2aWV3Q29sbGFwc2VkO1xyXG4gICAgICAgIGlmICh0aGlzLmlzUHJldmlld0NvbGxhcHNlZCkge1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIuYWRkQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lci5yZW1vdmVDbGFzcygnY29sbGFwc2VkJyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2V0dXBSZXNpemVyKCkge1xyXG4gICAgICAgIGxldCBzdGFydFg6IG51bWJlcjtcclxuICAgICAgICBsZXQgc3RhcnRXaWR0aDogbnVtYmVyO1xyXG5cclxuICAgICAgICBjb25zdCBzdGFydFJlc2l6ZSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICAgICAgc3RhcnRYID0gZS5wYWdlWDtcclxuICAgICAgICAgICAgc3RhcnRXaWR0aCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5wcmV2aWV3Q29udGFpbmVyKS53aWR0aCwgMTApO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCByZXNpemUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgc3RvcFJlc2l6ZSk7XHJcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc3R5bGUuY3Vyc29yID0gJ2NvbC1yZXNpemUnO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXdSZXNpemVyLmFkZENsYXNzKCdyZXNpemluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc2l6ZSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IHdpZHRoID0gc3RhcnRXaWR0aCAtIChlLnBhZ2VYIC0gc3RhcnRYKTtcclxuICAgICAgICAgICAgaWYgKHdpZHRoID49IDUwICYmIHdpZHRoIDw9IDgwMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLnN0eWxlLndpZHRoID0gYCR7d2lkdGh9cHhgO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaXNQcmV2aWV3Q29sbGFwc2VkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pc1ByZXZpZXdDb2xsYXBzZWQgPSBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnByZXZpZXdDb250YWluZXIucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgY29uc3Qgc3RvcFJlc2l6ZSA9ICgpID0+IHtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vtb3ZlJywgcmVzaXplKTtcclxuICAgICAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHN0b3BSZXNpemUpO1xyXG4gICAgICAgICAgICBkb2N1bWVudC5ib2R5LnN0eWxlLmN1cnNvciA9ICcnO1xyXG4gICAgICAgICAgICB0aGlzLnByZXZpZXdSZXNpemVyLnJlbW92ZUNsYXNzKCdyZXNpemluZycpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIHRoaXMucHJldmlld1Jlc2l6ZXIuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3RhcnRSZXNpemUpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgaGlnaGxpZ2h0Rm9sZGVyKGZvbGRlcjogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50Rm9sZGVyID0gdGhpcy5jdXJyZW50Rm9sZGVyID09PSBmb2xkZXIgPyBudWxsIDogZm9sZGVyO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3RlLWNhcmQnKS5mb3JFYWNoKGNhcmQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBmb2xkZXJFbGVtZW50ID0gY2FyZC5xdWVyeVNlbGVjdG9yKCcubm90ZS1mb2xkZXInKTtcclxuICAgICAgICAgICAgY29uc3QgY2FyZEZvbGRlciA9IGZvbGRlckVsZW1lbnQgPyBmb2xkZXJFbGVtZW50LnRleHRDb250ZW50IDogbnVsbDtcclxuICAgICAgICAgICAgaWYgKGNhcmRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIGNhcmQudG9nZ2xlQ2xhc3MoJ2ZvbGRlci1oaWdobGlnaHQnLCBjYXJkRm9sZGVyID09PSBmb2xkZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyByZXZlYWxGb2xkZXJJbkV4cGxvcmVyKGZvbGRlcjogc3RyaW5nKSB7XHJcbiAgICAgICAgLy8gXHU4M0I3XHU1M0Q2XHU2NTg3XHU0RUY2XHU2RDRGXHU4OUM4XHU1NjY4XHU4OUM2XHU1NkZFXHJcbiAgICAgICAgY29uc3QgZmlsZUV4cGxvcmVyID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYXZlc09mVHlwZSgnZmlsZS1leHBsb3JlcicpWzBdO1xyXG4gICAgICAgIGlmIChmaWxlRXhwbG9yZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgZmlsZUV4cGxvcmVyVmlldyA9IGZpbGVFeHBsb3Jlci52aWV3IGFzIGFueTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTk4Mlx1Njc5Q1x1NjYyRlx1NjgzOVx1NzZFRVx1NUY1NVx1RkYwQ1x1NzZGNFx1NjNBNVx1NUM1NVx1NUYwMFx1NjgzOVx1NzZFRVx1NUY1NVxyXG4gICAgICAgICAgICBpZiAoZm9sZGVyID09PSAnXHU2ODM5XHU3NkVFXHU1RjU1Jykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGZpbGVFeHBsb3JlclZpZXcuZXhwYW5kRm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgZmlsZUV4cGxvcmVyVmlldy5leHBhbmRGb2xkZXIoJy8nKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gXHU1QzU1XHU1RjAwXHU1RTc2XHU5MDA5XHU0RTJEXHU2NTg3XHU0RUY2XHU1OTM5XHJcbiAgICAgICAgICAgIGlmIChmaWxlRXhwbG9yZXJWaWV3LmV4cGFuZEZvbGRlcikge1xyXG4gICAgICAgICAgICAgICAgLy8gXHU1QzU1XHU1RjAwXHU3MjM2XHU2NTg3XHU0RUY2XHU1OTM5XHU4REVGXHJcbiAgICAgICAgICAgICAgICBjb25zdCBmb2xkZXJQYXJ0cyA9IGZvbGRlci5zcGxpdCgnLycpO1xyXG4gICAgICAgICAgICAgICAgbGV0IGN1cnJlbnRQYXRoID0gJyc7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIC8vIFx1OTAxMFx1N0VBN1x1NUM1NVx1NUYwMFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgICAgICAgICAgZm9yIChjb25zdCBwYXJ0IG9mIGZvbGRlclBhcnRzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudFBhdGggKz0gKGN1cnJlbnRQYXRoID8gJy8nIDogJycpICsgcGFydDtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlRXhwbG9yZXJWaWV3LmV4cGFuZEZvbGRlcihjdXJyZW50UGF0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gXHU5MDA5XHU0RTJEXHU3NkVFXHU2ODA3XHU2NTg3XHU0RUY2XHU1OTM5XHJcbiAgICAgICAgICAgICAgICBpZiAoZmlsZUV4cGxvcmVyVmlldy5zZXRTZWxlY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICBhd2FpdCBmaWxlRXhwbG9yZXJWaWV3LnNldFNlbGVjdGlvbihmb2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlTmV3Tm90ZSgpIHtcclxuICAgICAgICAvLyBcdTgzQjdcdTUzRDZcdTVGNTNcdTUyNERcdTY1RTVcdTY3MUZcdTRGNUNcdTRFM0FcdTlFRDhcdThCQTRcdTY1ODdcdTRFRjZcdTU0MERcclxuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcclxuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IGBcdTY3MkFcdTU0N0RcdTU0MERcdTdCMTRcdThCQjAgJHtkYXRlLnRvTG9jYWxlU3RyaW5nKCkucmVwbGFjZSgvWy86XS9nLCAnLScpfWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gXHU1MjFCXHU1RUZBXHU2NUIwXHU3QjE0XHU4QkIwXHJcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoXHJcbiAgICAgICAgICAgICAgICBgJHtmaWxlTmFtZX0ubWRgLFxyXG4gICAgICAgICAgICAgICAgJyMgJyArIGZpbGVOYW1lICsgJ1xcblxcbidcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTcyOFx1NjVCMFx1NjgwN1x1N0I3RVx1OTg3NVx1NEUyRFx1NjI1M1x1NUYwMFx1N0IxNFx1OEJCMFxyXG4gICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoJ3RhYicpO1xyXG4gICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1MjM3XHU2NUIwXHU1MzYxXHU3MjQ3XHU4OUM2XHU1NkZFXHJcbiAgICAgICAgICAgIHRoaXMubG9hZE5vdGVzKCk7XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcignXHU1MjFCXHU1RUZBXHU3QjE0XHU4QkIwXHU1OTMxXHU4RDI1OicsIGVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBjcmVhdGVUaW1lbGluZVZpZXcoKSB7XHJcbiAgICAgICAgY29uc3QgdGltZWxpbmVDb250YWluZXIgPSB0aGlzLmNvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFx1ODNCN1x1NTNENlx1NjI0MFx1NjcwOVx1N0IxNFx1OEJCMFx1NUU3Nlx1NjMwOVx1NjVFNVx1NjcxRlx1NTIwNlx1N0VDNFxyXG4gICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0TWFya2Rvd25GaWxlcygpO1xyXG4gICAgICAgIGNvbnN0IG5vdGVzQnlEYXRlID0gbmV3IE1hcDxzdHJpbmcsIFRGaWxlW10+KCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZmlsZXMuZm9yRWFjaChmaWxlID0+IHtcclxuICAgICAgICAgICAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGZpbGUuc3RhdC5tdGltZSkudG9Mb2NhbGVEYXRlU3RyaW5nKCk7XHJcbiAgICAgICAgICAgIGlmICghbm90ZXNCeURhdGUuaGFzKGRhdGUpKSB7XHJcbiAgICAgICAgICAgICAgICBub3Rlc0J5RGF0ZS5zZXQoZGF0ZSwgW10pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IG5vdGVzID0gbm90ZXNCeURhdGUuZ2V0KGRhdGUpO1xyXG4gICAgICAgICAgICBpZiAobm90ZXMpIHtcclxuICAgICAgICAgICAgICAgIG5vdGVzLnB1c2goZmlsZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gXHU2MzA5XHU2NUU1XHU2NzFGXHU2MzkyXHU1RThGXHJcbiAgICAgICAgY29uc3Qgc29ydGVkRGF0ZXMgPSBBcnJheS5mcm9tKG5vdGVzQnlEYXRlLmtleXMoKSkuc29ydCgoYSwgYikgPT4gXHJcbiAgICAgICAgICAgIG5ldyBEYXRlKGIpLmdldFRpbWUoKSAtIG5ldyBEYXRlKGEpLmdldFRpbWUoKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjVGNlx1OTVGNFx1OEY3NFxyXG4gICAgICAgIGZvciAoY29uc3QgZGF0ZSBvZiBzb3J0ZWREYXRlcykge1xyXG4gICAgICAgICAgICBjb25zdCBkYXRlR3JvdXAgPSB0aW1lbGluZUNvbnRhaW5lci5jcmVhdGVEaXYoJ3RpbWVsaW5lLWRhdGUtZ3JvdXAnKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjVFNVx1NjcxRlx1ODI4Mlx1NzBCOVxyXG4gICAgICAgICAgICBjb25zdCBkYXRlTm9kZSA9IGRhdGVHcm91cC5jcmVhdGVEaXYoJ3RpbWVsaW5lLWRhdGUtbm9kZScpO1xyXG4gICAgICAgICAgICBkYXRlTm9kZS5jcmVhdGVEaXYoJ3RpbWVsaW5lLW5vZGUtY2lyY2xlJyk7XHJcbiAgICAgICAgICAgIGRhdGVOb2RlLmNyZWF0ZURpdigndGltZWxpbmUtZGF0ZS1sYWJlbCcpLnNldFRleHQoZGF0ZSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTdCMTRcdThCQjBcdTUyMTdcdTg4NjhcclxuICAgICAgICAgICAgY29uc3Qgbm90ZXNMaXN0ID0gZGF0ZUdyb3VwLmNyZWF0ZURpdigndGltZWxpbmUtbm90ZXMtbGlzdCcpO1xyXG4gICAgICAgICAgICBjb25zdCBub3RlcyA9IG5vdGVzQnlEYXRlLmdldChkYXRlKTtcclxuICAgICAgICAgICAgaWYgKG5vdGVzKSB7XHJcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2Ygbm90ZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlSXRlbSA9IG5vdGVzTGlzdC5jcmVhdGVEaXYoJ3RpbWVsaW5lLW5vdGUtaXRlbScpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFx1NTIxQlx1NUVGQVx1NjgwN1x1OEJCMFx1N0VCRlxyXG4gICAgICAgICAgICAgICAgICAgIG5vdGVJdGVtLmNyZWF0ZURpdigndGltZWxpbmUtbm90ZS1tYXJrZXInKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyBcdTUyMUJcdTVFRkFcdTdCMTRcdThCQjBcdTUxODVcdTVCQjlcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBub3RlQ29udGVudCA9IG5vdGVJdGVtLmNyZWF0ZURpdigndGltZWxpbmUtbm90ZS1jb250ZW50Jyk7XHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZUNvbnRlbnQuY3JlYXRlRGl2KCd0aW1lbGluZS1ub3RlLXRpdGxlJykuc2V0VGV4dChmaWxlLmJhc2VuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTcwQjlcdTUxRkJcdTRFOEJcdTRFRjZcclxuICAgICAgICAgICAgICAgICAgICBub3RlSXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU5ODg0XHU4OUM4XHU1MjlGXHU4MEZEXHJcbiAgICAgICAgICAgICAgICAgICAgbm90ZUl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignbW91c2VlbnRlcicsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHJldmlld0NvbnRhaW5lci5lbXB0eSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCBNYXJrZG93blJlbmRlcmVyLnJlbmRlck1hcmtkb3duKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aWV3Q29udGFpbmVyLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUucGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignXHU5ODg0XHU4OUM4XHU1MkEwXHU4RjdEXHU1OTMxXHU4RDI1OicsIGVycm9yKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NkRGQlx1NTJBMFx1NTNGM1x1OTUyRVx1ODNEQ1x1NTM1NVx1NTI5Rlx1ODBGRFxyXG4gICAgcHJpdmF0ZSBhZGRDb250ZXh0TWVudShjYXJkOiBIVE1MRWxlbWVudCwgZmlsZTogVEZpbGUpIHtcclxuICAgICAgICBjYXJkLmFkZEV2ZW50TGlzdGVuZXIoJ2NvbnRleHRtZW51JywgKGV2ZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gXHU1OTgyXHU2NzlDXHU3MEI5XHU1MUZCXHU3Njg0XHU1MzYxXHU3MjQ3XHU2Q0ExXHU2NzA5XHU4OEFCXHU5MDA5XHU0RTJEXHVGRjBDXHU0RTE0XHU2Q0ExXHU2NzA5XHU2MzA5XHU0RjRGIEN0cmwgXHU5NTJFXHVGRjBDXHJcbiAgICAgICAgICAgIC8vIFx1NTIxOVx1NkUwNVx1OTY2NFx1NTE3Nlx1NEVENlx1OTAwOVx1NjJFOVx1NUU3Nlx1OTAwOVx1NEUyRFx1NUY1M1x1NTI0RFx1NTM2MVx1NzI0N1xyXG4gICAgICAgICAgICBjb25zdCBwYXRoID0gY2FyZC5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpO1xyXG4gICAgICAgICAgICBpZiAocGF0aCAmJiAhdGhpcy5zZWxlY3RlZE5vdGVzLmhhcyhwYXRoKSAmJiAhZXZlbnQuY3RybEtleSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vdGVzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgICAgIGNhcmQuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHNlbGVjdGVkRmlsZXMgPSB0aGlzLmdldFNlbGVjdGVkRmlsZXMoKTtcclxuICAgICAgICAgICAgdGhpcy5zaG93Q29udGV4dE1lbnUoZXZlbnQsIHNlbGVjdGVkRmlsZXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NTIzN1x1NjVCMFx1ODlDNlx1NTZGRVx1RkYwOFx1NzUyOFx1NEU4RVx1NjQxQ1x1N0QyMlx1NTQ4Q1x1OEZDN1x1NkVFNFx1RkYwOVxyXG4gICAgcHJpdmF0ZSBhc3luYyByZWZyZXNoVmlldygpIHtcclxuICAgICAgICBjb25zdCBmaWxlcyA9IHRoaXMuYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5lbXB0eSgpO1xyXG5cclxuICAgICAgICBjb25zdCBmaWx0ZXJlZEZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICAvLyBcdTY0MUNcdTdEMjJcdThGQzdcdTZFRTRcclxuICAgICAgICAgICAgY29uc3QgbWF0Y2hlc1NlYXJjaCA9ICF0aGlzLmN1cnJlbnRTZWFyY2hUZXJtIHx8IFxyXG4gICAgICAgICAgICAgICAgZmlsZS5iYXNlbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHRoaXMuY3VycmVudFNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSk7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTY4MDdcdTdCN0VcdThGQzdcdTZFRTRcclxuICAgICAgICAgICAgbGV0IG1hdGNoZXNUYWdzID0gdHJ1ZTtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRUYWdzLnNpemUgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xyXG4gICAgICAgICAgICAgICAgbWF0Y2hlc1RhZ3MgPSBjYWNoZT8udGFncz8uc29tZSh0ID0+IHRoaXMuc2VsZWN0ZWRUYWdzLmhhcyh0LnRhZykpID8/IGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gbWF0Y2hlc1NlYXJjaCAmJiBtYXRjaGVzVGFncztcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBQcm9taXNlLmFsbChcclxuICAgICAgICAgICAgZmlsdGVyZWRGaWxlcy5tYXAoZmlsZSA9PiB0aGlzLmNyZWF0ZU5vdGVDYXJkKGZpbGUpKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGNhcmRzLmZvckVhY2goY2FyZCA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGNhcmQuc3R5bGUud2lkdGggPSBgJHt0aGlzLmNhcmRTaXplfXB4YDtcclxuICAgICAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKGNhcmQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1Nzg2RVx1NEZERFx1NUJCOVx1NTY2OFx1NEY3Rlx1NzUyOFx1NkI2M1x1Nzg2RVx1NzY4NFx1N0Y1MVx1NjgzQ1x1NTIxN1x1NUJCRFx1NUVBNlxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnN0eWxlLmdyaWRUZW1wbGF0ZUNvbHVtbnMgPSBgcmVwZWF0KGF1dG8tZmlsbCwgJHt0aGlzLmNhcmRTaXplfXB4KWA7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU2REZCXHU1MkEwXHU2ODA3XHU3QjdFXHU1MjA3XHU2MzYyXHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIHRvZ2dsZVRhZyh0YWc6IHN0cmluZywgdGFnQnRuOiBIVE1MRWxlbWVudCkge1xyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGVkVGFncy5oYXModGFnKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGFncy5kZWxldGUodGFnKTtcclxuICAgICAgICAgICAgdGFnQnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkVGFncy5hZGQodGFnKTtcclxuICAgICAgICAgICAgdGFnQnRuLmFkZENsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFx1NTNENlx1NkQ4OCBcIkFsbFwiIFx1NjgwN1x1N0I3RVx1NzY4NFx1OTAwOVx1NEUyRFx1NzJCNlx1NjAwMVxyXG4gICAgICAgIGNvbnN0IGFsbEJ0biA9IHRoaXMudGFnQ29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoJ2J1dHRvbicpO1xyXG4gICAgICAgIGlmIChhbGxCdG4pIHtcclxuICAgICAgICAgICAgYWxsQnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTZFMDVcdTk2NjRcdTY4MDdcdTdCN0VcdTkwMDlcdTYyRTlcdTY1QjlcdTZDRDVcclxuICAgIHByaXZhdGUgY2xlYXJUYWdTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZFRhZ3MuY2xlYXIoKTtcclxuICAgICAgICB0aGlzLnRhZ0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcudGFnLWJ0bicpLmZvckVhY2goYnRuID0+IHtcclxuICAgICAgICAgICAgYnRuLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTU5MDRcdTc0MDZcdTUzNjFcdTcyNDdcdTkwMDlcdTYyRTlcclxuICAgIHByaXZhdGUgaGFuZGxlQ2FyZFNlbGVjdGlvbihwYXRoOiBzdHJpbmcsIGV2ZW50OiBNb3VzZUV2ZW50KSB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3IoYFtkYXRhLXBhdGg9XCIke3BhdGh9XCJdYCk7XHJcbiAgICAgICAgaWYgKCFjYXJkKSByZXR1cm47XHJcblxyXG4gICAgICAgIGlmIChldmVudC5jdHJsS2V5KSB7XHJcbiAgICAgICAgICAgIC8vIEN0cmwgKyBcdTcwQjlcdTUxRkJcdUZGMUFcdTUyMDdcdTYzNjJcdTkwMDlcdTYyRTlcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWROb3Rlcy5oYXMocGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb3Rlcy5kZWxldGUocGF0aCk7XHJcbiAgICAgICAgICAgICAgICBjYXJkLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZE5vdGVzLmFkZChwYXRoKTtcclxuICAgICAgICAgICAgICAgIGNhcmQuYWRkQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2UgaWYgKGV2ZW50LnNoaWZ0S2V5ICYmIHRoaXMubGFzdFNlbGVjdGVkTm90ZSkge1xyXG4gICAgICAgICAgICAvLyBTaGlmdCArIFx1NzBCOVx1NTFGQlx1RkYxQVx1OEZERVx1N0VFRFx1OTAwOVx1NjJFOVxyXG4gICAgICAgICAgICBjb25zdCBjYXJkcyA9IEFycmF5LmZyb20odGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm5vdGUtY2FyZCcpKTtcclxuICAgICAgICAgICAgY29uc3QgbGFzdEluZGV4ID0gY2FyZHMuZmluZEluZGV4KGMgPT4gYy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpID09PSB0aGlzLmxhc3RTZWxlY3RlZE5vdGUpO1xyXG4gICAgICAgICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBjYXJkcy5maW5kSW5kZXgoYyA9PiBjLmdldEF0dHJpYnV0ZSgnZGF0YS1wYXRoJykgPT09IHBhdGgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnQgPSBNYXRoLm1pbihsYXN0SW5kZXgsIGN1cnJlbnRJbmRleCk7XHJcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IE1hdGgubWF4KGxhc3RJbmRleCwgY3VycmVudEluZGV4KTtcclxuXHJcbiAgICAgICAgICAgIGNhcmRzLmZvckVhY2goKGMsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNhcmRQYXRoID0gYy5nZXRBdHRyaWJ1dGUoJ2RhdGEtcGF0aCcpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGkgPj0gc3RhcnQgJiYgaSA8PSBlbmQgJiYgY2FyZFBhdGgpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZXMuYWRkKGNhcmRQYXRoKTtcclxuICAgICAgICAgICAgICAgICAgICBjLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBcdTY2NkVcdTkwMUFcdTcwQjlcdTUxRkJcdUZGMUFcdTZFMDVcdTk2NjRcdTUxNzZcdTRFRDZcdTkwMDlcdTYyRTlcdUZGMENcdTkwMDlcdTRFMkRcdTVGNTNcdTUyNERcclxuICAgICAgICAgICAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xyXG4gICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm90ZXMuYWRkKHBhdGgpO1xyXG4gICAgICAgICAgICBjYXJkLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy5sYXN0U2VsZWN0ZWROb3RlID0gcGF0aDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZFMDVcdTk2NjRcdTYyNDBcdTY3MDlcdTkwMDlcdTYyRTlcclxuICAgIHByaXZhdGUgY2xlYXJTZWxlY3Rpb24oKSB7XHJcbiAgICAgICAgdGhpcy5zZWxlY3RlZE5vdGVzLmNsZWFyKCk7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLm5vdGUtY2FyZC5zZWxlY3RlZCcpLmZvckVhY2goY2FyZCA9PiB7XHJcbiAgICAgICAgICAgIGNhcmQucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU4M0I3XHU1M0Q2XHU5MDA5XHU0RTJEXHU3Njg0XHU2NTg3XHU0RUY2XHJcbiAgICBwcml2YXRlIGdldFNlbGVjdGVkRmlsZXMoKTogVEZpbGVbXSB7XHJcbiAgICAgICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5zZWxlY3RlZE5vdGVzKVxyXG4gICAgICAgICAgICAubWFwKHBhdGggPT4gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBhdGgpKVxyXG4gICAgICAgICAgICAuZmlsdGVyKChmaWxlKTogZmlsZSBpcyBURmlsZSA9PiBmaWxlIGluc3RhbmNlb2YgVEZpbGUpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFx1NjYzRVx1NzkzQVx1NTNGM1x1OTUyRVx1ODNEQ1x1NTM1NVxyXG4gICAgcHJpdmF0ZSBzaG93Q29udGV4dE1lbnUoZXZlbnQ6IE1vdXNlRXZlbnQsIGZpbGVzOiBURmlsZVtdKSB7XHJcbiAgICAgICAgY29uc3QgbWVudSA9IG5ldyBNZW51KCk7XHJcblxyXG4gICAgICAgIGlmIChmaWxlcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgXHU1NzI4XHU2NUIwXHU2ODA3XHU3QjdFXHU5ODc1XHU2MjUzXHU1RjAwYClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcImxpbmtcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgZmlsZSBvZiBmaWxlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKCd0YWInKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IGxlYWYub3BlbkZpbGUoZmlsZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoYFx1NTcyOFx1NjU4N1x1NEVGNlx1N0JBMVx1NzQwNlx1NTY2OFx1NEUyRFx1NjYzRVx1NzkzQWApXHJcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oXCJmb2xkZXJcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBmaWxlc1swXTsgIC8vIFx1NjYzRVx1NzkzQVx1N0IyQ1x1NEUwMFx1NEUyQVx1OTAwOVx1NEUyRFx1NjU4N1x1NEVGNlx1NzY4NFx1NEY0RFx1N0Y2RVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJldmVhbEZvbGRlckluRXhwbG9yZXIoZmlsZS5wYXJlbnQ/LnBhdGggfHwgJy8nKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+IHtcclxuICAgICAgICAgICAgICAgIGl0ZW1cclxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoYFx1NzlGQlx1NTJBOCAke2ZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2YClcclxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbihcIm1vdmVcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEVuaGFuY2VkRmlsZVNlbGVjdGlvbk1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVjZW50Rm9sZGVycyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIChmb2xkZXJzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNlbnRGb2xkZXJzID0gZm9sZGVycztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaXRlbVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShgXHU1MjIwXHU5NjY0ICR7ZmlsZXMubGVuZ3RofSBcdTRFMkFcdTY1ODdcdTRFRjZgKVxyXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKFwidHJhc2hcIilcclxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpcm0gPSBhd2FpdCBuZXcgQ29uZmlybU1vZGFsKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlx1Nzg2RVx1OEJBNFx1NTIyMFx1OTY2NFwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYFx1NjYyRlx1NTQyNlx1Nzg2RVx1NUI5QVx1ODk4MVx1NTIyMFx1OTY2NFx1OTAwOVx1NEUyRFx1NzY4NCAke2ZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2XHVGRjFGYFxyXG4gICAgICAgICAgICAgICAgICAgICAgICApLnNob3coKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25maXJtKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC50cmFzaChmaWxlLCB0cnVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaFZpZXcoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIG1lbnUuc2hvd0F0TW91c2VFdmVudChldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gXHU0RkVFXHU2NTM5XHU4QzAzXHU2NTc0XHU1MzYxXHU3MjQ3XHU1OTI3XHU1QzBGXHU3Njg0XHU2NUI5XHU2Q0Q1XHJcbiAgICBwcml2YXRlIGFkanVzdENhcmRTaXplKGRlbHRhOiBudW1iZXIpIHtcclxuICAgICAgICBjb25zdCBhZGp1c3RtZW50ID0gZGVsdGEgPiAwID8gLTEwIDogMTA7XHJcbiAgICAgICAgY29uc3QgbmV3U2l6ZSA9IE1hdGgubWF4KFxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5taW5DYXJkV2lkdGgsXHJcbiAgICAgICAgICAgIE1hdGgubWluKHRoaXMucGx1Z2luLnNldHRpbmdzLm1heENhcmRXaWR0aCwgdGhpcy5jYXJkU2l6ZSArIGFkanVzdG1lbnQpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKG5ld1NpemUgIT09IHRoaXMuY2FyZFNpemUpIHtcclxuICAgICAgICAgICAgdGhpcy5jYXJkU2l6ZSA9IG5ld1NpemU7XHJcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ2FyZFNpemUobmV3U2l6ZSk7XHJcbiAgICAgICAgICAgIC8vIFx1NEZERFx1NUI1OFx1NjVCMFx1NzY4NFx1NUJCRFx1NUVBNlxyXG4gICAgICAgICAgICB0aGlzLnBsdWdpbi5zYXZlQ2FyZFdpZHRoKG5ld1NpemUpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBcdTZERkJcdTUyQTBcdTY2RjRcdTY1QjBcdTUzNjFcdTcyNDdcdTU5MjdcdTVDMEZcdTc2ODRcdTY1QjlcdTZDRDVcclxuICAgIHB1YmxpYyB1cGRhdGVDYXJkU2l6ZSh3aWR0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5jYXJkU2l6ZSA9IHdpZHRoO1xyXG4gICAgICAgIC8vIFx1NjZGNFx1NjVCMFx1NjI0MFx1NjcwOVx1NTM2MVx1NzI0N1x1NzY4NFx1NUJCRFx1NUVBNlxyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLnF1ZXJ5U2VsZWN0b3JBbGwoJy5ub3RlLWNhcmQnKS5mb3JFYWNoKChjYXJkOiBFbGVtZW50KSA9PiB7XHJcbiAgICAgICAgICAgIGlmIChjYXJkIGluc3RhbmNlb2YgSFRNTEVsZW1lbnQpIHtcclxuICAgICAgICAgICAgICAgIGNhcmQuc3R5bGUud2lkdGggPSBgJHt3aWR0aH1weGA7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBcdTY2RjRcdTY1QjBcdTVCQjlcdTU2NjhcdTc2ODRcdTdGNTFcdTY4M0NcdTUyMTdcdTVCQkRcdTVFQTZcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5zdHlsZS5ncmlkVGVtcGxhdGVDb2x1bW5zID0gYHJlcGVhdChhdXRvLWZpbGwsICR7d2lkdGh9cHgpYDtcclxuICAgIH1cclxufVxyXG5cclxuLy8gXHU2REZCXHU1MkEwXHU2NTg3XHU0RUY2XHU5MDA5XHU2MkU5XHU2QTIxXHU2MDAxXHU2ODQ2XHJcbmNsYXNzIEZpbGVTZWxlY3Rpb25Nb2RhbCBleHRlbmRzIE1vZGFsIHtcclxuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XHJcblxyXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIG9uT3BlbigpIHtcclxuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ2gzJywgeyB0ZXh0OiAnXHU5MDA5XHU2MkU5XHU3NkVFXHU2ODA3XHU2NTg3XHU0RUY2XHU1OTM5JyB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgZm9sZGVyTGlzdCA9IGNvbnRlbnRFbC5jcmVhdGVEaXYoJ2ZvbGRlci1saXN0Jyk7XHJcbiAgICAgICAgY29uc3QgZm9sZGVycyA9IHRoaXMuZ2V0Rm9sZGVycygpO1xyXG5cclxuICAgICAgICBmb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcclxuICAgICAgICAgICAgY29uc3QgaXRlbSA9IGZvbGRlckxpc3QuY3JlYXRlRGl2KCdmb2xkZXItaXRlbScpO1xyXG4gICAgICAgICAgICBpdGVtLnNldFRleHQoZm9sZGVyKTtcclxuICAgICAgICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubW92ZUZpbGUoZm9sZGVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRGb2xkZXJzKCk6IHN0cmluZ1tdIHtcclxuICAgICAgICBjb25zdCBmb2xkZXJzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgICAgdGhpcy5hcHAudmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIGZvbGRlcnMuYWRkKGZpbGUucGF0aCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShmb2xkZXJzKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIG1vdmVGaWxlKHRhcmdldEZvbGRlcjogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgbmV3UGF0aCA9IGAke3RhcmdldEZvbGRlcn0vJHt0aGlzLmZpbGUubmFtZX1gO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuYXBwLmZpbGVNYW5hZ2VyLnJlbmFtZUZpbGUodGhpcy5maWxlLCBuZXdQYXRoKTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBcdTZERkJcdTUyQTBcdTc4NkVcdThCQTRcdTVCRjlcdThCRERcdTY4NDZcclxuY2xhc3MgQ29uZmlybU1vZGFsIGV4dGVuZHMgTW9kYWwge1xyXG4gICAgcHJpdmF0ZSByZXN1bHQ6IGJvb2xlYW4gPSBmYWxzZTtcclxuICAgIHByaXZhdGUgcmVzb2x2ZVByb21pc2U6ICh2YWx1ZTogYm9vbGVhbikgPT4gdm9pZDtcclxuICAgIHByaXZhdGUgdGl0bGU6IHN0cmluZztcclxuICAgIHByaXZhdGUgbWVzc2FnZTogc3RyaW5nO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCB0aXRsZTogc3RyaW5nLCBtZXNzYWdlOiBzdHJpbmcpIHtcclxuICAgICAgICBzdXBlcihhcHApO1xyXG4gICAgICAgIHRoaXMudGl0bGUgPSB0aXRsZTtcclxuICAgICAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHNob3coKTogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xyXG4gICAgICAgICAgICB0aGlzLm9wZW4oKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogdGhpcy50aXRsZSB9KTtcclxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoJ3AnLCB7IHRleHQ6IHRoaXMubWVzc2FnZSB9KTtcclxuXHJcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignYnV0dG9uLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHsgdGV4dDogJ1x1Nzg2RVx1OEJBNCcgfSk7XHJcbiAgICAgICAgY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5yZXN1bHQgPSB0cnVlO1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywgeyB0ZXh0OiAnXHU1M0Q2XHU2RDg4JyB9KTtcclxuICAgICAgICBjYW5jZWxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzdWx0ID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBvbkNsb3NlKCkge1xyXG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xyXG4gICAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xyXG4gICAgICAgIHRoaXMucmVzb2x2ZVByb21pc2UodGhpcy5yZXN1bHQpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vLyBcdTRGRUVcdTY1MzlcdTU4OUVcdTVGM0FcdTc2ODRcdTY1ODdcdTRFRjZcdTkwMDlcdTYyRTlcdTZBMjFcdTYwMDFcdTY4NDZcclxuY2xhc3MgRW5oYW5jZWRGaWxlU2VsZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XHJcbiAgICBwcml2YXRlIGZpbGVzOiBURmlsZVtdO1xyXG4gICAgcHJpdmF0ZSByZWNlbnRGb2xkZXJzOiBzdHJpbmdbXTtcclxuICAgIHByaXZhdGUgb25Gb2xkZXJzVXBkYXRlOiAoZm9sZGVyczogc3RyaW5nW10pID0+IHZvaWQ7XHJcbiAgICBwcml2YXRlIHNlbGVjdGVkRm9sZGVyOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBhcHA6IEFwcCxcclxuICAgICAgICBmaWxlczogVEZpbGVbXSxcclxuICAgICAgICByZWNlbnRGb2xkZXJzOiBzdHJpbmdbXSxcclxuICAgICAgICBvbkZvbGRlcnNVcGRhdGU6IChmb2xkZXJzOiBzdHJpbmdbXSkgPT4gdm9pZFxyXG4gICAgKSB7XHJcbiAgICAgICAgc3VwZXIoYXBwKTtcclxuICAgICAgICB0aGlzLmZpbGVzID0gZmlsZXM7XHJcbiAgICAgICAgdGhpcy5yZWNlbnRGb2xkZXJzID0gcmVjZW50Rm9sZGVycztcclxuICAgICAgICB0aGlzLm9uRm9sZGVyc1VwZGF0ZSA9IG9uRm9sZGVyc1VwZGF0ZTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBvbk9wZW4oKSB7XHJcbiAgICAgICAgY29uc3QgeyBjb250ZW50RWwgfSA9IHRoaXM7XHJcbiAgICAgICAgY29udGVudEVsLmVtcHR5KCk7XHJcblxyXG4gICAgICAgIC8vIFx1NjgwN1x1OTg5OFxyXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbCgnaDMnLCB7IFxyXG4gICAgICAgICAgICB0ZXh0OiBgXHU3OUZCXHU1MkE4ICR7dGhpcy5maWxlcy5sZW5ndGh9IFx1NEUyQVx1NjU4N1x1NEVGNmAgXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIC8vIFx1NjcwMFx1OEZEMVx1NEY3Rlx1NzUyOFx1NzY4NFx1NjU4N1x1NEVGNlx1NTkzOVxyXG4gICAgICAgIGlmICh0aGlzLnJlY2VudEZvbGRlcnMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBjb25zdCByZWNlbnRTZWN0aW9uID0gY29udGVudEVsLmNyZWF0ZURpdigncmVjZW50LWZvbGRlcnMtc2VjdGlvbicpO1xyXG4gICAgICAgICAgICByZWNlbnRTZWN0aW9uLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1x1NjcwMFx1OEZEMVx1NEY3Rlx1NzUyOCcgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb25zdCByZWNlbnRMaXN0ID0gcmVjZW50U2VjdGlvbi5jcmVhdGVEaXYoJ3JlY2VudC1mb2xkZXJzLWxpc3QnKTtcclxuICAgICAgICAgICAgdGhpcy5yZWNlbnRGb2xkZXJzLmZvckVhY2goZm9sZGVyID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSByZWNlbnRMaXN0LmNyZWF0ZURpdignZm9sZGVyLWl0ZW0gcmVjZW50Jyk7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRleHQoZm9sZGVyKTtcclxuICAgICAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLnNlbGVjdEZvbGRlcihpdGVtLCBmb2xkZXIpKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBcdTYyNDBcdTY3MDlcdTY1ODdcdTRFRjZcdTU5MzlcdTUyMTdcdTg4NjhcclxuICAgICAgICBjb25zdCBmb2xkZXJMaXN0ID0gY29udGVudEVsLmNyZWF0ZURpdignZm9sZGVyLWxpc3QnKTtcclxuICAgICAgICBjb25zdCBmb2xkZXJzID0gdGhpcy5nZXRGb2xkZXJzV2l0aEhpZXJhcmNoeSgpO1xyXG4gICAgICAgIHRoaXMuY3JlYXRlRm9sZGVyVHJlZShmb2xkZXJMaXN0LCBmb2xkZXJzKTtcclxuXHJcbiAgICAgICAgLy8gXHU2REZCXHU1MkEwXHU2NENEXHU0RjVDXHU2MzA5XHU5NEFFXHJcbiAgICAgICAgY29uc3QgYnV0dG9uQ29udGFpbmVyID0gY29udGVudEVsLmNyZWF0ZURpdignbW9kYWwtYnV0dG9uLWNvbnRhaW5lcicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBidXR0b25Db250YWluZXIuY3JlYXRlRWwoJ2J1dHRvbicsIHtcclxuICAgICAgICAgICAgdGV4dDogJ1x1Nzg2RVx1OEJBNFx1NzlGQlx1NTJBOCcsXHJcbiAgICAgICAgICAgIGNsczogJ21vZC1jdGEnXHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgICAgaWYgKHRoaXMuc2VsZWN0ZWRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMubW92ZUZpbGVzKHRoaXMuc2VsZWN0ZWRGb2xkZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IGJ1dHRvbkNvbnRhaW5lci5jcmVhdGVFbCgnYnV0dG9uJywge1xyXG4gICAgICAgICAgICB0ZXh0OiAnXHU1M0Q2XHU2RDg4J1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGNhbmNlbEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuY2xvc2UoKSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBnZXRGb2xkZXJzV2l0aEhpZXJhcmNoeSgpOiBGb2xkZXJJdGVtW10ge1xyXG4gICAgICAgIGNvbnN0IGZvbGRlcnM6IEZvbGRlckl0ZW1bXSA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHNlZW4gPSBuZXcgU2V0PHN0cmluZz4oKTtcclxuXHJcbiAgICAgICAgdGhpcy5hcHAudmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKS5mb3JFYWNoKGZpbGUgPT4ge1xyXG4gICAgICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHBhcnRzID0gZmlsZS5wYXRoLnNwbGl0KCcvJyk7XHJcbiAgICAgICAgICAgICAgICBsZXQgY3VycmVudFBhdGggPSAnJztcclxuICAgICAgICAgICAgICAgIGxldCBsZXZlbCA9IDA7XHJcblxyXG4gICAgICAgICAgICAgICAgcGFydHMuZm9yRWFjaChwYXJ0ID0+IHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocGFydCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50UGF0aCArPSAoY3VycmVudFBhdGggPyAnLycgOiAnJykgKyBwYXJ0O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlZW4uaGFzKGN1cnJlbnRQYXRoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2Vlbi5hZGQoY3VycmVudFBhdGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9sZGVycy5wdXNoKHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXRoOiBjdXJyZW50UGF0aCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBwYXJ0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldmVsOiBsZXZlbFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgbGV2ZWwrKztcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gZm9sZGVycy5zb3J0KChhLCBiKSA9PiBhLnBhdGgubG9jYWxlQ29tcGFyZShiLnBhdGgpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGNyZWF0ZUZvbGRlclRyZWUoY29udGFpbmVyOiBIVE1MRWxlbWVudCwgZm9sZGVyczogRm9sZGVySXRlbVtdKSB7XHJcbiAgICAgICAgZm9sZGVycy5mb3JFYWNoKGZvbGRlciA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBjb250YWluZXIuY3JlYXRlRGl2KHtcclxuICAgICAgICAgICAgICAgIGNsczogJ2ZvbGRlci1pdGVtJ1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIC8vIFx1NkRGQlx1NTJBMFx1N0YyOVx1OEZEQlxyXG4gICAgICAgICAgICBpdGVtLnN0eWxlLnBhZGRpbmdMZWZ0ID0gYCR7Zm9sZGVyLmxldmVsICogMjAgKyAxMH1weGA7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTY1ODdcdTRFRjZcdTU5MzlcdTU2RkVcdTY4MDdcclxuICAgICAgICAgICAgY29uc3QgaWNvbiA9IGl0ZW0uY3JlYXRlU3Bhbih7XHJcbiAgICAgICAgICAgICAgICBjbHM6ICdmb2xkZXItaWNvbidcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGljb24uaW5uZXJIVE1MID0gYDxzdmcgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiIHdpZHRoPVwiMTZcIiBoZWlnaHQ9XCIxNlwiIHZpZXdCb3g9XCIwIDAgMjQgMjRcIiBmaWxsPVwibm9uZVwiIHN0cm9rZT1cImN1cnJlbnRDb2xvclwiIHN0cm9rZS13aWR0aD1cIjJcIiBzdHJva2UtbGluZWNhcD1cInJvdW5kXCIgc3Ryb2tlLWxpbmVqb2luPVwicm91bmRcIj48cGF0aCBkPVwiTTIyIDE5YTIgMiAwIDAgMS0yIDJINGEyIDIgMCAwIDEtMi0yVjVhMiAyIDAgMCAxIDItMmg1bDIgM2g5YTIgMiAwIDAgMSAyIDJ6XCI+PC9wYXRoPjwvc3ZnPmA7XHJcblxyXG4gICAgICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTY1ODdcdTRFRjZcdTU5MzlcdTU0MERcdTc5RjBcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGl0ZW0uY3JlYXRlU3Bhbih7XHJcbiAgICAgICAgICAgICAgICBjbHM6ICdmb2xkZXItbmFtZScsXHJcbiAgICAgICAgICAgICAgICB0ZXh0OiBmb2xkZXIubmFtZVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLnNlbGVjdEZvbGRlcihpdGVtLCBmb2xkZXIucGF0aCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc2VsZWN0Rm9sZGVyKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCBwYXRoOiBzdHJpbmcpIHtcclxuICAgICAgICAvLyBcdTc5RkJcdTk2NjRcdTUxNzZcdTRFRDZcdTkwMDlcdTRFMkRcdTcyQjZcdTYwMDFcclxuICAgICAgICB0aGlzLmNvbnRlbnRFbC5xdWVyeVNlbGVjdG9yQWxsKCcuZm9sZGVyLWl0ZW0nKS5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgICBpdGVtLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBcdTZERkJcdTUyQTBcdTkwMDlcdTRFMkRcdTcyQjZcdTYwMDFcclxuICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdzZWxlY3RlZCcpO1xyXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRGb2xkZXIgPSBwYXRoO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgbW92ZUZpbGVzKHRhcmdldEZvbGRlcjogc3RyaW5nKSB7XHJcbiAgICAgICAgY29uc3QgY29uZmlybU1vZGFsID0gbmV3IENvbmZpcm1Nb2RhbChcclxuICAgICAgICAgICAgdGhpcy5hcHAsXHJcbiAgICAgICAgICAgIFwiXHU3ODZFXHU4QkE0XHU3OUZCXHU1MkE4XCIsXHJcbiAgICAgICAgICAgIGBcdTY2MkZcdTU0MjZcdTVDMDZcdTkwMDlcdTRFMkRcdTc2ODQgJHt0aGlzLmZpbGVzLmxlbmd0aH0gXHU0RTJBXHU2NTg3XHU0RUY2XHU3OUZCXHU1MkE4XHU1MjMwIFwiJHt0YXJnZXRGb2xkZXJ9XCJcdUZGMUZgXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgaWYgKGF3YWl0IGNvbmZpcm1Nb2RhbC5zaG93KCkpIHtcclxuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIHRoaXMuZmlsZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1BhdGggPSBgJHt0YXJnZXRGb2xkZXJ9LyR7ZmlsZS5uYW1lfWA7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC5maWxlTWFuYWdlci5yZW5hbWVGaWxlKGZpbGUsIG5ld1BhdGgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBcdTY2RjRcdTY1QjBcdTY3MDBcdThGRDFcdTRGN0ZcdTc1MjhcdTc2ODRcdTY1ODdcdTRFRjZcdTU5MzlcclxuICAgICAgICAgICAgdGhpcy5yZWNlbnRGb2xkZXJzID0gW3RhcmdldEZvbGRlciwgLi4udGhpcy5yZWNlbnRGb2xkZXJzLmZpbHRlcihmID0+IGYgIT09IHRhcmdldEZvbGRlcildXHJcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgNSk7XHJcbiAgICAgICAgICAgIHRoaXMub25Gb2xkZXJzVXBkYXRlKHRoaXMucmVjZW50Rm9sZGVycyk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBcdTZERkJcdTUyQTBcdTY1ODdcdTRFRjZcdTU5MzlcdTk4NzlcdTYzQTVcdTUzRTNcclxuaW50ZXJmYWNlIEZvbGRlckl0ZW0ge1xyXG4gICAgcGF0aDogc3RyaW5nO1xyXG4gICAgbmFtZTogc3RyaW5nO1xyXG4gICAgbGV2ZWw6IG51bWJlcjtcclxufSAiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQSx1QkFBNkU7OztBQ0E3RSxzQkFVTztBQUdBLElBQU0saUJBQWlCO0FBRXZCLDZCQUF1Qix5QkFBUztBQUFBLEVBeUJuQyxZQUFZLE1BQXFCLFFBQXdCO0FBQ3JELFVBQU07QUFsQkYsOEJBQThCO0FBQzlCLHlCQUErQjtBQUUvQiw2QkFBNEI7QUFDNUIs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QUNyQixVQUFJLENBQUMsTUFBTSxVQUFVLFNBQVMsS0FBSztBQUMvQixhQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLGNBQU0sS0FBSyxPQUFPO0FBQUE7QUFBQTtBQUlsQyxRQUFJLHlCQUFRLGFBQ1AsUUFBUSw0QkFDUixRQUFRLGtGQUNSLFFBQVEsVUFBUSxLQUNaLGVBQWUsT0FDZixTQUFTLEtBQUssT0FBTyxTQUFTLGFBQWEsWUFDM0MsU0FBUyxPQUFPLFVBQVU7QUFDdkIsWUFBTSxRQUFRLE9BQU87QUFDckIsVUFBSSxDQUFDLE1BQU0sVUFBVSxTQUFTLEtBQUs7QUFDL0IsYUFBSyxPQUFPLFNBQVMsZUFBZTtBQUNwQyxjQUFNLEtBQUssT0FBTztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBTTFDLG1DQUE0Qyx3QkFBTztBQUFBLFFBR3pDLFNBQVM7QUFDWCxVQUFNLEtBQUs7QUFFWCxTQUFLLGFBQ0QsZ0JBQ0EsQ0FBQyxTQUF3QixJQUFJLFNBQVMsTUFBTTtBQUdoRCxTQUFLLGNBQWMsZUFBZSw0QkFBUSxNQUFNO0FBQzVDLFdBQUs7QUFBQTtBQUdULFNBQUssY0FBYyxJQUFJLG1CQUFtQixLQUFLLEtBQUs7QUFBQTtBQUFBLFFBR2xELGVBQWU7QUFDakIsU0FBSyxXQUFXLE9BQU8sT0FBTyxJQUFJLGtCQUFrQixNQUFNLEtBQUs7QUFBQTtBQUFBLFFBRzdELGVBQWU7QUFDakIsVUFBTSxLQUFLLFNBQVMsS0FBSztBQUFBO0FBQUEsUUFHdkIsZUFBZTtBQUNqQixVQUFNLEVBQUUsY0FBYyxLQUFLO0FBRTNCLFFBQUksT0FBTyxVQUFVLGdCQUFnQixnQkFBZ0I7QUFDckQsUUFBSSxDQUFDLE1BQU07QUFDUCxhQUFPLFVBQVUsUUFBUTtBQUN6QixZQUFNLEtBQUssYUFBYTtBQUFBLFFBQ3BCLE1BQU07QUFBQSxRQUNOLFFBQVE7QUFBQTtBQUFBO0FBR2hCLGNBQVUsV0FBVztBQUFBO0FBQUEsRUFHekIscUJBQXFCO0FBQ2pCLFNBQUssSUFBSSxVQUFVLGdCQUFnQixnQkFBZ0IsUUFBUSxVQUFRO0FBQy9ELFlBQU0sT0FBTyxLQUFLO0FBQ2xCLFVBQUksTUFBTTtBQUNOLGFBQUssZUFBZSxLQUFLLFNBQVM7QUFBQTtBQUFBO0FBQUE7QUFBQSxRQUt4QyxjQUFjLE9BQWU7QUFDL0IsU0FBSyxTQUFTLFlBQVk7QUFDMUIsVUFBTSxLQUFLO0FBQUE7QUFBQTsiLAogICJuYW1lcyI6IFtdCn0K
